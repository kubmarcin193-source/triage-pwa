<!doctype html>
<html lang="pl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
<!-- PWA -->
<link rel="manifest" href="manifest.webmanifest">
<meta name="theme-color" content="#0b1220">

<!-- Mobile / instalacja -->
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<!-- iOS -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="TRIAGE">
<link rel="apple-touch-icon" href="icons/icon-192.png">

  <title>Wywiad TRIAGE</title>
  <style>
    :root{
      /* styl / kolory */
      --bg:#f5f7fb;
      --card:#ffffff;
      --line:rgba(11,18,32,.14);
      --text:#0b1220;
      --muted:rgba(11,18,32,.72);
      --soft:rgba(11,18,32,.06);

      --blue:#2563eb;
      --green:#16a34a;
      --yellow:#eab308;
      --red:#dc2626;
      --black:#0b1220;
      --orange:#f97316;

      --shadow:0 14px 30px rgba(11,18,32,.10);
      --radius:18px;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      background:linear-gradient(180deg, #eef2ff, var(--bg) 260px);
    }
    a{color:inherit}
    .wrap{
      max-width:1150px;
      margin:18px auto 46px;
      padding:0 14px;
    }

    .wrap{ padding-bottom: 90px; }

    /* header */
    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:16px;
      padding:16px 18px;
      background:rgba(255,255,255,.8);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      backdrop-filter: blur(10px);
    }
    .brand{
      display:flex;
      align-items:center;
      gap:12px;
    }
    .logo{
      width:38px;height:38px;border-radius:12px;
      background:conic-gradient(from 180deg, #22c55e, #eab308, #ef4444, #22c55e);
      box-shadow:0 10px 20px rgba(0,0,0,.12);
    }
    h1{margin:0;font-size:18px;letter-spacing:.2px}
    .subtitle{font-size:12px;color:var(--muted);margin-top:2px}

   /* layout */
	/* === JEDNA KOLUMNA ‚Äì WY≈öRODKOWANA === */
	.grid{
	  display:block;
	  max-width: 1100px;
	  margin: 0 auto;
	  padding: 0 12px;
	}

	.col{
	  width:100%;
	  display:flex;
	  flex-direction:column;
	  gap:16px;
	}




    /* cards / sheets */
    .sheet{
      background:rgba(255,255,255,.86);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      overflow:hidden;
      backdrop-filter: blur(8px);
    }
@media (max-width: 720px){
  .sheet{ padding:12px; }
  .topbar{ padding:12px; }
  h1{ font-size:16px; }
  .subtitle{ font-size:11px; }
  .row{ gap:10px; margin-bottom:8px; }
}

    .sheet h2{
      margin:0 0 10px;
      font-size:14px;
      letter-spacing:.8px;
      text-transform:uppercase;
      color:rgba(11,18,32,.85);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .section-title{
      display:flex;
      align-items:center;
      gap:10px;
    }
    .pill{
      padding:6px 10px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
      border:1px solid var(--line);
      background:rgba(255,255,255,.8);
    }

    /* inputs */
    .row{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:12px;
      margin-bottom:10px;
    }
    @media (max-width: 720px){
      .row{grid-template-columns:1fr;}
    }
    label{display:block;font-size:12px;color:var(--muted);font-weight:800;margin:0 0 6px}
    input[type="text"], input[type="number"], select, textarea{
      width:100%;
      padding:10px 12px;
      border:1px solid rgba(11,18,32,.18);
      border-radius:12px;
      background:#fff;
      outline:none;
      font-size:16px;              /* kluczowe na mobile (blokuje auto-zoom) */
      font-family:var(--sans);
      transition:.15s;
    }
textarea{min-height:80px; resize:vertical; overflow:hidden;}
    input:focus, select:focus, textarea:focus{
      border-color:rgba(99,102,241,.6);
      box-shadow:0 0 0 4px rgba(99,102,241,.12);
    }
    .tiny{font-size:12px;color:var(--muted)}
    .divider{height:1px;background:var(--soft);margin:12px 0}

        /* ===== PARAMETRY POZA NORMƒÑ ‚Äì MOCNE OSTRZE≈ªENIE ===== */
.warn{
  border: 3px solid #dc2626 !important;          /* gruba, czerwona ramka */
  background-color: rgba(239,68,68,0.12) !important; /* lekkie czerwone t≈Ço */
  box-shadow:
    0 0 0 4px rgba(239,68,68,0.35),               /* szeroka po≈õwiata */
    0 0 18px rgba(239,68,68,0.75) !important;     /* ‚Äûglow‚Äù */
  animation: warnPulse 1.2s infinite;
}
.req{
  border: 3px solid #dc2626 !important;
  background: rgba(239,68,68,0.10) !important;
  box-shadow: 0 0 0 4px rgba(239,68,68,0.18) !important;
}
/* ===== REQUIRED (puste pola) ===== */
.req-missing{
  border:2px solid #e74c3c !important;
  box-shadow:0 0 0 3px rgba(231,76,60,.15) !important;
}
.req-label-missing{
  color:#e74c3c !important;
  font-weight:900 !important;
}

/* delikatne pulsowanie ‚Äì przyciƒÖga wzrok */
@keyframes warnPulse{
  0%{
    box-shadow:
      0 0 0 4px rgba(239,68,68,0.35),
      0 0 18px rgba(239,68,68,0.6);
  }
  50%{
    box-shadow:
      0 0 0 6px rgba(239,68,68,0.55),
      0 0 26px rgba(239,68,68,0.9);
  }
  100%{
    box-shadow:
      0 0 0 4px rgba(239,68,68,0.35),
      0 0 18px rgba(239,68,68,0.6);
  }
}


    /* Accordion + Objawy */
    .acc-btn{
      width:100%;
      border: 1px solid var(--line);
      background:#fff;
      border-radius: 12px;
      padding: 12px 12px;
      font-weight: 900;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:space-between;
    }
    .acc-btn:hover{ box-shadow: 0 6px 14px rgba(0,0,0,.08); }

/* ===== Sub-accordion (podkategorie w Objawach) ===== */
.sub-acc{
  margin-top:10px;
  border:1px solid var(--line);
  border-radius:12px;
  overflow:hidden;
  background:#fff;
}
.sub-acc-btn{
  width:100%;
  border:none;
  background:rgba(255,255,255,.9);
  padding:12px 12px;
  font-weight:900;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
}
.sub-acc-btn:hover{ box-shadow: 0 6px 14px rgba(0,0,0,.08); }
.sub-acc-panel{
  padding:10px;
  border-top:1px solid var(--line);
  background:#fff;
}
.sub-acc-chev{ opacity:.7; font-weight:900; }

    .acc-panel{
      margin-top: 10px;
      border: 1px solid var(--line);
      border-radius: 12px;
      padding: 10px;
      background: #fff;
    }

    .symp-list{ display:flex; flex-direction:column; gap: 8px; }

    .symp-row{
      display:grid;
      grid-template-columns: 1.3fr auto auto 1fr;
      gap: 10px;
      align-items:center;
      border: 1px solid rgba(11,18,32,.12);
      border-radius: 12px;
      padding: 10px;
    }
/* Pod≈õwietlenie sugerowanych objaw√≥w */
.symp-row.suggested{
  border: 2px solid var(--yellow);
  box-shadow: 0 0 0 4px rgba(248, 199, 70, .18);
  background: rgba(248, 199, 70, .08);
}

/* Kr√≥tkie ‚Äúmocniejsze‚Äù pod≈õwietlenie po klikniƒôciu propozycji */
.symp-row.picked{
  box-shadow: 0 0 0 6px rgba(248, 199, 70, .30);
}

    .symp-name{ font-weight:900; }
    .symp-opt{ font-size: 13px; font-weight: 800; color: var(--muted); display:flex; gap:6px; align-items:center; }
    .symp-note{ width:100%; }

    @media (max-width: 720px){
      .symp-row{ grid-template-columns: 1fr; }
    }

@media print{
  /* ukryj CA≈ÅƒÑ aplikacjƒô (bez zostawiania miejsca w layoucie) */
  .wrap{ display:none !important; }

  /* poka≈º tylko printArea */
  #printArea{
    display:block !important;
    position:static !important;   /* KLUCZ: nie fixed */
    width:100% !important;
    padding:0 !important;
    margin:0 !important;
    background:#fff !important;
  }

  /* czytelny druk + brak ucinania */
  #printArea h2{ margin: 0 0 8px 0; }
  #printArea hr{ margin: 10px 0; }
  #printArea pre{
    white-space: pre-wrap !important;
    word-break: break-word !important;
    overflow: visible !important;
  }

  /* opcjonalnie: marginesy strony */
  @page { margin: 12mm; }
}


/* buttons + history */
.btn{
  border:1px solid var(--line);
  background:#fff;
  border-radius:12px;
  padding:10px 12px;
  font-weight:900;
  cursor:pointer;
}
.btn:hover{ box-shadow:0 6px 14px rgba(0,0,0,.08); }
.btn.ghost{ background:rgba(255,255,255,.7); }
.btn.danger{ border-color:rgba(220,38,38,.35); }
.btn.small{ padding:6px 10px; font-size:12px; border-radius:10px; }

.triage-btn{
  border:1px solid var(--line);
  background:#fff;
  border-radius:999px;
  padding:8px 10px;
  font-weight:900;
  cursor:pointer;
}
.tag{
  display:inline-block;
  margin-left:6px;
  font-size:12px;
  padding:2px 6px;
  border-radius:999px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.8);
}
/* ===== MOBILE: belka akcji na dole ===== */
.actions-bottom{
  position: sticky;
  bottom: 10px;
  z-index: 50;
  margin-top: 12px;
  padding: 10px;
  border-radius: 16px;
  border: 1px solid var(--line);
  background: rgba(255,255,255,.92);
  backdrop-filter: blur(10px);
  box-shadow: 0 14px 30px rgba(11,18,32,.12);
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
}

/* Na ma≈Çych ekranach: przyciski czytelne i szerokie */
@media (max-width: 720px){
  .actions-bottom{
    gap: 8px;
  }
  .actions-bottom .btn{
    flex: 1 1 calc(50% - 8px);
    justify-content: center;
    padding: 12px 12px;
    font-size: 14px;
  }
}


.history{ display:flex; flex-direction:column; gap:10px; }
.hist-item{
  display:flex;
  justify-content:space-between;
  gap:12px;
  padding:10px;
  border:1px solid rgba(11,18,32,.12);
  border-radius:12px;
  background:#fff;
}
.meta{ font-size:12px; color:var(--muted); }
.mini-actions{ display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
.summary{
  white-space:pre-wrap;
  border:1px dashed rgba(11,18,32,.18);
  border-radius:12px;
  padding:12px;
  background:#fff;
}

/* ===== KOLOROWE SEKCJE ===== */
.sheet {
  border-left: 6px solid transparent;
  background: #fff;
}

/* nag≈Ç√≥wki sekcji */
.sheet h2 {
  padding: 8px 12px;
  border-radius: 8px;
}
.symp-quick-wrap{
  margin: 0 0 10px 0;
  padding: 10px 12px;
  border: 1px dashed rgba(255,255,255,.18);
  border-radius: 14px;
  background: rgba(255,255,255,.03);
}
.symp-quick-title{
  font-weight: 800;
  margin-bottom: 8px;
  opacity: .95;
}
.symp-quick{
  display:flex;
  flex-wrap: wrap;
  gap:8px;
}
.symp-chip{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding: 8px 12px;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,.16);
  background: rgba(255,255,255,.04);
  cursor: pointer;
  user-select:none;
  font-weight: 700;
}
.symp-chip:hover{
  background: rgba(255,255,255,.08);
}
.symp-chip small{
  opacity:.75;
  font-weight:600;
}
.symp-row.suggested{
  outline: 2px solid rgba(255,255,255,.22);
  background: rgba(255,255,255,.06);
}

.symp-quick{
  display:grid;
  gap:8px;
}

.symp-qrow{
  display:grid;
  grid-template-columns: 1.2fr auto auto 1.6fr;
  gap:10px;
  align-items:center;
  padding:10px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.14);
  background: rgba(255,255,255,.04);
}

.symp-qname{
  font-weight:800;
  line-height:1.15;
}
.symp-qname small{
  display:block;
  opacity:.7;
  font-weight:650;
  margin-top:2px;
}

.symp-qopt{
  display:inline-flex;
  gap:8px;
  align-items:center;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.14);
  cursor:pointer;
  user-select:none;
  white-space:nowrap;
}

.symp-qnote{
  width:100%;
}

@media (max-width: 820px){
  .symp-qrow{
    grid-template-columns: 1fr 1fr;
  }
  .symp-qnote{ grid-column: 1 / -1; }
}



/* ---------- KOLORY ---------- */
/* DANE PACJENTA */
.sheet.section-patient{
  border-left-color:#2980b9;
}
.sheet.section-patient h2{
  background:rgba(41,128,185,.08);
}

/* WYWIAD */
.sheet.section-interview {
  border-left-color: #4f8cff;
}
.sheet.section-interview h2 {
  background: rgba(79, 140, 255, 0.08);
}

/* OBJAWY */
.sheet.section-symptoms {
  border-left-color: #ff9f43;
}
.sheet.section-symptoms h2 {
  background: rgba(255, 159, 67, 0.1);
}

/* WYWIAD CHOROBOWY + LEKI */
.sheet.section-hxmeds{
  border-left-color:#00b894; /* mo≈ºesz zmieniƒá */
}
.sheet.section-hxmeds h2{
  background: rgba(0, 184, 148, 0.10);
}


/* BADANIE */
.sheet.section-exam {
  border-left-color: #2ecc71;
}
.sheet.section-exam h2 {
  background: rgba(46, 204, 113, 0.1);
}

/* PARAMETRY ≈ªYCIOWE */
.sheet.section-vitals{
  border-left-color:#c0392b;
}
.sheet.section-vitals h2{
  background:rgba(192,57,43,.08);
}

/* STAN PSYCHICZNY (S) */
.sheet.section-psych{
  border-left-color:#e11d48;
}
.sheet.section-psych h2{
  background:rgba(225,29,72,.08);
}

/* PODSUMOWANIE */
.sheet.section-summary {
  border-left-color: #9b59b6;
}
.sheet.section-summary h2 {
  background: rgba(155, 89, 182, 0.1);
}

/* HISTORIA */
.sheet.section-history {
  border-left-color: #16a085;
}
.sheet.section-history h2 {
  background: rgba(22, 160, 133, 0.1);
}
/* === KOLOROWE PODSEKCJE BADANIA (sub-accordion) === */
.sub-acc-btn{
  border-left: 4px solid var(--accent, #cfd6df);
  padding-left: 12px;
  border-radius: 10px;
}

/* delikatne t≈Ço tylko na hover/otwarciu (opcjonalnie) */
.sub-acc-btn:hover{
  background: rgba(0,0,0,0.03);
}

/* NEURO */
.sub-acc-btn[data-subacc="exam_neuro"]{ --accent:#3498db; }
/* KRƒÑ≈ªENIE */
.sub-acc-btn[data-subacc="exam_cardio"]{ --accent:#e74c3c; }
/* ODDECH */
.sub-acc-btn[data-subacc="exam_resp"]{ --accent:#1abc9c; }
/* BRZUCH */
.sub-acc-btn[data-subacc="exam_abd"]{ --accent:#f39c12; }
/* MOCZOWY */
.sub-acc-btn[data-subacc="exam_uro"]{ --accent:#9b59b6; }
/* RUCH / URAZ */
.sub-acc-btn[data-subacc="exam_msk"]{ --accent:#16a085; }
/* MOTORYCZNO≈öƒÜ */
.sub-acc-btn[data-subacc="exam_mobility"]{ --accent:#2ecc71; }
/* SK√ìRA */
.sub-acc-btn[data-subacc="exam_skin"]{ --accent:#e67e22; }
/* APETYT */
.sub-acc-btn[data-subacc="exam_appetite"]{ --accent:#8e44ad; }
/* DIETY */
.sub-acc-btn[data-subacc="exam_diet"]{ --accent:#27ae60; }
/* MASA CIA≈ÅA */
.sub-acc-btn[data-subacc="exam_weight"]{ --accent:#d35400; }
/* STOLEC */
.sub-acc-btn[data-subacc="exam_stool"]{ --accent:#2c3e50; }
/* SEN */
.sub-acc-btn[data-subacc="exam_sleep"]{ --accent:#7f8c8d; }

/* ===== PRZYCISKI AKCJI ===== */
.btn{
  border:none;
  padding:10px 16px;
  border-radius:10px;
  font-weight:700;
  cursor:pointer;
  transition:.15s ease;
  display:inline-flex;
  align-items:center;
  gap:8px;
}

/* PODSUMOWANIE */
.btn-summary{
  background:#9b59b6;
  color:#fff;
}
.btn-summary:hover{
  background:#8e44ad;
}

/* KOPIUJ */
.btn-copy{
  background:#3498db;
  color:#fff;
}
.btn-copy:hover{
  background:#2e86c1;
}

/* PDF / DRUK */
.btn-pdf{
  background:#2ecc71;
  color:#fff;
}
.btn-pdf:hover{
  background:#27ae60;
}

/* WYCZY≈öƒÜ / RESET (je≈õli zostawisz) */
.btn-reset{
  background:#95a5a6;
  color:#fff;
}
.btn-reset:hover{
  background:#7f8c8d;
}

/* NIEAKTYWNY */
.btn:disabled{
  opacity:.5;
  cursor:not-allowed;
}

<style>
.login-screen {
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  background: radial-gradient(circle at top, #0f2027, #000);
  font-family: system-ui, sans-serif;
}

.login-card {
  width: 360px;
  background: #0b1c22;
  border-radius: 14px;
  box-shadow: 0 0 40px rgba(0,255,255,0.15);
  overflow: hidden;
}

.login-header {
  background: linear-gradient(90deg, #00c6ff, #0072ff);
  color: #000;
  padding: 18px;
  text-align: center;
  font-size: 1.1rem;
  font-weight: 700;
}

.login-body {
  padding: 25px;
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.login-body input {
  padding: 14px;
  font-size: 1.1rem;
  border-radius: 10px;
  border: none;
  outline: none;
  background: #122f3a;
  color: #fff;
}

.login-body input::placeholder {
  color: #7faebc;
}

.login-body button {
  padding: 14px;
  font-size: 1.1rem;
  border-radius: 10px;
  border: none;
  cursor: pointer;
  background: linear-gradient(90deg, #00f260, #0575e6);
  color: #000;
  font-weight: 700;
}

.login-body button:active {
  transform: scale(0.98);
}

.login-error {
  display: none;
  color: #ff6b6b;
  text-align: center;
  font-weight: 600;
}

.login-footer {
  padding: 12px;
  text-align: center;
  font-size: 0.8rem;
  color: #7faebc;
  background: #07161b;
}
/* ===== WYGASZACZ ===== */
.screensaver{
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at top, #0b1218, #020406 70%);
  display: none;               /* wa≈ºne: startowo ukryty */
  align-items: center;
  justify-content: center;
  z-index: 9999;
  user-select: none;
}

.ss-card{
  width: min(520px, 92vw);
  text-align: center;
  padding: 28px 22px;
  border-radius: 18px;
  background: rgba(8, 12, 16, 0.55);
  border: 1px solid rgba(255,255,255,0.08);
  box-shadow: 0 30px 90px rgba(0,0,0,0.75);
  backdrop-filter: blur(6px);
}

.ss-icon{
  font-size: 72px;
  margin-bottom: 12px;
  animation: floatAmbulance 4s ease-in-out infinite;
}

@keyframes floatAmbulance{
  0%,100% { transform: translateY(0); }
  50%     { transform: translateY(-8px); }
}

.ss-time{
  font-size: 64px;
  font-weight: 900;
  letter-spacing: 1px;
  color: #e8f0ff;
  margin-bottom: 8px;
}

.ss-date{
  font-size: 14px;
  font-weight: 700;
  letter-spacing: 0.6px;
  color: rgba(232,240,255,0.65);
  margin-bottom: 14px;
}

.ss-text{
  font-size: 13px;
  color: rgba(232,240,255,0.60);
}


</style>
<style>
/* CA≈ÅY CIEMNY EKRAN */
.login-screen{
  position: fixed;
  inset: 0;
  background: #05070a;           /* pe≈Çna czer≈Ñ-ish */
  display: flex;
  align-items: center;           /* ≈õrodek pion */
  justify-content: center;       /* ≈õrodek poziom */
  padding: 24px;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

/* PANEL NA ≈öRODKU */
.login-card{
  width: min(420px, 100%);
  background: #0b1118;
  border: 1px solid rgba(255,255,255,0.08);
  border-radius: 18px;
  padding: 26px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.7);
}

/* NAG≈Å√ìWKI */
.login-title{
  color: #e8f0ff;
  font-weight: 800;
  font-size: 1.25rem;
  letter-spacing: 0.2px;
  text-align: center;
  margin-bottom: 6px;
}
.login-subtitle{
  color: rgba(232,240,255,0.65);
  font-size: 0.9rem;
  text-align: center;
  margin-bottom: 18px;
}

/* INPUT */
.login-card input{
  width: 100%;
  box-sizing: border-box;
  padding: 14px 14px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.10);
  background: #070b10;
  color: #e8f0ff;
  outline: none;
  font-size: 1.05rem;
}
.login-card input::placeholder{
  color: rgba(232,240,255,0.45);
}
.login-card input:focus{
  border-color: rgba(60, 185, 255, 0.55);
  box-shadow: 0 0 0 3px rgba(60,185,255,0.12);
}

/* BUTTON */
.login-card button{
  width: 100%;
  margin-top: 12px;
  padding: 14px 14px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-weight: 800;
  font-size: 1.05rem;
  color: #001018;
  background: linear-gradient(90deg, #28d3ff, #2bff88);
}
.login-card button:active{
  transform: scale(0.99);
}

/* ERROR */
.login-error{
  display: none;
  margin-top: 12px;
  text-align: center;
  color: #ff6b6b;
  font-weight: 700;
}
</style>
<style>
.top-bar{
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 14px;
  background: #0b1118;
  border-bottom: 1px solid rgba(255,255,255,0.08);
}

.top-bar span{
  color: #e8f0ff;
  font-weight: 700;
  font-size: 0.95rem;
}

.logout-btn{
  background: #ff4d4d;
  border: none;
  border-radius: 8px;
  padding: 8px 14px;
  font-weight: 700;
  cursor: pointer;
  color: #000;
}

.logout-btn:active{
  transform: scale(0.97);
}
.logout-btn{
  width: 42px;
  height: 38px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  background: #ff4d4d;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  color: #000;
  font-weight: 900;
}

.logout-icon{
  font-size: 18px;
  line-height: 1;
}

.logout-btn:active{ transform: scale(0.97); }
.logout-btn:hover{ filter: brightness(1.05); }

</style>


  </style>
</head>
<body>
<body>

<!-- ===== WYGASZACZ ===== -->
<div id="screensaver" class="screensaver" style="display:none;">
  <div class="ss-card">
    <div class="ss-icon">üöë</div>
    <div class="ss-time" id="ssTime">00:00</div>
    <div class="ss-date" id="ssDate">---</div>
    <div class="ss-text"> Omnis diagnosis post mortem certa est ‚Ä¢ Kliknij aby przej≈õƒá do logowania</div>
  </div>
</div>


<!-- ===== LOGOWANIE ===== -->
<div id="loginScreen" class="login-screen">
  <div class="login-card">
    <div class="login-title">üöë Qui bene diagnoscit, bene curat</div>
    <div class="login-subtitle">Dostƒôp chroniony ‚Ä¢ MK</div>

    <input type="password" id="passwordInput" placeholder="Wpisz has≈Ço" autofocus>
    <button type="button" onclick="login()">ZALOGUJ</button>

    <div id="loginError" class="login-error">‚ùå B≈Çƒôdne has≈Ço</div>
  </div>
</div>


    <div class="login-footer">
      Dostƒôp ograniczony ‚Ä¢ Marcin P. Kubacka
    </div>
  </div>
</div>


<!-- ===== APLIKACJA ===== -->
<div id="app" style="display:none;">

<div class="top-bar">
  <span>üöë WYWIAD-RatMed</span>
<button onclick="logout()" class="logout-btn" title="Wyloguj" aria-label="Wyloguj">
  <span class="logout-icon">‚éã</span>
</button>

</div>

  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo"></div>
        <div>
         <h1>Wywiad TRIAGE</h1>
		<div class="subtitle">
 		 Data: <span id="triageDate">‚Äî</span> ‚Ä¢
 		 Start: <span id="triageStart">‚Äî</span> ‚Ä¢
 		 Koniec: <span id="triageEnd">‚Äî</span>
		</div>

        </div>
      </div>
      <div class="pill" id="pillTriage"> Primum non nocere- Primum caffeina, deinde medicina </div>
    </div>

    <div class="grid">
      <!-- LEWA KOLUMNA -->
      <div class="col">
        <!-- 1) DANE -->
        <!-- ===== DANE PACJENTA ===== -->
	<div class="sheet section-patient">
  <h2><span class="section-title">DANE PACJENTA</span></h2>


	  <!-- Imiƒô i nazwisko | PESEL -->
	  <div class="row">
	    <div>
	      <label>Imiƒô i nazwisko</label>
	      <input id="name" type="text" placeholder="np. NN"/>
	    </div>
	    <div>
	      <label>PESEL</label>
	      <input id="pesel" type="text" placeholder="11 cyfr"/>
	    </div>
	  </div>

	  <!-- P≈Çeƒá | Wiek -->
	  <div class="row">
	    <div>
	      <label>P≈Çeƒá</label>
	      <select id="sex">
	        <option value="">‚Äî</option>
	        <option value="M">M</option>
	        <option value="K">K</option>
	      </select>
	    </div>
	    <div>
	      <label>Wiek</label>
	      <input id="age" type="number" min="0" placeholder="np. 68"/>
	    </div>
	  </div>
	
	  <!-- Data urodzenia -->
	  <div class="row">
	    <div>
	      <label>Data urodzenia</label>
	      <input id="dob" type="text" placeholder="dd-mm-rrrr"/>
	    </div>
	  </div>
	</div>

        <!-- 2) PARAMETRY -->
        <div class="sheet section-vitals">

  <h2><span class="section-title">PARAMETRY ≈ªYCIOWE</span></h2>

          <div class="row">
            <div>
              <label>Ci≈õnienie (mmHg)</label>
              <input id="bp" type="text" placeholder="np. 165/90"/>
            </div>
            <div>
              <label>Tƒôtno (HR/min)</label>
              <input id="hr" type="number" placeholder="np. 110"/>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Saturacja SpO‚ÇÇ (%)</label>
              <input id="spo2" type="number" placeholder="np. 92"/>
            </div>
            <div>
              <label>Temperatura (¬∞C)</label>
              <input id="temp" type="text" placeholder="np. 38.2"/>
            </div>
          </div>
          <div class="row">
            <div>
              <label>Glikemia (mg/dl)</label>
              <input id="glucose" type="number" placeholder="np. 105"/>
            </div>
            <div>
              <label>AVPU</label>
		<select id="avpu">
	  <option value="">‚Äî</option>
	  <option value="A">A ‚Äî przytomny (reaguje spontanicznie)</option>
	  <option value="V">V ‚Äî reaguje na g≈Ços</option>
	  <option value="P">P ‚Äî reaguje na b√≥l</option>
	  <option value="U">U ‚Äî nieprzytomny (brak reakcji)</option>
	</select>

            </div>
          </div>
          <div class="row">
            <div>
              <label>Stan og√≥lny</label>
              <select id="general_state">
                <option value="">‚Äî</option>
                <option value="dobry">dobry</option>
                <option value="≈õredni">≈õredni</option>
                <option value="ciƒô≈ºki">ciƒô≈ºki</option>
              </select>
            </div>
            <div>
              <label>Stabilno≈õƒá</label>
              <select id="stability">
                <option value="">‚Äî</option>
                <option value="stabilny">stabilny</option>
                <option value="niestabilny">niestabilny</option>
              </select>
            </div>
          </div>
	<div class="row">
  <div>
    <label>Kontakt s≈Çowny</label>
    <select id="verbal_contact">
      <option value="">‚Äî</option>
      <option value="logiczny">logiczny</option>
      <option value="nielogiczny">nielogiczny</option>
      <option value="brak">brak kontaktu</option>
    </select>
  </div>

  <div>
    <label>Orientacja co do:</label>

    <label class="tiny"><input type="checkbox" id="orient_time"> czasu</label><br>
    <label class="tiny"><input type="checkbox" id="orient_place"> miejsca</label><br>
    <label class="tiny"><input type="checkbox" id="orient_person"> w≈Çasnej osoby</label><br><br>
    <label class="tiny"><input type="checkbox" id="orient_disoriented"> pacjent/ka zdezorientowany/a</label>
 

	  </div>
	</div>

          <div class="tiny">Pola obowiƒÖzkowe.</div>
        </div>

        <!-- 3) WYWIAD -->
     <div class="sheet section-interview">
  <h2><span class="section-title">WYWIAD</span></h2>

         
<div class="row">
  <div style="grid-column:1/-1">
    <label>Tryb zg≈Çoszenia</label>

    <label class="tiny">
      <input type="radio" name="arrival_mode" id="arrival_zrm" value="zrm">
      przywieziony przez ZRM
    </label><br>

    <label class="tiny">
      <input type="radio" name="arrival_mode" id="arrival_self" value="self">
      zg≈Çasza siƒô samodzielnie
    </label><br>

    <label class="tiny">
      <input type="radio" name="arrival_mode" id="arrival_referral" value="referral">
      zg≈Çasza siƒô ze skierowaniem
    </label>

    <input
      type="text"
      id="arrival_note"
      placeholder="np.: POZ / OCD / Allmedica"
      style="margin-top:6px;"
    />
  </div>
</div>

 
              <label>Pow√≥d zg≈Çoszenia (Zg≈Çasza siƒô z powodu:...)</label>
              <input id="chief" type="text" list="chiefHints" placeholder="np. duszno≈õƒá, b√≥l w klp..."/>
<datalist id="chiefHints"></datalist>

          
          
          <div class="row">
            <div style="grid-column:1/-1">
              <label>Wywiad (og√≥lny)</label>
              <textarea id="interview_general" placeholder="np. poczƒÖtek objaw√≥w, charakter, czynniki, zdarzenia..."></textarea>
            </div>
        </div>  




			<!-- 3b) OBJAWY (accordion) -->
<div style="margin-top:14px;">
  <div class="sheet section-symptoms">
  <h2><span class="section-title">OBJAWY</span></h2>

<div id="sympQuickWrap" class="symp-quick-wrap" hidden>
  <div class="symp-quick-title">Podpowiadane objawy:</div>
  <div id="sympQuick" class="symp-quick"></div>
</div>
<div class="row" style="margin-top:10px;">
  <div style="grid-column:1/-1">
    <label>Szukaj objawu</label>
    <input id="sympSearch" type="text" placeholder="np. b√≥l g≈Çowy, gorƒÖczka, duszno≈õƒá...">
  </div>
</div>

<div class="divider"></div>


  <button type="button" class="acc-btn" id="sympToggle" aria-expanded="false">
    Objawy (kliknij, aby rozwinƒÖƒá)
    <span class="acc-chev" aria-hidden="true">‚ñæ</span>
  </button>

  <div class="acc-panel" id="sympPanel" hidden>

    <!-- ===== 1) Neurologiczne ===== -->
    <div class="sub-acc">
      <button type="button" class="sub-acc-btn" data-subacc="neuro" aria-expanded="false">
        Objawy neurologiczne
        <span class="sub-acc-chev" aria-hidden="true">‚ñæ</span>
      </button>
      <div class="sub-acc-panel" data-subpanel="neuro" hidden>
        <div class="symp-list">

  <div class="symp-row" data-label="b√≥l g≈Çowy">
  <div class="symp-name">B√≥l g≈Çowy</div>

  <label class="symp-opt">
    <input type="radio" name="n_headache" value="yes"> Wystƒôpuje
  </label>
  <label class="symp-opt">
    <input type="radio" name="n_headache" value="no"> Neguje
  </label>

  <!-- WYB√ìR CHARAKTERU -->
  <select class="symp-select" data-select>
    <option value="">‚Äî charakter b√≥lu ‚Äî</option>
    <option value="nag≈Çy">nag≈Çy</option>
    <option value="narastajƒÖcy">narastajƒÖcy</option>
    <option value="sta≈Çy">sta≈Çy</option>
    <option value="napadowy">napadowy</option>
    <option value="piorunujƒÖcy">piorunujƒÖcy</option>
  </select>

  <!-- DODATKOWA NOTATKA -->
  <input
    class="symp-note"
    type="text"
    placeholder="np. od 2 dni"
    data-note
  >
</div>


  <div class="symp-row" data-label="zawroty g≈Çowy">
    <div class="symp-name">Zawroty g≈Çowy</div>
    <label class="symp-opt"><input type="radio" name="n_dizzy" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_dizzy" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. przy wstawaniu" data-note>
  </div>

  <div class="symp-row" data-label="utrata przytomno≈õci / zas≈Çabniƒôcie">
    <div class="symp-name">Utrata przytomno≈õci / zas≈Çabniƒôcie</div>
    <label class="symp-opt"><input type="radio" name="n_loc" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_loc" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czas, okoliczno≈õci" data-note>
  </div>

  <div class="symp-row" data-label="zaburzenia ≈õwiadomo≈õci">
    <div class="symp-name">Zaburzenia ≈õwiadomo≈õci</div>
    <label class="symp-opt"><input type="radio" name="n_conscious" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_conscious" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. AVPU/GCS" data-note>
  </div>

  <div class="symp-row" data-label="splƒÖtanie">
    <div class="symp-name">SplƒÖtanie</div>
    <label class="symp-opt"><input type="radio" name="n_confusion" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_confusion" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="nag≈Çe/narastajƒÖce" data-note>
  </div>

  <div class="symp-row" data-label="senno≈õƒá">
    <div class="symp-name">Senno≈õƒá</div>
    <label class="symp-opt"><input type="radio" name="n_sleepy" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_sleepy" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od 2 dni" data-note>
  </div>

  <div class="symp-row" data-label="drgawki">
    <div class="symp-name">Drgawki</div>
    <label class="symp-opt"><input type="radio" name="n_seizure" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_seizure" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czas trwania" data-note>
  </div>

  <div class="symp-row" data-label="niedow≈Çad ko≈Ñczyn">
    <div class="symp-name">Niedow≈Çad ko≈Ñczyn</div>
    <label class="symp-opt"><input type="radio" name="n_weaklimb" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_weaklimb" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="kt√≥ra ko≈Ñczyna" data-note>
  </div>

  <div class="symp-row" data-label="pora≈ºenie po≈Çowicze">
    <div class="symp-name">Pora≈ºenie po≈Çowicze</div>
    <label class="symp-opt"><input type="radio" name="n_hemi" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_hemi" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="prawa/lewa" data-note>
  </div>

  <div class="symp-row" data-label="drƒôtwienie / mrowienie ko≈Ñczyn">
    <div class="symp-name">Drƒôtwienie / mrowienie ko≈Ñczyn</div>
    <label class="symp-opt"><input type="radio" name="n_paresth_limb" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_paresth_limb" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="gdzie, od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="zaburzenia czucia">
    <div class="symp-name">Zaburzenia czucia</div>
    <label class="symp-opt"><input type="radio" name="n_sensory" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_sensory" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="opis" data-note>
  </div>

  <div class="symp-row" data-label="zaburzenia mowy">
    <div class="symp-name">Zaburzenia mowy (afazja, be≈Çkotliwa mowa)</div>
    <label class="symp-opt"><input type="radio" name="n_speech" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_speech" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="zaburzenia widzenia">
    <div class="symp-name">Zaburzenia widzenia (podw√≥jne widzenie, nag≈Ça utrata widzenia, mroczki)</div>
    <label class="symp-opt"><input type="radio" name="n_vision" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_vision" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jakie dok≈Çadnie" data-note>
  </div>

  <div class="symp-row" data-label="opadanie kƒÖcika ust">
    <div class="symp-name">Opadanie kƒÖcika ust</div>
    <label class="symp-opt"><input type="radio" name="n_face_drop" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_face_drop" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="prawy/lewy" data-note>
  </div>

  <div class="symp-row" data-label="zaburzenia koordynacji">
    <div class="symp-name">Zaburzenia koordynacji</div>
    <label class="symp-opt"><input type="radio" name="n_ataxia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_ataxia" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. chwiejny ch√≥d" data-note>
  </div>

  <div class="symp-row" data-label="sztywno≈õƒá karku">
    <div class="symp-name">Sztywno≈õƒá karku</div>
    <label class="symp-opt"><input type="radio" name="n_neck_stiff" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_neck_stiff" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="b√≥l karku">
    <div class="symp-name">B√≥l karku</div>
    <label class="symp-opt"><input type="radio" name="n_neck_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_neck_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. uraz?" data-note>
  </div>

  <div class="symp-row" data-label="≈õwiat≈Çowstrƒôt">
    <div class="symp-name">≈öwiat≈Çowstrƒôt</div>
    <label class="symp-opt"><input type="radio" name="n_photophobia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_photophobia" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="nadwra≈ºliwo≈õƒá na d≈∫wiƒôki">
    <div class="symp-name">Nadwra≈ºliwo≈õƒá na d≈∫wiƒôki</div>
    <label class="symp-opt"><input type="radio" name="n_phonophobia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_phonophobia" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="amnezja">
    <div class="symp-name">Amnezja</div>
    <label class="symp-opt"><input type="radio" name="n_amnesia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_amnesia" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czas / epizod" data-note>
  </div>

  <div class="symp-row" data-label="nag≈Ça zmiana zachowania">
    <div class="symp-name">Nag≈Ça zmiana zachowania</div>
    <label class="symp-opt"><input type="radio" name="n_behavior" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_behavior" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="opis" data-note>
  </div>

  <div class="symp-row" data-label="parestezje twarzy">
    <div class="symp-name">Parestezje twarzy</div>
    <label class="symp-opt"><input type="radio" name="n_face_paresth" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_face_paresth" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="prawa/lewa" data-note>
  </div>

  <div class="symp-row" data-label="os≈Çabienie si≈Çy miƒô≈õniowej">
    <div class="symp-name">Os≈Çabienie si≈Çy miƒô≈õniowej</div>
    <label class="symp-opt"><input type="radio" name="n_strength" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="n_strength" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="gdzie / od kiedy" data-note>
  </div>

</div>

    </div>

    <!-- ===== 2) Internistyczno-kardiologiczne ===== -->
    <div class="sub-acc">
      <button type="button" class="sub-acc-btn" data-subacc="cardio" aria-expanded="false">
        Objawy internistyczno-kardiologiczne
        <span class="sub-acc-chev" aria-hidden="true">‚ñæ</span>
      </button>
      <div class="sub-acc-panel" data-subpanel="cardio" hidden>
        <div class="symp-list">

  <div class="symp-row" data-label="b√≥l w klatce piersiowej">
    <div class="symp-name">B√≥l w klatce piersiowej</div>
    <label class="symp-opt"><input type="radio" name="c_chest_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_chest_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy, promieniowanie" data-note>
  </div>

  <div class="symp-row" data-label="uczucie ucisku w KLP">
    <div class="symp-name">Uczucie ucisku w KLP</div>
    <label class="symp-opt"><input type="radio" name="c_chest_pressure" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_chest_pressure" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. przy wysi≈Çku/spoczynku" data-note>
  </div>

  <div class="symp-row" data-label="ko≈Çatanie serca">
    <div class="symp-name">Ko≈Çatanie serca</div>
    <label class="symp-opt"><input type="radio" name="c_palpitations" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_palpitations" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="napadowe? od kiedy?" data-note>
  </div>

  <div class="symp-row" data-label="duszno≈õƒá spoczynkowa">
    <div class="symp-name">Duszno≈õƒá spoczynkowa</div>
    <label class="symp-opt"><input type="radio" name="c_dyspnea_rest" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_dyspnea_rest" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy, nasilenie" data-note>
  </div>

  <div class="symp-row" data-label="duszno≈õƒá wysi≈Çkowa">
    <div class="symp-name">Duszno≈õƒá wysi≈Çkowa</div>
    <label class="symp-opt"><input type="radio" name="c_dyspnea_exert" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_dyspnea_exert" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. ile metr√≥w/schod√≥w" data-note>
  </div>

  <div class="symp-row" data-label="kaszel">
    <div class="symp-name">Kaszel (suchy/mokry)</div>
    <label class="symp-opt"><input type="radio" name="c_cough" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_cough" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. suchy/mokry, od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="krwioplucie">
    <div class="symp-name">Krwioplucie</div>
    <label class="symp-opt"><input type="radio" name="c_hemoptysis" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_hemoptysis" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ilo≈õƒá, od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="obrzƒôki ko≈Ñczyn dolnych">
    <div class="symp-name">Obrzƒôki ko≈Ñczyn dolnych</div>
    <label class="symp-opt"><input type="radio" name="c_leg_edema" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_leg_edema" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="obustronne/jednostronne" data-note>
  </div>

  <div class="symp-row" data-label="tachykardia">
    <div class="symp-name">Tachykardia</div>
    <label class="symp-opt"><input type="radio" name="c_tachy" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_tachy" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. HR ~" data-note>
  </div>

  <div class="symp-row" data-label="bradykardia">
    <div class="symp-name">Bradykardia</div>
    <label class="symp-opt"><input type="radio" name="c_brady" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_brady" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. HR ~" data-note>
  </div>

  <div class="symp-row" data-label="gorƒÖczka">
    <div class="symp-name">GorƒÖczka</div>
    <label class="symp-opt"><input type="radio" name="c_fever" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_fever" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. Tmax" data-note>
  </div>

  <div class="symp-row" data-label="stan podgorƒÖczkowy">
    <div class="symp-name">Stan podgorƒÖczkowy</div>
    <label class="symp-opt"><input type="radio" name="c_subfebrile" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_subfebrile" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. 37.5‚Äì37.9" data-note>
  </div>

  <div class="symp-row" data-label="dreszcze">
    <div class="symp-name">Dreszcze</div>
    <label class="symp-opt"><input type="radio" name="c_chills" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_chills" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="os≈Çabienie og√≥lne">
    <div class="symp-name">Os≈Çabienie og√≥lne</div>
    <label class="symp-opt"><input type="radio" name="c_weakness" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_weakness" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="pogorszenie tolerancji wysi≈Çku">
    <div class="symp-name">Pogorszenie tolerancji wysi≈Çku</div>
    <label class="symp-opt"><input type="radio" name="c_exertion_worse" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_exertion_worse" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="omdlenie">
    <div class="symp-name">Omdlenie</div>
    <label class="symp-opt"><input type="radio" name="c_syncope" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_syncope" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czas, okoliczno≈õci" data-note>
  </div>

  <div class="symp-row" data-label="sinica">
    <div class="symp-name">Sinica</div>
    <label class="symp-opt"><input type="radio" name="c_cyanosis" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_cyanosis" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="wargi/paznokcie" data-note>
  </div>

  <div class="symp-row" data-label="blado≈õƒá pow≈Çok">
    <div class="symp-name">Blado≈õƒá pow≈Çok</div>
    <label class="symp-opt"><input type="radio" name="c_pallor" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_pallor" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="utrata masy cia≈Ça">
    <div class="symp-name">Utrata masy cia≈Ça</div>
    <label class="symp-opt"><input type="radio" name="c_weightloss" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_weightloss" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ile kg / w jakim czasie" data-note>
  </div>

  <div class="symp-row" data-label="nudno≈õci">
    <div class="symp-name">Nudno≈õci</div>
    <label class="symp-opt"><input type="radio" name="c_nausea" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_nausea" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="wymioty">
    <div class="symp-name">Wymioty</div>
    <label class="symp-opt"><input type="radio" name="c_vomit" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_vomit" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ile razy / tre≈õƒá" data-note>
  </div>

  <div class="symp-row" data-label="brak apetytu">
    <div class="symp-name">Brak apetytu</div>
    <label class="symp-opt"><input type="radio" name="c_anorexia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_anorexia" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="biegunka">
    <div class="symp-name">Biegunka</div>
    <label class="symp-opt"><input type="radio" name="c_diarrhea" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_diarrhea" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ile razy/d" data-note>
  </div>

  <div class="symp-row" data-label="zaparcia">
    <div class="symp-name">Zaparcia</div>
    <label class="symp-opt"><input type="radio" name="c_constipation" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_constipation" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="czƒôstomocz">
    <div class="symp-name">Czƒôstomocz</div>
    <label class="symp-opt"><input type="radio" name="c_frequency" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_frequency" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. co 10 min" data-note>
  </div>

  <div class="symp-row" data-label="krwiomocz">
    <div class="symp-name">Krwiomocz</div>
    <label class="symp-opt"><input type="radio" name="c_hematuria" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_hematuria" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ze skrzepami? od kiedy?" data-note>
  </div>

  <div class="symp-row" data-label="skƒÖpomocz">
    <div class="symp-name">SkƒÖpomocz</div>
    <label class="symp-opt"><input type="radio" name="c_oliguria" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_oliguria" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. ile ml" data-note>
  </div>

  <div class="symp-row" data-label="b√≥l przy mikcji">
    <div class="symp-name">B√≥l przy mikcji</div>
    <label class="symp-opt"><input type="radio" name="c_dysuria_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_dysuria_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="pieczenie przy oddawaniu moczu">
    <div class="symp-name">Pieczenie przy oddawaniu moczu</div>
    <label class="symp-opt"><input type="radio" name="c_dysuria_burning" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_dysuria_burning" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="obrzƒôki twarzy">
    <div class="symp-name">Obrzƒôki twarzy</div>
    <label class="symp-opt"><input type="radio" name="c_face_edema" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_face_edema" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="wargi/powieki" data-note>
  </div>

  <div class="symp-row" data-label="wysypka">
    <div class="symp-name">Wysypka</div>
    <label class="symp-opt"><input type="radio" name="c_rash" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_rash" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="lokalizacja" data-note>
  </div>

  <div class="symp-row" data-label="≈õwiƒÖd">
    <div class="symp-name">≈öwiƒÖd</div>
    <label class="symp-opt"><input type="radio" name="c_pruritus" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_pruritus" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="objawy infekcyjne g√≥rnych dr√≥g oddechowych">
    <div class="symp-name">Objawy infekcyjne g√≥rnych dr√≥g oddechowych</div>
    <label class="symp-opt"><input type="radio" name="c_uri" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="c_uri" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. katar, b√≥l gard≈Ça" data-note>
  </div>

	</div>
    </div>

    <!-- ===== 3) Chirurgiczne ===== -->
    <div class="sub-acc">
      <button type="button" class="sub-acc-btn" data-subacc="surg" aria-expanded="false">
        Objawy chirurgiczne
        <span class="sub-acc-chev" aria-hidden="true">‚ñæ</span>
      </button>
      <div class="sub-acc-panel" data-subpanel="surg" hidden>
        <div class="symp-list">

  <div class="symp-row" data-label="b√≥l brzucha">
    <div class="symp-name">B√≥l brzucha</div>
    <label class="symp-opt"><input type="radio" name="s_abd_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_abd_pain" value="no"> Neguje</label>

    <select class="symp-select" data-select>
      <option value="">‚Äî charakter ‚Äî</option>
      <option value="nag≈Çy">nag≈Çy</option>
      <option value="narastajƒÖcy">narastajƒÖcy</option>
      <option value="napadowy">napadowy</option>
      <option value="kolkowy">kolkowy</option>
    </select>

    <input class="symp-note" type="text" placeholder="lokalizacja / np. PPG, nadbrzusze" data-note>
  </div>

  <div class="symp-row" data-label="obrona miƒô≈õniowa">
    <div class="symp-name">Obrona miƒô≈õniowa</div>
    <label class="symp-opt"><input type="radio" name="s_guarding" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_guarding" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="gdzie?" data-note>
  </div>

  <div class="symp-row" data-label="wzdƒôcie brzucha">
    <div class="symp-name">Wzdƒôcie brzucha</div>
    <label class="symp-opt"><input type="radio" name="s_bloating" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_bloating" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="zatrzymanie gaz√≥w">
    <div class="symp-name">Zatrzymanie gaz√≥w</div>
    <label class="symp-opt"><input type="radio" name="s_no_gas" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_no_gas" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="zatrzymanie stolca">
    <div class="symp-name">Zatrzymanie stolca</div>
    <label class="symp-opt"><input type="radio" name="s_no_stool" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_no_stool" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="smoliste stolce">
    <div class="symp-name">Smoliste stolce</div>
    <label class="symp-opt"><input type="radio" name="s_melena" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_melena" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="≈õwie≈ºa krew w stolcu">
    <div class="symp-name">≈öwie≈ºa krew w stolcu</div>
    <label class="symp-opt"><input type="radio" name="s_blood_stool" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_blood_stool" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ilo≈õƒá / od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="krwawienie z odbytu">
    <div class="symp-name">Krwawienie z odbytu</div>
    <label class="symp-opt"><input type="radio" name="s_rectal_bleed" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_rectal_bleed" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ilo≈õƒá / od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="krwawienie z rany">
    <div class="symp-name">Krwawienie z rany</div>
    <label class="symp-opt"><input type="radio" name="s_wound_bleed" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_wound_bleed" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="obfite? od kiedy?" data-note>
  </div>

  <div class="symp-row" data-label="wyciek tre≈õci z rany">
    <div class="symp-name">Wyciek tre≈õci z rany (ropna wydzielina/p≈Çyn surowiczy)</div>
    <label class="symp-opt"><input type="radio" name="s_wound_discharge" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_wound_discharge" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ropna / surowicza / inna" data-note>
  </div>

  <div class="symp-row" data-label="zaczerwienienie rany">
    <div class="symp-name">Zaczerwienienie rany</div>
    <label class="symp-opt"><input type="radio" name="s_wound_red" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_wound_red" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="obrzƒôk rany">
    <div class="symp-name">Obrzƒôk rany</div>
    <label class="symp-opt"><input type="radio" name="s_wound_swelling" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_wound_swelling" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="b√≥l rany pooperacyjnej">
    <div class="symp-name">B√≥l rany pooperacyjnej</div>
    <label class="symp-opt"><input type="radio" name="s_postop_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_postop_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="nasilenie / od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="rozej≈õcie rany">
    <div class="symp-name">Rozej≈õcie rany</div>
    <label class="symp-opt"><input type="radio" name="s_wound_dehiscence" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_wound_dehiscence" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="objawy zaka≈ºenia rany">
    <div class="symp-name">Objawy zaka≈ºenia rany</div>
    <label class="symp-opt"><input type="radio" name="s_wound_infection" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_wound_infection" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. gorƒÖczka, ropienie" data-note>
  </div>

  <div class="symp-row" data-label="przepuklina">
    <div class="symp-name">Przepuklina</div>
    <label class="symp-opt"><input type="radio" name="s_hernia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_hernia" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="pachwinowa/pƒôpkowa itd." data-note>
  </div>

  <div class="symp-row" data-label="b√≥l pachwiny">
    <div class="symp-name">B√≥l pachwiny</div>
    <label class="symp-opt"><input type="radio" name="s_groin_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_groin_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="strona / promieniowanie" data-note>
  </div>

  <div class="symp-row" data-label="b√≥l jƒÖdra">
    <div class="symp-name">B√≥l jƒÖdra</div>
    <label class="symp-opt"><input type="radio" name="s_testicle_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_testicle_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="strona / nag≈Çy?" data-note>
  </div>

  <div class="symp-row" data-label="obrzƒôk moszny">
    <div class="symp-name">Obrzƒôk moszny</div>
    <label class="symp-opt"><input type="radio" name="s_scrotal_swelling" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_scrotal_swelling" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="strona" data-note>
  </div>

  <div class="symp-row" data-label="nudno≈õci">
    <div class="symp-name">Nudno≈õci</div>
    <label class="symp-opt"><input type="radio" name="s_nausea" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_nausea" value="no"> Neguje</label>
    <input class="symp-note" type="text" data-note>
  </div>

  <div class="symp-row" data-label="wymioty">
    <div class="symp-name">Wymioty (tre≈õciƒÖ pokarmowƒÖ / ≈º√≥≈ÇciowƒÖ / krwistƒÖ)</div>
    <label class="symp-opt"><input type="radio" name="s_vomit" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_vomit" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jaka tre≈õƒá? ile razy?" data-note>
  </div>

  <div class="symp-row" data-label="uraz jamy brzusznej">
    <div class="symp-name">Uraz jamy brzusznej</div>
    <label class="symp-opt"><input type="radio" name="s_abd_trauma" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_abd_trauma" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="mechanizm" data-note>
  </div>

  <div class="symp-row" data-label="uraz klatki piersiowej">
    <div class="symp-name">Uraz klatki piersiowej</div>
    <label class="symp-opt"><input type="radio" name="s_chest_trauma" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="s_chest_trauma" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="mechanizm" data-note>
  </div>

	</div>
      </div>
   

    <!-- ===== 4) Ortopedyczne ===== -->
    <div class="sub-acc">
      <button type="button" class="sub-acc-btn" data-subacc="ortho" aria-expanded="false">
        Objawy ortopedyczne
        <span class="sub-acc-chev" aria-hidden="true">‚ñæ</span>
      </button>
      <div class="sub-acc-panel" data-subpanel="ortho" hidden>
        <div class="symp-list">

  <div class="symp-row" data-label="uraz g≈Çowy">
    <div class="symp-name">Uraz g≈Çowy</div>
    <label class="symp-opt"><input type="radio" name="o_head_trauma" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_head_trauma" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="mechanizm / utrata przytomno≈õci?" data-note>
  </div>

  <div class="symp-row" data-label="ograniczenie ruchomo≈õci">
    <div class="symp-name">Ograniczenie ruchomo≈õci</div>
    <label class="symp-opt"><input type="radio" name="o_rom_limit" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_rom_limit" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jaki staw/ko≈Ñczyna" data-note>
  </div>

  <div class="symp-row" data-label="obrzƒôk stawu">
    <div class="symp-name">Obrzƒôk stawu</div>
    <label class="symp-opt"><input type="radio" name="o_joint_swelling" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_joint_swelling" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="kt√≥ry staw" data-note>
  </div>

  <div class="symp-row" data-label="deformacja ko≈Ñczyny">
    <div class="symp-name">Deformacja ko≈Ñczyny</div>
    <label class="symp-opt"><input type="radio" name="o_deformity" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_deformity" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jaka okolica" data-note>
  </div>

  <div class="symp-row" data-label="skr√≥cenie ko≈Ñczyny">
    <div class="symp-name">Skr√≥cenie ko≈Ñczyny</div>
    <label class="symp-opt"><input type="radio" name="o_shortening" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_shortening" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="kt√≥ra ko≈Ñczyna" data-note>
  </div>

  <div class="symp-row" data-label="brak obciƒÖ≈ºania ko≈Ñczyny">
    <div class="symp-name">Brak obciƒÖ≈ºania ko≈Ñczyny</div>
    <label class="symp-opt"><input type="radio" name="o_no_weightbearing" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_no_weightbearing" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="kt√≥ra ko≈Ñczyna" data-note>
  </div>

  <div class="symp-row" data-label="krwiak">
    <div class="symp-name">Krwiak</div>
    <label class="symp-opt"><input type="radio" name="o_hematoma" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_hematoma" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="lokalizacja" data-note>
  </div>

  <div class="symp-row" data-label="rana pourazowa">
    <div class="symp-name">Rana pourazowa</div>
    <label class="symp-opt"><input type="radio" name="o_wound" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_wound" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="lokalizacja / wielko≈õƒá" data-note>
  </div>

  <div class="symp-row" data-label="drƒôtwienie po urazie">
    <div class="symp-name">Drƒôtwienie po urazie</div>
    <label class="symp-opt"><input type="radio" name="o_numbness_post" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_numbness_post" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="gdzie" data-note>
  </div>

  <div class="symp-row" data-label="zaburzenia czucia po urazie">
    <div class="symp-name">Zaburzenia czucia po urazie</div>
    <label class="symp-opt"><input type="radio" name="o_sensory_post" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_sensory_post" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="opis" data-note>
  </div>

      </div>
    </div>
</div>

    <!-- ===== 5) Inne ===== -->
    <div class="sub-acc">
      <button type="button" class="sub-acc-btn" data-subacc="other" aria-expanded="false">
        Inne
        <span class="sub-acc-chev" aria-hidden="true">‚ñæ</span>
      </button>
      <div class="sub-acc-panel" data-subpanel="other" hidden>
        <div class="symp-list">

<div class="symp-row" data-label="b√≥l oka">
  <div class="symp-name">B√≥l oka</div>
  <label class="symp-opt"><input type="radio" name="o_eye_pain" value="yes"> Wystƒôpuje</label>
  <label class="symp-opt"><input type="radio" name="o_eye_pain" value="no"> Neguje</label>
  <input class="symp-note" type="text" placeholder="kt√≥re oko? nasilenie? od kiedy?" data-note>
</div>

<div class="symp-row" data-label="uczucie ‚Äûpiasku‚Äù pod powiekƒÖ">
  <div class="symp-name">Uczucie ‚Äûpiasku‚Äù pod powiekƒÖ</div>
  <label class="symp-opt"><input type="radio" name="o_eye_sand" value="yes"> Wystƒôpuje</label>
  <label class="symp-opt"><input type="radio" name="o_eye_sand" value="no"> Neguje</label>
  <input class="symp-note" type="text" placeholder="kt√≥re oko? od kiedy?" data-note>
</div>

<div class="symp-row" data-label="≈Çzawienie">
  <div class="symp-name">≈Åzawienie</div>
  <label class="symp-opt"><input type="radio" name="o_eye_tearing" value="yes"> Wystƒôpuje</label>
  <label class="symp-opt"><input type="radio" name="o_eye_tearing" value="no"> Neguje</label>
  <input class="symp-note" type="text" placeholder="ciƒÖg≈Çe/napadowe" data-note>
</div>

<div class="symp-row" data-label="zaczerwienienie oka">
  <div class="symp-name">Zaczerwienienie oka</div>
  <label class="symp-opt"><input type="radio" name="o_eye_redness" value="yes"> Wystƒôpuje</label>
  <label class="symp-opt"><input type="radio" name="o_eye_redness" value="no"> Neguje</label>
  <input class="symp-note" type="text" placeholder="kt√≥re oko?" data-note>
</div>

<div class="symp-row" data-label="pogorszenie ostro≈õci widzenia">
  <div class="symp-name">Pogorszenie ostro≈õci widzenia</div>
  <label class="symp-opt"><input type="radio" name="o_eye_vision" value="yes"> Wystƒôpuje</label>
  <label class="symp-opt"><input type="radio" name="o_eye_vision" value="no"> Neguje</label>
  <input class="symp-note" type="text" placeholder="od kiedy? kt√≥re oko?" data-note>
</div>

<div class="symp-row" data-label="krwawienie">
  <div class="symp-name">Krwawienie (oko)</div>
  <label class="symp-opt"><input type="radio" name="o_eye_bleed" value="yes"> Wystƒôpuje</label>
  <label class="symp-opt"><input type="radio" name="o_eye_bleed" value="no"> Neguje</label>
  <input class="symp-note" type="text" placeholder="ilo≈õƒá / od kiedy" data-note>
</div>

  <div class="symp-row" data-label="z≈Çe samopoczucie">
    <div class="symp-name">Z≈Çe samopoczucie</div>
    <label class="symp-opt"><input type="radio" name="o_malaise" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_malaise" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="niepok√≥j">
    <div class="symp-name">Niepok√≥j</div>
    <label class="symp-opt"><input type="radio" name="o_anxiety" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_anxiety" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. sytuacyjne/sta≈Çe" data-note>
  </div>

  <div class="symp-row" data-label="lƒôk">
    <div class="symp-name">Lƒôk</div>
    <label class="symp-opt"><input type="radio" name="o_fear" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_fear" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="napad paniki">
    <div class="symp-name">Napad paniki</div>
    <label class="symp-opt"><input type="radio" name="o_panic" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_panic" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czas trwania, okoliczno≈õci" data-note>
  </div>

  <div class="symp-row" data-label="bezsenno≈õƒá">
    <div class="symp-name">Bezsenno≈õƒá</div>
    <label class="symp-opt"><input type="radio" name="o_insomnia" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_insomnia" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od ilu nocy" data-note>
  </div>

  <div class="symp-row" data-label="zmƒôczenie">
    <div class="symp-name">Zmƒôczenie</div>
    <label class="symp-opt"><input type="radio" name="o_fatigue" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_fatigue" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="odwodnienie">
    <div class="symp-name">Odwodnienie</div>
    <label class="symp-opt"><input type="radio" name="o_dehydration" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_dehydration" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. biegunka/wymioty, ma≈Ço pije" data-note>
  </div>

  <div class="symp-row" data-label="objawy alergiczne">
    <div class="symp-name">Objawy alergiczne</div>
    <label class="symp-opt"><input type="radio" name="o_allergy" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_allergy" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. pokrzywka, kichanie" data-note>
  </div>

  <div class="symp-row" data-label="obrzƒôk">
    <div class="symp-name">Obrzƒôk warg / jƒôzyka</div>
    <label class="symp-opt"><input type="radio" name="o_lip_tongue" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_lip_tongue" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="np. po czym" data-note>
  </div>

  <div class="symp-row" data-label="duszno≈õƒá po kontakcie z alergenem">
    <div class="symp-name">Duszno≈õƒá po kontakcie z alergenem</div>
    <label class="symp-opt"><input type="radio" name="o_allergy_dyspnea" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_allergy_dyspnea" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="alergen, czas" data-note>
  </div>

  <div class="symp-row" data-label="reakcja polekowa">
    <div class="symp-name">Reakcja polekowa</div>
    <label class="symp-opt"><input type="radio" name="o_drug_reaction" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_drug_reaction" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jaki lek" data-note>
  </div>

  <div class="symp-row" data-label="zatrucie">
    <div class="symp-name">Zatrucie</div>
    <label class="symp-opt"><input type="radio" name="o_poisoning" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_poisoning" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czym? kiedy?" data-note>
  </div>

  <div class="symp-row" data-label="podejrzenie zatrucia alkoholem">
    <div class="symp-name">Podejrzenie zatrucia alkoholem</div>
    <label class="symp-opt"><input type="radio" name="o_alcohol" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_alcohol" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="ilo≈õƒá / kiedy" data-note>
  </div>

  <div class="symp-row" data-label="podejrzenie zatrucia lekami">
    <div class="symp-name">Podejrzenie zatrucia lekami</div>
    <label class="symp-opt"><input type="radio" name="o_drugs_od" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_drugs_od" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jakie leki / dawka" data-note>
  </div>

  <div class="symp-row" data-label="podejrzenie zatrucia narkotykami">
    <div class="symp-name">Podejrzenie zatrucia narkotykami</div>
    <label class="symp-opt"><input type="radio" name="o_narcotics" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_narcotics" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="jakie? kiedy?" data-note>
  </div>

  <div class="symp-row" data-label="oparzenie">
    <div class="symp-name">Oparzenie</div>
    <label class="symp-opt"><input type="radio" name="o_burn" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_burn" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="miejsce/rozleg≈Ço≈õƒá" data-note>
  </div>

  <div class="symp-row" data-label="odmro≈ºenie">
    <div class="symp-name">Odmro≈ºenie</div>
    <label class="symp-opt"><input type="radio" name="o_frostbite" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_frostbite" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="miejsce/od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="u≈ºƒÖdlenie / ukƒÖszenie">
    <div class="symp-name">U≈ºƒÖdlenie / ukƒÖszenie</div>
    <label class="symp-opt"><input type="radio" name="o_bite_sting" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_bite_sting" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="co? kiedy? miejsce?" data-note>
  </div>

  <div class="symp-row" data-label="b√≥l ucha">
    <div class="symp-name">B√≥l ucha</div>
    <label class="symp-opt"><input type="radio" name="o_ear_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_ear_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="prawe/lewe, od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="b√≥l gard≈Ça">
    <div class="symp-name">B√≥l gard≈Ça</div>
    <label class="symp-opt"><input type="radio" name="o_throat_pain" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_throat_pain" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="od kiedy" data-note>
  </div>

  <div class="symp-row" data-label="krwawienie z nosa">
    <div class="symp-name">Krwawienie z nosa</div>
    <label class="symp-opt"><input type="radio" name="o_epistaxis" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_epistaxis" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="obfite? od kiedy?" data-note>
  </div>

  <div class="symp-row" data-label="utrata przytomno≈õci nieurazowa">
    <div class="symp-name">Utrata przytomno≈õci nieurazowa</div>
    <label class="symp-opt"><input type="radio" name="o_loc_nontrauma" value="yes"> Wystƒôpuje</label>
    <label class="symp-opt"><input type="radio" name="o_loc_nontrauma" value="no"> Neguje</label>
    <input class="symp-note" type="text" placeholder="czas, okoliczno≈õci" data-note>
  </div>

	</div>

    </div>
</div>
  <div class="tiny" style="margin-top:10px;">
  Je≈õli nie zaznaczysz ani ‚Äûwystƒôpuje‚Äù, ani ‚Äûneguje‚Äù ‚Äî objaw nie pojawi siƒô w wywiadzie.
</div>

</div> <!-- /#sympPanel -->
</div> <!-- / OBJAWY wrapper -->
</div>

</div>

<!-- 3c) WYWIAD CHOROBOWY + LEKI -->
<div class="sheet section-hxmeds">
  <h2><span class="section-title">WYWIAD CHOROBOWY ‚Ä¢ LEKI ‚Ä¢ ALERGIE</span></h2>

         <div class="row">
  <div style="grid-column:1/-1">
    <label>Wywiad (choroby przewlek≈Çe / przebyte zabiegi)</label>

    <label class="tiny" style="display:block;margin-bottom:6px;">
      <input type="checkbox" id="healthy_none">
      dotychczas zdrowy/nieleczony
    </label>

    <textarea id="interview_disease" placeholder="np. NT, DM, POChP, chor. serca, operacje..."></textarea>
  </div>
</div>


          <div class="row">
            <div>
              <label>Stosowane leki (sta≈Çe)</label>
              <textarea id="meds" placeholder="np. Acard, Polpril, Metocard..."></textarea>
            </div>
            <div>
              <label>Leki dora≈∫ne (PRN)</label>
              <textarea id="meds_prn" placeholder="np. przeciwb√≥lowe, przeciwzapalne..."></textarea>
            </div>
          </div>

	<div class="row">
	  <div style="grid-column:1/-1">
	    <label>Pominiƒôcie dawkowania lek√≥w</label>

	    <label class="tiny">
	      <input type="checkbox" id="miss_none">
	      Neguje pominiƒôcie dawek
	    </label><br>

	    <label class="tiny">
	      <input type="checkbox" id="miss_accidental">
	      Przypadkowe pominiƒôcie dawkowania
	    </label>

	    <input
	      type="text"
	      id="miss_accidental_note"
	      placeholder="kiedy, ile razy, kt√≥re leki"
	      style="margin-top:6px;"
	    >

	    <br><br>

	    <label class="tiny">
	      <input type="checkbox" id="miss_noncompliance">
	      Nie stosuje siƒô do zalece≈Ñ lekarza
	    </label>

	    <input
	      type="text"
	      id="miss_noncompliance_note"
	      placeholder="od kiedy / kt√≥rych lek√≥w"
	      style="margin-top:6px;"
	    >
	  </div>
	</div>

          <div class="row">
            <div style="grid-column:1/-1">
              <label>Alergie na leki</label>

<label class="tiny" style="display:block;margin-bottom:6px;">
  <input type="checkbox" id="allergies_none">
  nie stwierdzono
</label>

<input id="allergies" type="text" placeholder="np. penicylina / neguje"/>

            </div>
          </div>

	<div class="row">
	   <div style="grid-column:1/-1">
	     <label>U≈ºywki (alkohol, papierosy, kofeina, narkotyki)</label>
	     <textarea id="substances" placeholder="np. alkohol okazjonalnie, papierosy 10/d, kawa 3/d, narkotyki: neguje"></textarea>
	   </div>
	 </div>
<!-- Antykoncepcja hormonalna -->
<div class="row" id="antykoncepcja_wrap" style="margin-top:6px;">

  <div style="grid-column:1/-1">
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:6px;display:block;">
      Antykoncepcja hormonalna
    </label>

    <label class="tiny" style="margin-right:14px;">
      <input type="checkbox" id="antykoncepcja_tak"> tak
    </label>

    <label class="tiny">
      <input type="checkbox" id="antykoncepcja_nie"> nie
    </label>
  </div>
</div>

<!-- CIƒÑ≈ªA + OSTATNIA MIESIƒÑCZKA (tylko kobieta) -->
<div class="row" id="pregnancy_wrap" style="margin-top:6px;">
  <div style="grid-column:1/-1">
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:6px;display:block;">
      CiƒÖ≈ºa
    </label>

    <label class="tiny" style="margin-right:14px;">
      <input type="radio" name="pregnancy_status" id="preg_yes" value="tak"> tak
    </label>

    <label class="tiny" style="margin-right:14px;">
      <input type="radio" name="pregnancy_status" id="preg_not_excluded" value="nie wyklucza"> nie wyklucza
    </label>

    <label class="tiny" style="margin-right:14px;">
      <input type="radio" name="pregnancy_status" id="preg_suspects" value="podejrzewa"> podejrzewa
    </label>

    <label class="tiny">
      <input type="radio" name="pregnancy_status" id="preg_denies" value="neguje"> neguje
    </label>

    <input
      type="text"
      id="preg_note"
      placeholder="notatka (np. tc / test / objawy / IUP?)"
      style="margin-top:6px;"
    />
  </div>
</div>
</div>
<!-- / 3c) WYWIAD CHOROBOWY + LEKI -->

<div class="row" id="lmp_wrap" style="margin-top:6px;">
  <div style="grid-column:1/-1">
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:6px;display:block;">
      Ostatnia miesiƒÖczka
    </label>

    <input
      type="text"
      id="lmp_note"
      placeholder="notatka (data / ile dni temu / obfito≈õƒá)"
      style="margin-bottom:8px;"
    />

    <label class="tiny" style="margin-right:14px;">
      <input type="checkbox" id="lmp_regular"> regularna
    </label>

    <label class="tiny">
      <input type="checkbox" id="lmp_irregular"> nieregularna
    </label>
  </div>
</div>

<div class="row">
  <div style="grid-column:1/-1">
    <label>Wywiad rodzinny</label>
    <textarea
      id="family_history"
      placeholder="np. choroby serca, udary, cukrzyca, nowotwory, nag≈Çe zgony"
    ></textarea>
  </div>
</div>
<div class="row" style="margin-top:6px;">
  <div style="grid-column:1/-1">

    <label class="tiny" style="margin-right:14px;">
      <input type="radio" name="family_flag" id="family_none" value="bez obciƒÖ≈ºe≈Ñ">
      bez obciƒÖ≈ºe≈Ñ
    </label>

    <label class="tiny" style="margin-right:14px;">
      <input type="radio" name="family_flag" id="family_not_important" value="nie istotny">
      nie istotny
    </label>

    <label class="tiny">
      <input type="radio" name="family_flag" id="family_nonspecific" value="niespecyficzny">
      niespecyficzny
    </label>

  </div>
</div>


</div>
<!-- KONIEC: LEWA KOLUMNA (ale NIE zamykamy .grid) -->

<!-- TA SAMA KOLUMNA (ciƒÖg dalszy) ‚Äì  PODSUMOWANIE / HISTORIA -->


<!-- ================= STAN PSYCHICZNY (S) ‚Äì OSOBNA SEKCJA ================= -->
<div class="sheet section-psych">
  <h2>
    <span class="section-title">STAN PSYCHICZNY</span>
    <span class="pill">S</span>
  </h2>

  <button type="button"
          class="acc-btn"
          data-acc="suicide"
          aria-expanded="false">
    My≈õli, tendencje, zachowania suicydalne
    <span class="acc-chev">‚ñæ</span>
  </button>

  <div class="acc-panel" data-panel="suicide" hidden>

    <!-- MY≈öLI S -->
    <label style="font-weight:900;margin-top:6px;display:block;">My≈õli "S"</label>

    <label class="tiny">
      <input type="checkbox" id="suic_thoughts_no">
      Neguje my≈õli "S"
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_thoughts_yes">
      Przyznaje my≈õli "S"
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_thoughts_resign">
      My≈õli rezygnacyjne (‚Äûnie chce mi siƒô ≈ºyƒá‚Äù)
    </label>

    <input
      type="text"
      id="suic_thoughts_note"
      placeholder="notatka: od kiedy, jak czƒôsto, co nasila / zmniejsza"
      style="margin-top:6px;"
      disabled
    >

    <div class="divider"></div>

    <!-- TENDENCJE S -->
    <label style="font-weight:900;display:block;">Tendencje "S"</label>

    <label class="tiny">
      <input type="checkbox" id="suic_tendencies_no">
      Brak tendencji suicydalnych
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_tendencies_worse">
      NasilajƒÖce siƒô my≈õli w ostatnim czasie
    </label>
<input
  type="text"
  id="suic_tendencies_note"
  placeholder="notatka: od kiedy, jak czƒôsto, co nasila / zmniejsza"
  style="margin-top:6px;"
  disabled
>

    <div class="divider"></div>


    <!-- ZACHOWANIA -->
    <label style="font-weight:900;display:block;">Zachowania suicydalne</label>

    <label class="tiny">
      <input type="checkbox" id="suic_behavior_no">
      Brak zachowa≈Ñ suicydalnych
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_attempts">
      Przebyte pr√≥by "S"
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_selfharm">
      Samouszkodzenia (ciƒôcia, oparzenia itp.)
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_impulsive">
      Dzia≈Çanie pod wp≈Çywem impulsu
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_preparation">
      Przygotowania do pr√≥by (np. gromadzenie lek√≥w)
    </label><br>

    <label class="tiny">
      <input type="checkbox" id="suic_current">
      Aktualne zamiary "S"
    </label>
<input
  type="text"
  id="suic_behavior_note"
  placeholder="notatka: kiedy, w jaki spos√≥b, okoliczno≈õci"
  style="margin-top:6px;"
  disabled
>

<div class="divider"></div>

<label style="font-weight:900;display:block;">Opieka specjalistyczna</label>

<label class="tiny">
  <input type="checkbox" id="psych_treated_psychiatry">
  Leczony/a psychiatrycznie
</label><br>

<label class="tiny">
  <input type="checkbox" id="psych_med_adherent">
  Stosuje zalecone leki
</label><br>

<label class="tiny">
  <input type="checkbox" id="psych_not_treated">
  Nie leczony/a psychiatrycznie
</label><br>

<label class="tiny">
  <input type="checkbox" id="psych_psychologist">
  Pod opiekƒÖ psychologa / psychoterapeuty
</label>

<input
  type="text"
  id="psych_care_note"
  placeholder="notatka: rozpoznanie, leki, ostatnia kontrola, terapia"
  style="margin-top:6px;"
  disabled
>

  </div>
</div>
<!-- ================= KONIEC STANU PSYCHICZNEGO (S) ================= -->


<!-- ================= BADANIE FIZYKALNE ================= -->

<div class="sheet section-exam">
  <h2>
    <span class="section-title">BADANIE</span>
    <span class="pill">fizykalne</span>
  </h2>

  <button type="button" class="acc-btn" id="examToggle" aria-expanded="false">
    Badanie fizykalne (kliknij, aby rozwinƒÖƒá)
    <span class="acc-chev">‚ñæ</span>
  </button>

  <div class="acc-panel" id="examPanel" hidden>

    <!-- WZORZEC PODSEKCJI -->
    <!-- ================= NEURO ================= -->
    <div class="sub-acc">
      <button type="button" class="sub-acc-btn" data-subacc="exam_neuro">
        Badanie neurologiczne
        <span class="sub-acc-chev">‚ñæ</span>
      </button>
<div class="sub-acc-panel" data-subpanel="exam_neuro" hidden>

  <div class="row">
    <div style="grid-column:1/-1">
      <label class="tiny"><input type="checkbox" id="exam_neuro_ok"> bez ubytk√≥w neurologicznych</label>
    </div>
  </div>

  <div class="row">
    <div>
      <label>≈πrenice</label>
      <select id="exam_pupils">
        <option value="">‚Äî</option>
        <option value="r√≥wne">r√≥wne</option>
        <option value="nier√≥wne">nier√≥wne</option>
      </select>
    </div>

    <div>
      <label>Zaburzenia mowy</label>
      <select id="exam_speech_disorder">
        <option value="">‚Äî</option>
        <option value="afazja">afazja</option>
        <option value="dyzartria">dyzartria</option>
      </select>
    </div>
  </div>

  <div class="row">
    <div>
      <label class="tiny"><input type="checkbox" id="exam_face_drop"> opadanie kƒÖcika ust</label><br>
      <label class="tiny"><input type="checkbox" id="exam_face_asym"> asymetria twarzy</label><br>
      <label class="tiny"><input type="checkbox" id="exam_swallow"> zaburzenia po≈Çykania</label><br>
      <label class="tiny"><input type="checkbox" id="exam_vision"> zaburzenia widzenia</label><br>
      <label class="tiny"><input type="checkbox" id="exam_strength_weak"> os≈Çabienie si≈Çy miƒô≈õniowej</label><br>
      <label class="tiny"><input type="checkbox" id="exam_sensory"> zaburzenia czucia</label><br>
      <label class="tiny"><input type="checkbox" id="exam_seizures"> drgawki</label><br>
      <label class="tiny"><input type="checkbox" id="exam_tremor"> dr≈ºenia miƒô≈õniowe</label>
    </div>

    <div>
      <label>Si≈Ça ko≈Ñczyn</label>
      <select id="exam_limb_strength">
        <option value="">‚Äî</option>
        <option value="symetryczna">symetryczna</option>
        <option value="os≈Çabiona">os≈Çabiona</option>
      </select>

      <div style="height:10px"></div>

      <label>Niedow≈Çad</label>
      <select id="exam_paresis">
        <option value="">‚Äî</option>
        <option value="brak">brak</option>
        <option value="prawostronny">prawostronny</option>
        <option value="lewostronny">lewostronny</option>
        <option value="czteroko≈Ñczynowy">czteroko≈Ñczynowy</option>
      </select>

      <div style="height:10px"></div>

      <label>Czucie</label>
      <select id="exam_sensation">
        <option value="">‚Äî</option>
        <option value="zachowane">zachowane</option>
        <option value="zaburzone">zaburzone</option>
        <option value="drƒôtwienie">drƒôtwienie</option>
        <option value="parestezje">parestezje</option>
        <option value="brak czucia">brak czucia</option>
      </select>
    </div>
  </div>

  <div class="row">
    <div>
      <label>Koordynacja / ch√≥d</label>
      <select id="exam_coord_gait">
        <option value="">‚Äî</option>
        <option value="pr√≥ba palec‚Äìnos prawid≈Çowa">pr√≥ba palec‚Äìnos prawid≈Çowa</option>
        <option value="niezborno≈õƒá">niezborno≈õƒá</option>
        <option value="ch√≥d prawid≈Çowy">ch√≥d prawid≈Çowy</option>
        <option value="ch√≥d niepewny">ch√≥d niepewny</option>
        <option value="brak mo≈ºliwo≈õci oceny">brak mo≈ºliwo≈õci oceny</option>
      </select>
    </div>
    <div>

      <label>Pr√≥ba Romberga</label>
      <select id="exam_romberg">
        <option value="">‚Äî</option>
        <option value="bz">bz</option>
        <option value="zachwiana">zachwiana</option>
      </select>
    </div>
  </div>

<br>
<label class="tiny"><input type="checkbox" id="exam_neck_stiff"> sztywno≈õƒá karku</label>
<input
  type="text"
  id="exam_neck_stiff_note"
  placeholder="notatka (np. od kiedy / uraz? / nasilona)"
  style="margin-top:6px;"
  disabled
>

    <div class="row">
    <div style="grid-column:1/-1">
      <label>Notatka (inne / opis)</label>
      <textarea id="exam_neuro_note" placeholder="inne (opis)"></textarea>
    </div>
  </div>

</div> <!-- /sub-acc-panel exam_neuro -->
</div> <!-- /sub-acc exam_neuro -->



<!-- ================= UK≈ÅAD KRƒÑ≈ªENIA ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_cardio">
    Uk≈Çad krƒÖ≈ºenia
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_cardio" hidden>
<!-- WYDOLNO≈öƒÜ KRƒÑ≈ªENIOWA -->
<div class="row" style="margin-top:6px;">
  <div style="grid-column:1/-1">
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:6px;display:block;">
      Wydolno≈õƒá krƒÖ≈ºeniowa
    </label>

    <label class="tiny" style="margin-right:14px;">
  <input type="checkbox" id="exam_cardio_eff_ok"> wydolny
</label>

<label class="tiny">
  <input type="checkbox" id="exam_cardio_eff_fail"> niewydolny
</label>

  </div>
</div>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_hr_regular"> tƒôtno miarowe</label><br>
        <label class="tiny"><input type="checkbox" id="exam_hr_irregular"> tƒôtno niemiarowe</label><br>
        <label class="tiny"><input type="checkbox" id="exam_tachy"> tachykardia</label><br>
        <label class="tiny"><input type="checkbox" id="exam_brady"> bradykardia</label><br>
        <label class="tiny"><input type="checkbox" id="exam_arrhythmia"> zaburzenia rytmu serca</label><br>
        <label class="tiny"><input type="checkbox" id="exam_edema"> obrzƒôki obwodowe</label>
      </div>

      <div>
        <label class="tiny"><input type="checkbox" id="exam_crt_lt2"> nawr√≥t kapilarny &lt; 2 s</label><br>
        <label class="tiny"><input type="checkbox" id="exam_crt_gt2"> nawr√≥t kapilarny &gt; 2 s</label><br>
        <label class="tiny"><input type="checkbox" id="exam_hypotension"> hipotonia</label><br>
        <label class="tiny"><input type="checkbox" id="exam_hypertension"> hipertensja</label>
      </div>
    </div>

    <div class="row">
      <div style="grid-column:1/-1">
        <label>Notatka (inne / opis)</label>
        <textarea id="exam_cardio_note" placeholder="np. HR ~110/min, nieregularne, obrzƒôki kostek, CRT >2 s"></textarea>
           </div>
    </div>

  </div> <!-- /sub-acc-panel exam_cardio -->
</div> <!-- /sub-acc exam_cardio -->



   <!-- ================= UK≈ÅAD ODDECHOWY ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_resp" aria-expanded="false">
    Uk≈Çad oddechowy
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_resp" hidden>
<!-- WYDOLNO≈öƒÜ ODDECHOWA -->
<div class="row" style="margin-top:6px;">
  <div style="grid-column:1/-1">
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:6px;display:block;">
      Wydolno≈õƒá oddechowa
    </label>

    <label class="tiny" style="margin-right:14px;">
      <input type="checkbox" id="exam_resp_eff_ok"> wydolny
    </label>

    <label class="tiny">
      <input type="checkbox" id="exam_resp_eff_fail"> niewydolny
    </label>
  </div>
</div>

    <div class="row">
      <div>
        <label>Tor oddechu</label>
        <select id="exam_resp_pattern">
          <option value="">‚Äî</option>
          <option value="prawid≈Çowy">prawid≈Çowy</option>
          <option value="przyspieszony">przyspieszony</option>
          <option value="utrudniony">utrudniony</option>
        </select>
      </div>

      <div>
        <label>Duszno≈õƒá</label>
        <select id="exam_resp_dyspnea">
          <option value="">‚Äî</option>
          <option value="spoczynkowa">spoczynkowa</option>
          <option value="wysi≈Çkowa">wysi≈Çkowa</option>
          <option value="brak">brak</option>
        </select>
      </div>
    </div>

    <div class="divider"></div>

    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      Tor oddychania
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_resp_tachypnoe"> tachypnoe</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_bradypnoe"> bradypnoe</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_irregular"> oddech nieregularny</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_apnea"> bezdechy</label>
      </div>

      <div>
        <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
          Wysi≈Çek oddechowy
        </label>
        <label class="tiny"><input type="checkbox" id="exam_resp_accessory"> u≈ºycie dodatkowych miƒô≈õni oddechowych</label>
      </div>
    </div>

    <div class="divider"></div>

    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      Symetria i ruchomo≈õƒá klatki piersiowej
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_resp_chest_sym"> symetryczna</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_chest_asym"> asymetria ruch√≥w</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_chest_limited"> ograniczona ruchomo≈õƒá</label>
      </div>

      <div>
        <label>Notatka (symetria / opis)</label>
        <input id="exam_resp_chest_note" type="text" placeholder="np. os≈Çabienie ruch√≥w po prawej">
      </div>
    </div>

    <div class="divider"></div>

    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      Dodatkowe objawy
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_resp_cough_dry"> kaszel suchy</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_cough_wet"> kaszel mokry</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_sputum"> odkrztuszanie wydzieliny</label><br>
        <label class="tiny"><input type="checkbox" id="exam_resp_hemoptysis"> krwioplucie</label>
      </div>

      <div>
        <label class="tiny"><input type="checkbox" id="exam_resp_pleuritic_pain"> b√≥l w klatce piersiowej przy oddychaniu</label>
      </div>
    </div>

    <div class="row">
      <div style="grid-column:1/-1">
        <label>Notatka (inne / opis)</label>
        <textarea id="exam_resp_note" placeholder="np. ≈õwisty, rzƒô≈ºenia, duszno≈õƒá nasilona, odkrztusza ≈º√≥≈ÇtƒÖ wydzielinƒô"></textarea>
      </div>
    </div>

  </div>
</div>


<!-- ================= JAMA BRZUSZNA ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_abd">
    Jama brzuszna
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_abd" hidden>

    <!-- BRZUCH -->
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      Brzuch
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_abd_soft"> miƒôkki</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_hard"> twardy</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_tender"> bolesny</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_nontender"> niebolesny</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_no_tenderness"> b√≥l przy palpacji</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_distended"> wzdƒôty</label>
      </div>

      <div>
        <label>Objawy otrzewnowe</label>
        <select id="exam_abd_peritoneal">
          <option value="">‚Äî</option>
          <option value="+">+</option>
          <option value="-">-</option>
        </select>

        <div style="height:10px"></div>

        <label>Perystaltyka</label>
        <select id="exam_abd_peristalsis">
          <option value="">‚Äî</option>
          <option value="prawid≈Çowa">prawid≈Çowa</option>
          <option value="os≈Çabiona">os≈Çabiona</option>
          <option value="brak">brak</option>
        </select>

        <div style="height:10px"></div>

        <label>Objaw Goldflama</label>
        <div class="row" style="grid-template-columns: 1fr 1fr; gap:10px; margin-bottom:0;">
          <div>
            <label class="tiny">Strona</label>
            <select id="exam_abd_goldflam_side">
              <option value="">‚Äî</option>
              <option value="prawa">prawa</option>
              <option value="lewa">lewa</option>
            </select>
          </div>
          <div>
            <label class="tiny">Wynik</label>
            <select id="exam_abd_goldflam_res">
              <option value="">‚Äî</option>
              <option value="+">+</option>
              <option value="-">-</option>
              <option value="+/-">+/-</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <div class="divider"></div>

    <!-- DODATKOWE -->
    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      Dodatkowo
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_abd_scars"> blizny pooperacyjne</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_hernia_visible"> przepuklina widoczna</label>
      </div>
      <div>
        <label>Lokalizacja b√≥lu</label>
        <label class="tiny"><input type="checkbox" id="exam_abd_pain_epigastrium"> nadbrzusze</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_pain_mesogastrium"> ≈õr√≥dbrzusze</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_pain_hypogastrium"> podbrzusze</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_pain_rlq"> prawy d√≥≈Ç biodrowy</label><br>
        <label class="tiny"><input type="checkbox" id="exam_abd_pain_llq"> lewy d√≥≈Ç biodrowy</label>
      </div>
    </div>

    <div class="row">
      <div style="grid-column:1/-1">
        <label>Notatka (inne / opis)</label>
        <textarea id="exam_abd_note" placeholder="np. obrona miƒô≈õniowa, dodatni Blumberg, nasilenie b√≥lu, promieniowanie"></textarea>
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_abd -->
</div> <!-- /sub-acc exam_abd -->

   
   <!-- ================= UK≈ÅAD MOCZOWO-P≈ÅCIOWY ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_uro">
    Uk≈Çad moczowy
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_uro" hidden>

    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      Dolegliwo≈õci
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_uro_none"> brak dolegliwo≈õci</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_dysuria_pain"> b√≥l przy mikcji</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_dysuria_burn"> pieczenie przy mikcji</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_frequency"> czƒôstomocz</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_urgency"> parcie naglƒÖce</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_incontinence"> nietrzymanie moczu</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_oliguria"> skƒÖpomocz</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_hematuria"> krwiomocz</label>
      </div>

      <div>
        <label>Podbrzusze / pƒôcherz</label>
        <select id="exam_uro_suprapubic">
          <option value="">‚Äî</option>
          <option value="bez bolesno≈õci">bez bolesno≈õci</option>
          <option value="bolesno≈õƒá podbrzusza">bolesno≈õƒá podbrzusza</option>
        </select>

        <div style="height:10px"></div>

        <label>Dodatkowe informacje (diureza/cewnik)</label>
        <select id="exam_uro_diuresis">
          <option value="">‚Äî</option>
          <option value="cewnik Foleya">cewnik Foleya</option>
          <option value="brak diurezy">brak diurezy</option>
          <option value="diureza zachowana">diureza zachowana</option>
        </select>
      </div>
    </div>

    <div class="divider"></div>

    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      NarzƒÖdy p≈Çciowe
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_uro_genital_ok"> bez zmian</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_genital_swelling"> obrzƒôk</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_genital_tender"> bolesno≈õƒá</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_genital_redness"> zaczerwienienie</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_genital_discharge"> wydzielina</label><br>
        <label class="tiny"><input type="checkbox" id="exam_uro_genital_bleeding"> krwawienie</label>
      </div>

      <div>
        <label>Opis / lokalizacja</label>
        <textarea id="exam_uro_genital_note" placeholder="np. obrzƒôk moszny po prawej, zaczerwienienie w okolicy uj≈õcia cewki, wydzielina ropna"></textarea>
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_uro -->
</div> <!-- /sub-acc exam_uro -->

   <!-- ================= UK≈ÅAD RUCHU / URAZ KO≈ÉCZYN ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_msk">
    Uk≈Çad ruchu / uraz ko≈Ñczyn
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_msk" hidden>

    <label style="font-size:12px;color:var(--muted);font-weight:900;margin-bottom:8px;display:block;">
      OglƒÖdanie / zmiany
    </label>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_msk_ok"> bez widocznych zmian</label><br>
        <label class="tiny"><input type="checkbox" id="exam_msk_deformity"> deformacje</label><br>
        <label class="tiny"><input type="checkbox" id="exam_msk_swelling"> obrzƒôk</label><br>
        <label class="tiny"><input type="checkbox" id="exam_msk_hematoma"> krwiak</label><br>
        <label class="tiny"><input type="checkbox" id="exam_msk_wounds"> rany</label><br>
        <label class="tiny"><input type="checkbox" id="exam_msk_shortening"> skr√≥cenie ko≈Ñczyny</label>
      </div>

      <div>
        <label>Lokalizacja / uwagi</label>
        <textarea id="exam_msk_note" placeholder="np. obrzƒôk stawu skokowego P, rana ciƒôta podudzia L, skr√≥cenie KKD P"></textarea>
      </div>
    </div>

    <div class="divider"></div>

    <div class="row">
      <div>
        <label>Zakres ruchu ko≈Ñczyn</label>
        <select id="exam_msk_rom">
          <option value="">‚Äî</option>
          <option value="pe≈Çny">pe≈Çny</option>
          <option value="ograniczony">ograniczony</option>
          <option value="brak mo≈ºliwo≈õci ruchu">brak mo≈ºliwo≈õci ruchu</option>
        </select>
      </div>

      <div>
        <label>Stabilno≈õƒá / uraz</label>
        <select id="exam_msk_stability">
          <option value="">‚Äî</option>
          <option value="stabilny">stabilny</option>
          <option value="podejrzenie urazu">podejrzenie urazu</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div>
        <label>ObciƒÖ≈ºanie ko≈Ñczyn</label>
        <select id="exam_msk_weightbearing">
          <option value="">‚Äî</option>
          <option value="ch√≥d prawid≈Çowy">ch√≥d prawid≈Çowy</option>
          <option value="utykanie">utykanie</option>
          <option value="brak mo≈ºliwo≈õci obciƒÖ≈ºania">brak mo≈ºliwo≈õci obciƒÖ≈ºania</option>
        </select>
      </div>

      <div>
        <label>KrƒÖ≈ºenie obwodowe</label>
        <select id="exam_msk_peripheral_pulse">
          <option value="">‚Äî</option>
          <option value="tƒôtno obwodowe wyczuwalne">tƒôtno obwodowe wyczuwalne</option>
          <option value="os≈Çabione">os≈Çabione</option>
          <option value="niewyczuwalne">niewyczuwalne</option>
        </select>
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_msk -->
</div> <!-- /sub-acc exam_msk -->


    <!-- ================= MOTORYCZNO≈öƒÜ PACJENTA ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_mobility">
    Motoryczno≈õƒá pacjenta
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_mobility" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_mobility_independent"> samodzielny</label><br>
        <label class="tiny"><input type="checkbox" id="exam_mobility_aid"> porusza siƒô przy pomocy sprzƒôtu wspomagajƒÖcego</label><br>
        <label class="tiny"><input type="checkbox" id="exam_mobility_wheelchair"> przemieszcza siƒô na w√≥zku</label><br>
        <label class="tiny"><input type="checkbox" id="exam_mobility_bedbound"> pacjent le≈ºƒÖcy</label>
      </div>

      <div>
        <label>Sprzƒôt / uwagi</label>
        <input id="exam_mobility_note" type="text" placeholder="np. kule, laska, balkonik, pomoc osoby trzeciej">
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_mobility -->
</div> <!-- /sub-acc exam_mobility -->

<!-- ================= SK√ìRA ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_skin">
    Sk√≥ra
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_skin" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_skin_pink"> r√≥≈ºowa</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_pale"> blada</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_cyanotic"> sina</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_sweaty"> spocona</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_dry"> sucha</label>
      </div>

      <div>
        <label class="tiny"><input type="checkbox" id="exam_skin_rash"> wysypka</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_trophic"> zmiany troficzne</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_edema"> obrzƒôk</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_ulcers"> owrzodzenia</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_pressure"> odle≈ºyny</label><br>
        <label class="tiny"><input type="checkbox" id="exam_skin_wounds"> rany</label>
      </div>
    </div>

    <div class="row">
      <div style="grid-column:1/-1">
        <label>Opis / lokalizacja zmian</label>
        <textarea id="exam_skin_note" placeholder="np. blada, spocona; wysypka plamista na tu≈Çowiu; odle≈ºyna krzy≈ºowa I¬∞"></textarea>
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_skin -->
</div> <!-- /sub-acc exam_skin -->

<!-- ================= APETYT ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_appetite">
    Apetyt
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_appetite" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_appetite_normal"> prawid≈Çowy</label><br>
        <label class="tiny"><input type="checkbox" id="exam_appetite_decreased"> zmniejszony</label><br>
        <label class="tiny"><input type="checkbox" id="exam_appetite_none"> brak apetytu</label><br>
        <label class="tiny"><input type="checkbox" id="exam_appetite_disturbed"> zaburzony</label>
      </div>

      <div>
        <label>Uwagi / od kiedy</label>
        <input id="exam_appetite_note" type="text" placeholder="np. od 3 dni, od poczƒÖtku choroby, stopniowo narastajƒÖco">
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_appetite -->
</div> <!-- /sub-acc exam_appetite -->

<!-- ================= STOSOWANE DIETY ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_diet">
    Stosowane diety
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_diet" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_diet_none"> bez ogranicze≈Ñ</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_diabetic"> cukrzycowa</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_lowsodium"> niskosodowa</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_glutenfree"> bezglutenowa</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_vegetarian"> wegetaria≈Ñska</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_vegan"> wega≈Ñska</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_highprotein"> wysokobia≈Çkowa</label><br>
        <label class="tiny"><input type="checkbox" id="exam_diet_reduction"> redukcyjna</label>
      </div>

      <div>
        <label>Inna dieta</label>
        <input id="exam_diet_other" type="text" placeholder="np. ≈Çatwostrawna, FODMAP, ketogenna">
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_diet -->
</div> <!-- /sub-acc exam_diet -->

<!-- ================= MASA CIA≈ÅA ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_weight">
    Masa cia≈Ça
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_weight" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_weight_stable"> stabilna</label><br>
        <label class="tiny"><input type="checkbox" id="exam_weight_loss"> niezamierzona utrata masy cia≈Ça</label><br>
        <label class="tiny"><input type="checkbox" id="exam_weight_gain"> niezamierzony wzrost masy cia≈Ça</label>
      </div>

      <div>
        <label>kg / czas</label>
        <input id="exam_weight_note" type="text" placeholder="np. -5 kg / 2 mies., +3 kg / 1 mies.">
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_weight -->
</div> <!-- /sub-acc exam_weight -->

<!-- ================= ODDAWANIE STOLCA ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_stool">
    Oddawanie stolca
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_stool" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_stool_regular"> regularne</label><br>
        <label class="tiny"><input type="checkbox" id="exam_stool_irregular"> nieregularne</label><br>
        <label class="tiny"><input type="checkbox" id="exam_stool_constipation"> zaparcia</label><br>
        <label class="tiny"><input type="checkbox" id="exam_stool_diarrhea"> biegunka</label><br>
        <label class="tiny"><input type="checkbox" id="exam_stool_alternating"> naprzemiennie zaparcia / biegunka</label><br>
        <label class="tiny"><input type="checkbox" id="exam_stool_none"> brak stolca</label>
      </div>

      <div>
        <label class="tiny"><input type="checkbox" id="exam_stool_melena"> smoliste stolce</label><br>
        <label class="tiny"><input type="checkbox" id="exam_stool_fresh_blood"> ≈õwie≈ºa krew w stolcu</label>
      </div>
    </div>

    <div class="row">
      <div style="grid-column:1/-1">
        <label>Uwagi / od kiedy</label>
        <input id="exam_stool_note" type="text" placeholder="np. biegunka od 3 dni, brak stolca od 5 dni, krew od dzi≈õ">
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_stool -->
</div> <!-- /sub-acc exam_stool -->

<!-- ================= SEN ================= -->
<div class="sub-acc">
  <button type="button" class="sub-acc-btn" data-subacc="exam_sleep">
    Sen
    <span class="sub-acc-chev">‚ñæ</span>
  </button>

  <div class="sub-acc-panel" data-subpanel="exam_sleep" hidden>

    <div class="row">
      <div>
        <label class="tiny"><input type="checkbox" id="exam_sleep_normal"> prawid≈Çowy</label><br>
        <label class="tiny"><input type="checkbox" id="exam_sleep_onset"> trudno≈õci z zasypianiem</label><br>
        <label class="tiny"><input type="checkbox" id="exam_sleep_awakenings"> czƒôste wybudzanie</label><br>
        <label class="tiny"><input type="checkbox" id="exam_sleep_fragmented"> sen przerywany</label><br>
        <label class="tiny"><input type="checkbox" id="exam_sleep_insomnia"> bezsenno≈õƒá</label><br>
        <label class="tiny"><input type="checkbox" id="exam_sleep_daytime_sleepiness"> nadmierna senno≈õƒá w ciƒÖgu dnia</label>
      </div>

      <div>
        <label>Od kiedy / uwagi</label>
        <input id="exam_sleep_note" type="text" placeholder="np. od tygodnia, od poczƒÖtku infekcji, po lekach">
      </div>
    </div>

  </div> <!-- /sub-acc-panel exam_sleep -->
</div> <!-- /sub-acc exam_sleep -->


  </div>
</div>
</div> <!-- /acc-panel examPanel -->
</div> <!-- /sheet BADANIE -->

<!-- ================= KONIEC BADANIA ================= -->


        <!-- PODSUMOWANIE -->
       
 <div class="sheet section-summary">
          <h2><span class="section-title">PODSUMOWANIE</span></h2>
          <div class="summary" id="summaryBox"></div>
          <textarea id="summary" style="position:absolute;left:-9999px;top:-9999px;"></textarea>
        </div>
<div class="actions actions-bottom">
  <button id="btn_summary" type="button" class="btn btn-summary">üìã PODSUMOWANIE</button>
  <button id="btn_copy" type="button" class="btn btn-copy">üìÑ Kopiuj</button>
  <button id="btn_pdf" type="button" class="btn btn-pdf">üñ®Ô∏è PDF</button>
  <button id="btn_clear" type="button" class="btn btn-reset">üßπ Wyczy≈õƒá formularz</button>
</div>




        <!-- HISTORIA -->
       <div class="sheet section-history">

          <h2><span class="section-title">HISTORIA (lokalnie)</span></h2>
          <div class="actions" style="margin-top:0;">
            
           
          </div>
          <div class="divider"></div>
          <div class="history" id="history"></div>
          <div class="tiny">Zapisywane w przeglƒÖdarce (localStorage) ‚Äî nie wysy≈Çane nigdzie.</div>
        </div>
      </div>
    </div>
  </div>

<!-- PRINT ONLY -->
<div id="printArea" class="print-area" aria-hidden="true"></div>

  <script>
  // Helpers
  const $ = (id) => document.getElementById(id);
  const on = (id, ev, fn) => $(id)?.addEventListener(ev, fn);

// ===== AUTO-RESIZE TEXTAREA (AUTO + MO≈ªNA RƒòCZNIE) =====
function autoResizeTextarea(el){
  if(!el) return;

  // minimalna wysoko≈õƒá = ta, kt√≥rƒÖ user sobie rƒôcznie ustawi≈Ç (je≈õli ustawi≈Ç)
  const manualMin = Number(el.dataset.manualMin || 0);

  el.style.height = 'auto';

  requestAnimationFrame(() => {
    const autoH = el.scrollHeight;
    const finalH = Math.max(autoH, manualMin);
    el.style.height = finalH + 'px';
  });
}

function bindAutoResize(id){
  const el = $(id);
  if(!el) return;

  // auto przy pisaniu / wklejaniu
  el.addEventListener('input', () => autoResizeTextarea(el));
  el.addEventListener('paste', () => setTimeout(() => autoResizeTextarea(el), 0));

  // je≈õli user rƒôcznie rozciƒÖgnie pole, zapamiƒôtaj to jako minimum
  const rememberManual = () => {
    el.dataset.manualMin = String(el.offsetHeight);
  };
  el.addEventListener('mouseup', rememberManual);
  el.addEventListener('touchend', rememberManual);

  // start
  autoResizeTextarea(el);
}

// ===== REQUIRED: wiek / p≈Çeƒá / pow√≥d zg≈Çoszenia =====
function markRequired(el, isMissing){
  if(!el) return;

  el.classList.toggle('req-missing', !!isMissing);

  const wrap = el.closest('div');
  const lab = wrap ? wrap.querySelector('label') : null;
  if(lab) lab.classList.toggle('req-label-missing', !!isMissing);
}

function validateRequiredFields(){
  const ageEl = $('age');
  const sexEl = $('sex');
  const chiefEl = $('chief');

  const ageMissing = !((ageEl?.value || '').trim());
  const sexMissing = !((sexEl?.value || '').trim());
  const chiefMissing = !((chiefEl?.value || '').trim());

  markRequired(ageEl, ageMissing);
  markRequired(sexEl, sexMissing);
  markRequired(chiefEl, chiefMissing);
}

// ===== ORIENTACJA: logika checkbox√≥w =====
function syncOrientationLogic(){
  const dis = $('orient_disoriented');
  const t = $('orient_time');
  const p = $('orient_place');
  const s = $('orient_person');

  if(!dis || !t || !p || !s) return;

  // je≈õli "zdezorientowany" -> odznacz pozosta≈Çe
  if(dis.checked){
    t.checked = false;
    p.checked = false;
    s.checked = false;
  }
}
// ===== TRYB ZG≈ÅOSZENIA / SKIEROWANIE: logika =====
function getArrivalMode(){
  const zrm = $('arrival_zrm')?.checked;
  const self = $('arrival_self')?.checked;
  const ref = $('arrival_referral')?.checked;

  if(zrm) return 'zrm';
  if(self) return 'self';
  if(ref) return 'referral';
  return '';
}

function syncArrivalLogic(){
  const note = $('arrival_note');
  const mode = getArrivalMode();
  if(!note) return;

  // dopisek sensowny g≈Ç√≥wnie przy skierowaniu (ale mo≈ºesz zostawiƒá zawsze aktywne)
  // Tu wersja: aktywne zawsze, tylko placeholder zmieniamy:
  if(mode === 'referral'){
    note.placeholder = 'np.: POZ / OCD / Allmedica';
  } else {
    note.placeholder = 'opcjonalnie (np. ≈∫r√≥d≈Ço: POZ / Allmedica)';
  }
}

// ===== WYWIAD CHOROBOWY: "dotychczas zdrowy" =====
function syncHealthyLogic(){
  const cb = $('healthy_none');
  const ta = $('interview_disease');
  if(!cb || !ta) return;

  if(cb.checked){
    ta.value = '';
    ta.disabled = true;
  } else {
    ta.disabled = false;
  }
}

// ===== ALERGIE: "nie stwierdzono" =====
function syncAllergiesLogic(){
  const cb = $('allergies_none');
  const inp = $('allergies');
  if(!cb || !inp) return;

  if(cb.checked){
    inp.value = 'nie stwierdzono';
    inp.readOnly = true;
  } else {
    if(inp.value.trim().toLowerCase() === 'nie stwierdzono') inp.value = '';
    inp.readOnly = false;
  }
}
function syncAntykoncepcjaVisibility(){
  const sexVal = $('sex')?.value || '';

  const antiWrap = $('antykoncepcja_wrap');
  const pregWrap = $('pregnancy_wrap');
  const lmpWrap  = $('lmp_wrap');

  const show = (sexVal === 'K');

  if(antiWrap) antiWrap.style.display = show ? '' : 'none';
  if(pregWrap) pregWrap.style.display = show ? '' : 'none';
  if(lmpWrap)  lmpWrap.style.display  = show ? '' : 'none';

  // je≈õli nie kobieta ‚Üí czy≈õcimy, ≈ºeby nie zostawa≈Ço w tle
  if(!show){
    if($('antykoncepcja_tak')) $('antykoncepcja_tak').checked = false;
    if($('antykoncepcja_nie')) $('antykoncepcja_nie').checked = false;

    document.querySelectorAll('input[name="pregnancy_status"]').forEach(r => r.checked = false);
    if($('preg_note')) $('preg_note').value = '';

    if($('lmp_note')) $('lmp_note').value = '';
    if($('lmp_regular')) $('lmp_regular').checked = false;
    if($('lmp_irregular')) $('lmp_irregular').checked = false;
  }
}


['arrival_zrm','arrival_self','arrival_referral'].forEach(id => on(id,'change', () => {
  syncArrivalLogic();
  updateSummary();
}));
on('arrival_note','input', updateSummary);

on('healthy_none','change', () => {
  syncHealthyLogic();
  updateSummary();
});
['family_none','family_not_important','family_nonspecific'].forEach(id => {
  on(id, 'change', () => {
    if ($('family_history')) $('family_history').value = '';
    updateSummary();
  });
});

on('family_history','input', () => {
  document.querySelectorAll('input[name="family_flag"]').forEach(r => r.checked = false);
  updateSummary();
});

on('allergies_none','change', () => {
  syncAllergiesLogic();
  updateSummary();
});

// init
document.addEventListener('DOMContentLoaded', () => {
  syncArrivalLogic();
  syncHealthyLogic();
  syncAllergiesLogic();
  syncAntykoncepcjaVisibility();
syncSuicTendenciesNote();
syncSuicBehaviorNote();
syncPsychCareNote();

});



// podpinamy zdarzenia
['orient_disoriented','orient_time','orient_place','orient_person']
  .forEach(id => on(id, 'change', syncOrientationLogic));


// ===== AVPU -> automatyczne akcje =====
// Je≈õli AVPU = V/P/U:
// - Kontakt s≈Çowny ustaw na "nie"
function syncAvpuEffects(){
  const avpu = $('avpu')?.value || '';
  const vc = $('verbal_contact');

  // AVPU A -> je≈õli puste, ustaw logiczny
  if(avpu === 'A'){
    if(vc && !vc.value) vc.value = 'logiczny';
  }

  // AVPU V -> nielogiczny
  if(avpu === 'V'){
    if(vc) vc.value = 'nielogiczny';
  }

  // AVPU P/U -> brak kontaktu
  if(avpu === 'P' || avpu === 'U'){
    if(vc) vc.value = 'brak';
  }

  // ORIENTACJA: je≈õli V/P/U -> zdezorientowany
  const dis = $('orient_disoriented');
  const t = $('orient_time');
  const p = $('orient_place');
  const s = $('orient_person');

  if(['V','P','U'].includes(avpu)){
    if(dis) dis.checked = true;
    if(t) t.checked = false;
    if(p) p.checked = false;
    if(s) s.checked = false;
  }
}

// ===== PROPONOWANE OBJAWY (na podstawie powodu zg≈Çoszenia) =====

// mapowanie s≈Ç√≥w kluczowych -> lista objaw√≥w (po data-label!)
const CHIEF_TO_SYMPTOMS = [
 {
  keys: [
    'cia≈Ça obcego w oku',
  ],
  labels: [
    'b√≥l oka',
    'uczucie ‚Äûpiasku‚Äù pod powiekƒÖ',
    '≈Çzawienie',
    '≈õwiat≈Çowstrƒôt',
    'zaczerwienienie oka',
    'pogorszenie ostro≈õci widzenia',
    'krwawienie',
    'b√≥l g≈Çowy'
  ],
  sub: 'other'
},
{
  keys: [
    'cia≈Ça obcego w prze≈Çyku',
  ],
  labels: [
    'duszno≈õƒá',
    'b√≥l w klatce piersiowej',
    'chrypka',
    'krwioplucie',
    'gorƒÖczka',
    'objawy infekcyjne',
    'kaszel',
    'wymioty',
    'nudno≈õci'
  ],
  sub: 'other'
},

{
  keys: [
    'cia≈Ça obcego w odbycie',
  ],
  labels: [
    'b√≥l odbytu',
    'b√≥l podbrzusza',
    'uczucie rozpierania',
    'parcie na stolec',
    'trudno≈õci w oddawaniu stolca i gaz√≥w',
    'krwawienie z odbytu',
    'nudno≈õci',
    'wymioty',
    'gorƒÖczka',
    'dreszcze'
  ],
  sub: 'other'
},
{
  keys: [
    'cia≈Ça obcego w drogach rodnych',
    'cia≈Ça obcego w pochwie',
  ],
  labels: [
    'uczucie cia≈Ça obcego',
    'dyskomfort',
    'b√≥l podbrzusza',
    '≈õwiƒÖd',
    'pieczenie',
    'nieprawid≈Çowa wydzielina z pochwy',
    'krwawienie',
    'plamienie',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty'
  ],
  sub: 'other'
},

{
  keys: [
    'b√≥lu nadbrzusza',
    'b√≥lu w nadbrzuszu',
    'b√≥lu ≈ºo≈ÇƒÖdka',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zgaga',
    'cofanie tre≈õci ≈ºo≈ÇƒÖdkowej',
    'wzdƒôcia',
    'uczucie pe≈Çno≈õci po posi≈Çkach',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu ≈õr√≥dbrzusza',
    'b√≥lu w ≈õr√≥dbrzuszu',
    'b√≥lu w ≈õrodkowej czƒô≈õci brzucha',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zgaga',
    'cofanie tre≈õci ≈ºo≈ÇƒÖdkowej',
    'wzdƒôcia',
    'uczucie pe≈Çno≈õci po posi≈Çkach',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu podbrzusza',
    'b√≥lu w podbrzuszu',
    'b√≥lu w prawym podbrzuszu',
    'b√≥lu w lewym podbrzuszu',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zgaga',
    'cofanie tre≈õci ≈ºo≈ÇƒÖdkowej',
    'wzdƒôcia',
    'uczucie pe≈Çno≈õci po posi≈Çkach',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu brzucha',
    'b√≥lu jamy brzusznej',
    'b√≥lu brzucha po stronie',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zgaga',
    'cofanie tre≈õci ≈ºo≈ÇƒÖdkowej',
    'wzdƒôcia',
    'uczucie pe≈Çno≈õci po posi≈Çkach',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ'
  ],
  sub: 'other'
},
{
  keys: [
    'przepukliny',
    'uwypuklenia w pachwinie',
    'przepukliny pachwinowej',
    'przepukliny udowej',
    'przepukliny pƒôpkowej',
    'przepukliny pooperacyjnej'
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zgaga',
    'cofanie tre≈õci ≈ºo≈ÇƒÖdkowej',
    'wzdƒôcia',
    'uczucie pe≈Çno≈õci po posi≈Çkach',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ',
    'zatrzymanie stolca i gaz√≥w'
  ],
  sub: 'other'
},
{
  keys: [
    'podejrzenia niedro≈ºno≈õci przewodu pokarmowego',
    'niedro≈ºno≈õci przewodu pokarmowego',
    'niedro≈ºno≈õci jelit',
    'zatrzymania stolca i gaz√≥w',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'nudno≈õci',
    'wymioty',
    'wzdƒôcia',
    'b√≥l brzucha',
    'zatrzymanie stolca i gaz√≥w'
  ],
  sub: 'other'
},
{
  keys: [
    'krwawienia z przewodu pokarmowego',
    'krwawienia z pp',
    'smolistych stolc√≥w',
    'krwi w stolcu',
    '≈õwie≈ºej krwi w stolcu',
    'fusowatych wymiot√≥w',
    'wymiot√≥w fusowatych',
    'wymiot√≥w krwiƒÖ',
    'krwistych wymiot√≥w',
  ],
  labels: [
    'os≈Çabienie',
    'zawroty g≈Çowy',
    'ko≈Çatanie serca',
    'b√≥l brzucha',
    'nudno≈õci',
    'wymioty',
    'zas≈Çabniƒôcia',
    'utrata przytomno≈õci',
    'utrata masy cia≈Ça',
    'zmiana rytmu wypr√≥≈ºnie≈Ñ',
    'smoliste stolce',
    'wymioty fusowate',
    'wymioty krwiƒÖ'
  ],
  sub: 'other'
},
{
  keys: [
    'kolki nerkowej',
    'b√≥lu kolkowego',
    'b√≥lu w okolicy lƒôd≈∫wiowej',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu w prawym podbrzuszu',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ',
    'zatrzymanie stolca i gaz√≥w'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu brzucha w ciƒÖ≈ºy',
    'ciƒÖ≈ºy',
    'plamienia',
    'krwawienia w ciƒÖ≈ºy',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zgaga',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'zatrzymanie stolca i gaz√≥w'
  ],
  sub: 'other'
},
{
  keys: [
    'niedro≈ºno≈õci cewnika',
    'zatkania cewnika',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'uczucie parcia na pƒôcherz',
    'b√≥l w podbrzuszu',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'zatrzymania moczu',
    'braku oddawania moczu',
    'bezmoczu',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'b√≥l podbrzusza',
    'uczucie parcia na mocz'
  ],
  sub: 'other'
},
{
  keys: [
    'krwawienia z nefrostomii',
    'zatkania nefrostomii',
    'przeciekania z nefrostomii',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'krwiomoczu',
    'krwi w moczu',
    'skrzep√≥w w moczu',
    'krwistego moczu'
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'dolegliwo≈õci dysuryczne',
    'b√≥l',
    'pieczenie przy mikcji',
    'b√≥l podbrzusza',
    'czƒôstomocz',
    'parcie naglƒÖce',
    'objawy infekcji'

  ],
  sub: 'other'
},
{
  keys: [
    'przewlek≈Çych zaparƒá',
    'zaparƒá',
    'braku stolca',
    'trudno≈õci w wypr√≥≈ºnieniu',
    'uczucia niepe≈Çnego wypr√≥≈ºnienia',
  ],
  labels: [
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'wymioty fusowate',
    'smoliste stolce',
    'wymioty krwiƒÖ',
    'zatrzymanie gaz√≥w',
    'utrata masy cia≈Ça',
    'b√≥l brzucha'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu w okolicy odbytu',
    'b√≥lu odbytu',
    'hemoroid√≥w',
    'szczeliny odbytu',
    'guzka o okolicy odbytu',
  ],
  labels: [
    'uczucie pieczenia',
    '≈õwiƒÖd',
    'krew w stolcu',
    'krew na papierze toaletowym',
    'zaparcia',
    'twarde stolce',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'og√≥lne os≈Çabienie',
    'b√≥l brzucha'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu jƒÖdra',
    'b√≥lu moszny',
  ],
  labels: [
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'krwiomocz',
    'b√≥l podbrzusza'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu jƒÖdra',
    'st≈Çuczenia jƒÖdra',
    'urazu moszny',
    'st≈Çuczenia moszny',
    'kopniƒôcia w krocze',
    'uderzenia w krocze'
  ],
  labels: [
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zaczerwienienie',
    'krwiak',
    'obrzƒôk'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu ≈ºeber',
    'st≈Çuczenia ≈ºeber',
    'b√≥lu ≈ºeber po urazie',
  ],
  labels: [
    'duszno≈õƒá',
    'krwioplucie',
    'og√≥lne os≈Çabienie',
    'kaszel',
    'wymioty',
    'b√≥l brzucha',
    'krwiomocz'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu ko≈Ñczyny dolnej',
    'b√≥lu nogi',
    'b√≥lu podudzia',
    'b√≥lu ≈Çydki',
    'b√≥lu stawu skokowego',
  ],
labels: [
  'objawy infekcji',
  'gorƒÖczka',
  'dreszcze',
  'obrzƒôk',
  'zaczerwienienie',
  'b√≥l',
  'zasinienie'
],
  sub: 'other'
},
{
  keys: [
    'oparzenia chemicznego',
    'kontaktu z substancjƒÖ chemicznƒÖ',
    'oparzenia substancjƒÖ chemicznƒÖ',
    'poparzenia chemicznego'
  ],
  labels: [
    'b√≥l',
    'pieczenie',
    'zaczerwienienie sk√≥ry',
    'obrzƒôk',
    'pƒôcherze',
    'zasinienie sk√≥ry',
    'nad≈ºerki',
    'krwawienie',
    '≈Çzawienie',
    'zaburzenia widzenia',
    '≈õwiat≈Çowstrƒôt',
    'b√≥l oka',
    'uczucie cia≈Ça obcego w gardle',
    'b√≥l przy prze≈Çykaniu',
    'zaburzenia g≈Çosu',
    'kaszel',
    'nudno≈õci',
    'wymioty',
    'utrata przytomno≈õci',
    'omdlenia'
  ],
  sub: 'other'
},
{
  keys: [
    'oparzenia termicznego',
    'oparzenia ogniem',
    'oparzenia p≈Çomieniem',
    'oparzenia gorƒÖcƒÖ wodƒÖ',
    'oparzenia wrzƒÖtkiem',
    'oparzenia parƒÖ',
    'oparzenia gorƒÖcym przedmiotem',
    'poparzenia'
  ],
  labels: [
    'b√≥l',
    'pieczenie',
    'zaczerwienienie sk√≥ry',
    'obrzƒôk',
    'pƒôcherze',
    'nad≈ºerki',
    'zwƒôglenie tkanek',
    'krwawienie',
    'utrata czucia w miejscu oparzenia',
    'os≈Çabienie',
    'nudno≈õci',
    'wymioty',
    'dreszcze',
    'zawroty g≈Çowy',
    'utrata przytomno≈õci',
    'omdlenia'
  ],
  sub: 'other'
},
{
  keys: [
    'pora≈ºenia prƒÖdem elektrycznym',
    'pora≈ºenia prƒÖdem',
  ],
  labels: [
    'utrata przytomno≈õci',
    'omdlenia',
    'zawroty g≈Çowy',
    'os≈Çabienie',
    'nudno≈õci',
    'wymioty',
    'dreszcze',
    'b√≥l',
    'oparzenia',
    'zaburzenia ≈õwiadomo≈õci',
    'ko≈Çatanie serca',
    'duszno≈õƒá'
  ],
  sub: 'other'
},
{
  keys: [
    'cia≈Ça obcego w ranie',
    'szk≈Ça w ranie',
    'od≈Çamku w ranie',
    'metalu w ranie',
    'drzazgi w ranie',
    'drzazgi',
  ],
  labels: [
    'b√≥l',
    'krwawienie',
    'obrzƒôk',
    'zaczerwienienie',
    'drƒôtwienie',
    'og√≥lne os≈Çabienie',
    'gorƒÖczka',
    'dreszcze',
    'objawy infekcji',
    'nudno≈õci',
    'wymioty'
  ],
  sub: 'other'
},
{
  keys: [
    'krwawienia z rany po zabiegu',
    'krwawienia z rany pooperacyjnej',
  ],
  labels: [
    'og√≥lne os≈Çabienie',
    'zawroty g≈Çowy',
    'zas≈Çabniƒôcia',
    'gorƒÖczka',
    'dreszcze',
    'objawy infekcji',
    'b√≥l',
    'obrzƒôk',
    'krwawienie',
    'krwiak',
    'zaczerwienienie'
  ],
  sub: 'other'
},
{
  keys: [
    'powik≈Ça≈Ñ po zabiegu',
    'powik≈Çania po zabiegu',
    'powik≈Çania pooperacyjnego',
    'problem√≥w z ranƒÖ pooperacyjnƒÖ',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'og√≥lne os≈Çabienie',
    'zawroty g≈Çowy',
    'b√≥l',
    'zaczerwienienie',
    'obrzƒôk'
  ],
  sub: 'other'
},
{
  keys: [
    'ran po samookaleczeniu',
    'rany po samookaleczeniu',
    'samookaleczenia',
  ],
  labels: [
    'krwawienie',
    'b√≥l',
    'obrzƒôk',
    'objawy infekcji miejscowej',
    'zaczerwienienie'
  ],
  sub: 'other'
},
{
  keys: [
    'nadepniƒôcia na gw√≥≈∫d≈∫',
    'rany k≈Çutej stopy',
  ],
  labels: [
    'b√≥l',
    'obrzƒôk',
    'zaczerwienienie',
    'krwawienie',
    'ropny wyciek',
    'dreszcze',
    'gorƒÖczka',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'rany kƒÖsanej',
    'ugryzienia przez psa',
    'pogryzienia',
    'rany po ugryzieniu'
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'b√≥l',
    'krwawienie',
    'wyciek tre≈õci ropnej',
    'og√≥lne os≈Çabienie',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'zmiany sk√≥rnej o charakterze ropnia',
    'ropnia',
    'czyraka',
    'zmiany ropnej'
  ],
  labels: [
    'zaczerwienienie',
    'wzrost ucieplenia sk√≥ry',
    'wyciek tre≈õci ropnej',
    'gorƒÖczka',
    'dreszcze',
    'b√≥l',
    'og√≥lne os≈Çabienie',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'uczucia ko≈Çatania serca',
    'nier√≥wnego bicia serca',
    'migotania przedsionk√≥w',
  ],
  labels: [
    'duszno≈õƒá',
    'b√≥l w klatce piersiowej',
    'zawroty g≈Çowy',
    'os≈Çabienie',
    'omdlenia',
    'nadmierna potliwo≈õƒá',
    'nudno≈õci',
    'wymioty',
    'blado≈õƒá',
    'sinica',
    'objawy neurologiczne',
    'b√≥l ko≈Ñczyn',
    'obrzƒôk'
  ],
  sub: 'other'
},
{
  keys: [
    'tachykardii',
    'bradykardii',
    'szybkiego bicia serca',
    'wolnego bicia serca'
  ],
  labels: [
    'duszno≈õƒá',
    'b√≥l w klatce piersiowej',
    'zawroty g≈Çowy',
    'os≈Çabienie',
    'omdlenia',
    'nadmierna potliwo≈õƒá',
    'nudno≈õci',
    'wymioty',
    'blado≈õƒá',
    'sinica',
    'biegunka'
  ],
  sub: 'other'
},
{
  keys: [
    'skok√≥w ci≈õnienia tƒôtniczego',
    'wysokiego ci≈õnienia tƒôtniczego',
    'wahania ci≈õnienia',
  ],
  labels: [
   
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu g≈Çowy',
    'migreny',
  ],
  labels: [
    'uczucie wolnej pracy serca',
    'uczucie szybkiej pracy serca',
    'wahania ci≈õnienia tƒôtniczego',
    'zimne poty',
    'pogorszenie tolerancji wysi≈Çku',
    'nag≈Çe os≈Çabienie',
    'og√≥lne os≈Çabienie',
    'duszno≈õƒá spoczynkowa',
    'duszno≈õƒá wysi≈Çkowa',
    'zawroty g≈Çowy',
    'omdlenia',
    'szumy uszne',
    'parestezje',
    'niedow≈Çad ko≈Ñczyn',
    'zaburzenia mowy',
    'nadmierna potliwo≈õƒá',
    'dreszcze',
    'uczucie gorƒÖca',
    'uczucie zimna',
    'dr≈ºenie rƒÖk',
    'niepok√≥j',
    'lƒôk',
    'gorƒÖczka',
    'objawy infekcji',
    'obrzƒôk',
    'zaburzenia widzenia',
    'zaburzenia r√≥wnowagi',
    'b√≥l w klatce piersiowej'
  ],
  sub: 'other'
},
{
  keys: [
    'zawrot√≥w g≈Çowy',
  ],
  labels: [
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'zaburzenia r√≥wnowagi',
    'szumy uszne',
    'podw√≥jne widzenie',
    'zaburzenia widzenia',
    'b√≥l g≈Çowy',
    'mrowienie',
    'drƒôtwienie ko≈Ñczyn',
    'ko≈Çatanie serca',
    'omdlenia',
    'utrata przytomno≈õci'
  ],
  sub: 'other'
},

{
  keys: [
    'b√≥lu w klatce piersiowej',
    'b√≥lu w KLP',
    'ucisku w klatce piersiowej',
  ],
  labels: [
    'duszno≈õƒá spoczynkowa',
    'duszno≈õƒá wysi≈Çkowa',
    'zimne poty',
    'nadmierna potliwo≈õƒá',
    'wahania ci≈õnienia tƒôtniczego',
    'uczucie szybkiej pracy serca',
    'uczucie wolnej pracy serca',
    'ko≈Çatanie serca',
    'zawroty g≈Çowy',
    'omdlenia',
    'utrata przytomno≈õci',
    'nag≈Çe os≈Çabienie',
    'og√≥lne os≈Çabienie',
    'nudno≈õci',
    'wymioty',
    'gorƒÖczka',
    'obrzƒôk',
    'dreszcze',
    'objawy infekcji',
    'b√≥l g≈Çowy',
    'mrowienie',
    'drƒôtwienie ko≈Ñczyn',
    'zaburzenia widzenia',
    'podw√≥jne widzenie',
    'zaburzenia r√≥wnowagi',
    'szumy uszne',
    'biegunka',
    'dolegliwo≈õci dysuryczne'
  ],
  sub: 'other'
},
{
  keys: [
    'cia≈Ça obcego w nosie',
  ],
  labels: [
    'uczucie cia≈Ça obcego',
    'niedro≈ºno≈õƒá nosa',
    'wyciek z nosa',
    'krwawienie z nosa',
    'b√≥l',
    'pieczenie',
    'kaszel',
    'odruch wymiotny',
    'duszno≈õƒá',
    '≈õwiszczƒÖcy oddech'
  ],
  sub: 'other'
},
{
  keys: [
    'b√≥lu w klatce piersiowej przy ruchach',
    'b√≥lu w klatce piersiowej przy g≈Çƒôbokim wdechu',
  ],
  labels: [
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'obrzƒôk',
    'zaburzenia r√≥wnowagi',
    'szumy uszne',
    'podw√≥jne widzenie',
    'zaburzenia widzenia',
    'b√≥l g≈Çowy',
    'mrowienie',
    'drƒôtwienie ko≈Ñczyn',
    'ko≈Çatanie serca',
    'omdlenia',
    'utrata przytomno≈õci'
  ],
  sub: 'other'
},
{
  keys: [
    'duszno≈õci',
    'duszno≈õci wysi≈Çkowej',
    'duszno≈õci spoczynkowej',
    'narastajƒÖcej duszno≈õci',
  ],
  labels: [
    'duszno≈õƒá spoczynkowa',
    'narastanie duszno≈õci',
    'ucisk/b√≥l w klatce piersiowej',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'omdlenie / utrata przytomno≈õci',
    'kaszel',
    'krwioplucie',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'obrzƒôki ko≈Ñczyn'
  ],
  sub: 'other'
},
{
  keys: [
    'wymiot√≥w',
    'nudno≈õci',
  ],
  labels: [
    'nudno≈õci',
    'biegunka',
    'gorƒÖczka',
    'b√≥l brzucha',
    'dreszcze',
    'zawroty g≈Çowy',
    'og√≥lne os≈Çabienie',
    'b√≥l g≈Çowy',
    'omdlenie / utrata przytomno≈õci',
    'drƒôtwienie ko≈Ñczyn',
    'objawy dysuryczne',
    'objawy infekcji',
    'obrzƒôki ko≈Ñczyn',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'zaburzenia r√≥wnowagi',
  ],
  sub: 'other'
},
{
  keys: [
    'biegunki',
    'lu≈∫nych stolc√≥w',
    'wodnistych stolc√≥w',
  ],
  labels: [
    'b√≥l brzucha',
    'nudno≈õci',
    'wymioty',
    'gorƒÖczka',
    'dreszcze',
    'b√≥l g≈Çowy',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'obrzƒôki ko≈Ñczyn',
    'zaburzenia r√≥wnowagi',
    'omdlenie / utrata przytomno≈õci',
    'og√≥lne os≈Çabienie',
    'ko≈Çatanie serca / nier√≥wne bicie'
  ],
  sub: 'other'
},
{
  keys: [
    'krwioplucia',
    'odkrztuszania krwi',
  ],
  labels: [
    'duszno≈õƒá',
    'kaszel',
    'b√≥l w klatce piersiowej',
    'gorƒÖczka',
    'dreszcze',
    'poty',
    'objawy infekcji',
    'og√≥lne os≈Çabienie',
    'utrata masy cia≈Ça',
    'nudno≈õci',
    'wymioty',
    'b√≥l brzucha'
  ],
  sub: 'other'
},
{
  keys: [
    'krwawienia z nosa',
    'epistaxis'
  ],
  labels: [
    'b√≥l g≈Çowy',
    'zawroty g≈Çowy',
    'zaburzenia r√≥wnowagi',
    'szumy uszne',
    'podw√≥jne widzenie',
    'zaburzenia widzenia',
    'omdlenie / utrata przytomno≈õci',
    'duszno≈õƒá',
    'b√≥l w klatce piersiowej',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'obrzƒôki ko≈Ñczyn'
  ],
  sub: 'other'
},
{
  keys: [
    'omdlenia',
    'zas≈Çabniƒôcia',
    'utraty przytomno≈õci',
  ],
  labels: [
    'omdlenie / utrata przytomno≈õci',
    'zawroty g≈Çowy',
    'mroczki przed oczami',
    'uczucie gorƒÖca',
    'og√≥lne os≈Çabienie',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'b√≥l w klatce piersiowej',
    'duszno≈õƒá',
    'b√≥l g≈Çowy',
    'os≈Çabienie si≈Çy miƒô≈õniowej',
    'drƒôtwienie ko≈Ñczyn',
    'mrowienie / drƒôtwienie ko≈Ñczyn',
    'zaburzenia r√≥wnowagi',
    'szumy uszne',
    'podw√≥jne widzenie',
    'zaburzenia widzenia',
    'dolegliwo≈õci dysuryczne',
    'objawy infekcji',
    'gorƒÖczka',
    'dreszcze',
    'obrzƒôki ko≈Ñczyn'
  ],
  sub: 'other'
},
{
  keys: [
    'infekcji',
    'objaw√≥w infekcji',
    'gorƒÖczki',
    'dreszczy',
    'kaszlu',
    'b√≥lu gard≈Ça',
  ],
  labels: [
    'gorƒÖczka',
    'dreszcze',
    'og√≥lne os≈Çabienie',
    'b√≥le miƒô≈õniowo-stawowe',
    'b√≥l g≈Çowy',
    'kaszel',
    'duszno≈õƒá',
    'b√≥l gard≈Ça',
    'katar / zatkanie nosa',
    'b√≥l w klatce piersiowej',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'b√≥l brzucha',
    'brak apetytu',
    'dolegliwo≈õci dysuryczne',
    'zaburzenia ≈õwiadomo≈õci',
    'senno≈õƒá / splƒÖtanie',
    'zawroty g≈Çowy',
    'drgawki'
  ],
  sub: 'other'
},
{
  keys: [
    'og√≥lnego os≈Çabienia',
    'os≈Çabienia',
  ],
  labels: [
    'zawroty g≈Çowy',
    'omdlenie / utrata przytomno≈õci',
    'duszno≈õƒá',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'b√≥l w klatce piersiowej',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'gorƒÖczka',
    'dreszcze',
    'objawy infekcji',
    'b√≥l g≈Çowy',
    'zaburzenia widzenia',
    'drƒôtwienie / mrowienie ko≈Ñczyn',
    'spadek masy cia≈Ça',
    'brak apetytu'
  ],
  sub: 'other'
},
{
  keys: [
    'drƒôtwienia',
    'mrowienia',
    'parestezji',
    'drƒôtwienia ko≈Ñczyn',
    'mrowienia ko≈Ñczyn',
  ],
  labels: [
    'drƒôtwienie / mrowienie ko≈Ñczyn',
    'os≈Çabienie si≈Çy miƒô≈õniowej',
    'zaburzenia chwytu',
    'asymetria twarzy',
    'zaburzenia mowy',
    'zaburzenia widzenia',
    'zawroty g≈Çowy',
    'b√≥l g≈Çowy',
    'zaburzenia chodu',
    'b√≥l krƒôgos≈Çupa',
    'promieniowanie b√≥lu',
    'omdlenie / utrata przytomno≈õci',
    'duszno≈õƒá',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'b√≥l w klatce piersiowej',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'b√≥l brzucha',
    'dolegliwo≈õci dysuryczne',
    'gorƒÖczka',
    'dreszcze',
    'objawy infekcji',
    'spadek masy cia≈Ça',
    'brak apetytu'
  ],
  sub: 'other'
},
{
  keys: [
    'zaburze≈Ñ ≈õwiadomo≈õci',
  ],
  labels: [
    'senno≈õƒá / splƒÖtanie',
    'omdlenie / utrata przytomno≈õci',
    'zawroty g≈Çowy',
    'og√≥lne os≈Çabienie',
    'b√≥l g≈Çowy',
    'nudno≈õci',
    'wymioty',
    'biegunka',
    'gorƒÖczka',
    'dreszcze',
    'objawy infekcji',
    'duszno≈õƒá',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'b√≥l w klatce piersiowej',
    'zaburzenia widzenia',
    'zaburzenia s≈Çuchu',
    'drgawki',
    'uraz g≈Çowy',
    'niedow≈Çad / os≈Çabienie si≈Çy',
    'asymetria twarzy',
    'zaburzenia mowy',
    'drƒôtwienie / mrowienie ko≈Ñczyn',
    'dolegliwo≈õci dysuryczne',
    'b√≥l brzucha',
    'spadek masy cia≈Ça',
    'brak apetytu'
  ],
  sub: 'neuro'
},
{
  keys: [
    'drgawek',
    'napadu padaczkowego',
    'padaczki',
    'utraty przytomno≈õci z drgawkami',
  ],
  labels: [
    'drgawki',
    'zaburzenia ≈õwiadomo≈õci',
    'omdlenie / utrata przytomno≈õci',
    'uraz g≈Çowy',
    'przygryzienie jƒôzyka',
    'nietrzymanie moczu / stolca',
    'senno≈õƒá / splƒÖtanie',
    'b√≥l g≈Çowy',
    'zawroty g≈Çowy',
    'nudno≈õci',
    'wymioty',
    'gorƒÖczka',
    'dreszcze',
    'objawy infekcji',
    'drƒôtwienie / mrowienie ko≈Ñczyn',
    'niedow≈Çad / os≈Çabienie si≈Çy',
    'zaburzenia mowy',
    'zaburzenia widzenia',
    'zaburzenia s≈Çuchu',
    'b√≥l w klatce piersiowej',
    'ko≈Çatanie serca / nier√≥wne bicie',
    'duszno≈õƒá',
    'biegunka',
    'b√≥l brzucha',
    'dolegliwo≈õci dysuryczne'
  ],
  sub: 'neuro'
},
{
  keys: [
    'zatrucia alkoholem',
    'upojenia alkoholowego'
  ],
  labels: [
    'zaburzenia ≈õwiadomo≈õci',
    'chwiejny ch√≥d',
    'be≈Çkotliwa mowa',
    'nudno≈õci',
    'wymioty',
    'os≈Çabienie',
    'senno≈õƒá',
    'b√≥l g≈Çowy',
    'zawroty g≈Çowy',
    'drƒôtwienie ko≈Ñczyn',
    'mrowienie',
    'zaburzenia widzenia',
    'zaburzenia s≈Çuchu',
    'ko≈Çatanie serca'
  ],
  sub: 'other'
},
{
  keys: [
    'zatrucia lekami',
    'zatrucia narkotykami',
    'zatrucia substancjami psychoaktywnymi'
  ],
  labels: [
    'zaburzenia ≈õwiadomo≈õci',
    'senno≈õƒá',
    'pobudzenie',
    'splƒÖtanie',
    'brak kontaktu',
    'zawroty g≈Çowy',
    'nudno≈õci',
    'wymioty',
    'os≈Çabienie',
    'zaburzenia mowy',
    'zaburzenia koordynacji',
    'drgawki',
    'omamy',
    'niepok√≥j',
    'duszno≈õƒá',
    'b√≥l g≈Çowy',
    'b√≥l brzucha'
  ],
  sub: 'other'
},
{
  keys: [
    'narastajƒÖcego os≈Çabienia',
    'podejrzenia anemii',
    'niedokrwisto≈õci',
    'anemii'
  ],
  labels: [
    'zawroty g≈Çowy',
    'og√≥lne os≈Çabienie',
    'duszno≈õƒá wysi≈Çkowa',
    'ko≈Çatanie serca',
    'senno≈õƒá',
    'pogorszenie tolerancji wysi≈Çku',
    'gorƒÖczka',
    'objawy infekcji',
    'b√≥l g≈Çowy',
    'utrata przytomno≈õci',
    'obfite miesiƒÖczki',
    'krwawienie z przewodu pokarmowego',
    'smoliste stolce',
    '≈õwie≈ºa krew w stolcu',
    'krwiomocz'
  ],
  sub: 'other'
},
{
  keys: [
    'epizodu zad≈Çawienia',
    'zad≈Çawienia',
    'zakrztuszenia',
    'zach≈Çy≈õniƒôcia'
  ],
  labels: [
    'dyskomfort w gardle',
    'chrypka',
    'kaszel',
    'duszno≈õƒá',
    'sinica',
    'utrata przytomno≈õci',
    'b√≥l w klatce piersiowej',
    'nudno≈õci',
    'wymioty'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu oka'
  ],
  labels: [
    'b√≥l oka',
    'nudno≈õci',
    'wymioty',
    'utrata przytomno≈õci',
    'uraz g≈Çowy'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu brzucha'
  ],
  labels: [
    'nudno≈õci',
    'wymioty',
    'biegunki',
    'zaparƒá',
    'krwi w stolcu',
    'smoliste stolce',
    'utrata przytomno≈õci',
    'zawroty g≈Çowy',
    'zaburzenia ≈õwiadomo≈õci'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu-og√≥lny'
  ],
  labels: [
    'nudno≈õci',
    'wymioty',
    'drgawki',
    'zaburzenia neurologiczne',
    'zaburzenia widzenia',
    'b√≥l w klatce piersiowej',
    'duszno≈õƒá',
    'b√≥l brzucha',
    'krwiomocz',
    'krwioplucie'
  ],
  sub: 'other'
},
{
  keys: [
    'rany-og√≥lny'
  ],
  labels: [
    'gorƒÖczka',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu prƒÖcia',
    'urazu penisa'
  ],
  labels: [
    'gorƒÖczka',
    'objawy infekcji',
    'zatrzymanie moczu',
    'krwiomocz'
  ],
  sub: 'other'
},
{
  keys: [
    'cia≈Ça obcego w uchu'
  ],
  labels: [
    'pogorszenie s≈Çuchu',
    'zaburzenia r√≥wnowagi',
    'zawroty g≈Çowy',
    'gorƒÖczka',
    'objawy infekcji'
  ],
  sub: 'other'
},
{
  keys: [
    'urazu nosa'
  ],
  labels: [
    'utrata przytomno≈õci',
    'zawroty g≈Çowy',
    'nudno≈õci',
    'wymioty',
    'zaburzenia widzenia',
    'b√≥l ga≈Çek ocznych'
  ],
  sub: 'other'
},
{
  keys: [
    'objaw√≥w reakcji alergicznej',
    'reakcja alergicznej'
  ],
  labels: [
    'duszno≈õƒá',
    'ucisk w klatce piersiowej',
    'chrypka',
    'trudno≈õci w prze≈Çykaniu',
    'zawroty g≈Çowy',
    'os≈Çabienie',
    'nag≈Çe pogorszenie stanu zdrowia',
    'nudno≈õci',
    'wymioty',
    'b√≥l brzucha',
    'biegunka'
  ],
  sub: 'other'
},
{
  keys: [
    'zaburze≈Ñ neurologicznych',
    'podejrzenia udaru'
  ],
  labels: [
    'zawroty g≈Çowy',
    'utrata przytomno≈õci',
    'zaburzenia czucia',
    'zaburzenia widzenia',
    'zaburzenia koordynacji',
    'b√≥le g≈Çowy',
    'gorƒÖczka',
    'objawy infekcji',
    'nudno≈õci',
    'wymioty'
  ],
  sub: 'other'
},
{
  keys: [
    'zatrucia dymem',
    'inhalacji dymu'
  ],
  labels: [
    'kaszel',
    'duszno≈õƒá',
    'b√≥l w klatce piersiowej',
    'chrypka',
    'b√≥l g≈Çowy',
    'zawroty g≈Çowy',
    'nudno≈õci',
    'wymioty',
    'zaburzenia ≈õwiadomo≈õci',
    'utrata przytomno≈õci',
    'sinica'
  ],
  sub: 'other'
},
{
  keys: [
    'na≈õwietlenia oczu',
    'oparzenia oczu promieniami uv'
  ],
  labels: [
    'b√≥l oka',
    '≈õwiat≈Çowstrƒôt',
    '≈Çzawienie',
    'zaczerwienienie oka',
    'pogorszenie ostro≈õci widzenia',
    'b√≥l g≈Çowy',
    'nudno≈õci'
  ],
  sub: 'other'
},
{
  keys: [
    'napadu dny moczanowej',
    'b√≥lu palucha'
  ],
  labels: [
    'silny b√≥l stawu',
    'obrzƒôk',
    'zaczerwienienie',
    'wzrost ucieplenia sk√≥ry',
    'ograniczenie ruchomo≈õci',
    'gorƒÖczka',
    'dreszcze'
  ],
  sub: 'other'
},









// ===== KONIEC BLOKU (TU PRZYJDƒÑ NASTƒòPNE) =====
// ===== TU WKLEJAJ KOLEJNE POWODY -> PROPONOWANE OBJAWY =====
];

function buildChiefHints(){
  const dl = document.getElementById('chiefHints');
  if(!dl) return;

  const set = new Set();
  CHIEF_TO_SYMPTOMS.forEach(rule => {
    (rule.keys || []).forEach(k => {
      const v = String(k || '').trim();
      if(v.length >= 2) set.add(v);
    });
  });

  dl.innerHTML = '';
  Array.from(set).sort((a,b)=>a.localeCompare(b,'pl')).forEach(v => {
    const opt = document.createElement('option');
    opt.value = v;
    dl.appendChild(opt);
  });
}

document.addEventListener('DOMContentLoaded', buildChiefHints);


function normalizeTxt(s){
  return (s||'').toLowerCase().trim();
}

function findSymptomRowByLabel(label){
  const rows = Array.from(document.querySelectorAll('.symp-row'));
  return rows.find(r => (r.getAttribute('data-label')||'').trim().toLowerCase() === label.trim().toLowerCase());
}

function expandSymptomsAccordion(){
  const btn = $('sympToggle');
  const panel = $('sympPanel');
  if(!btn || !panel) return;
  btn.setAttribute('aria-expanded', 'true');
  panel.hidden = false;
}

function expandSubAccordion(key){
  // key to np: 'cardio','neuro','surg','ortho','other'
  const btn = document.querySelector(`.sub-acc-btn[data-subacc="${key}"]`);
  const panel = document.querySelector(`.sub-acc-panel[data-subpanel="${key}"]`);
  if(btn && panel){
    btn.setAttribute('aria-expanded', 'true');
    panel.hidden = false;
  }
}

function markSymptomYes(label){
  const row = findSymptomRowByLabel(label);
  if(!row) return false;

  const yes = row.querySelector('input[type="radio"][value="yes"]');
  if(yes){
    yes.checked = true;
    yes.dispatchEvent(new Event('change', { bubbles:true }));

    // przewi≈Ñ do objawu
    row.scrollIntoView({ behavior:'smooth', block:'center' });

    // kr√≥tkie mocniejsze pod≈õwietlenie
    row.classList.add('picked');
    setTimeout(() => row.classList.remove('picked'), 700);

    // focus: najpierw notatka, potem select
    const noteEl = row.querySelector('[data-note]');
    const selEl  = row.querySelector('[data-select]');

    if(noteEl && !noteEl.disabled){
      setTimeout(() => noteEl.focus(), 250);
    } else if(selEl && !selEl.disabled){
      setTimeout(() => selEl.focus(), 250);
    }

    return true;
  }
  return false;
}


function highlightSuggestedRows(labels){
  const all = Array.from(document.querySelectorAll('.symp-row'));
  all.forEach(r => r.classList.remove('suggested'));

  if(!labels || !labels.length) return;

  const wanted = new Set(labels.map(x => (x||'').trim().toLowerCase()));
  all.forEach(r => {
    const lab = (r.getAttribute('data-label') || '').trim().toLowerCase();
    if(wanted.has(lab)) r.classList.add('suggested');
  });
}

function sortSuggestedRows(labels){
  const rows = Array.from(document.querySelectorAll('.symp-row'));

  // zapamiƒôtaj oryginalnƒÖ kolejno≈õƒá raz (globalnie dla wszystkich)
  rows.forEach((r, i) => {
    if (!r.dataset.origIndex) r.dataset.origIndex = String(i);
  });

  // grupujemy po "li≈õcie", czyli po rodzicu .symp-list (≈ºeby nie mieszaƒá miƒôdzy kategoriami)
  const byParent = new Map();
  rows.forEach(r => {
    const parent = r.closest('.symp-list');
    if(!parent) return;
    if(!byParent.has(parent)) byParent.set(parent, []);
    byParent.get(parent).push(r);
  });

  // je≈õli brak sugestii -> wr√≥ƒá do oryginalnej kolejno≈õci
  if(!labels || !labels.length){
    byParent.forEach((list, parent) => {
      list
        .sort((a,b) => Number(a.dataset.origIndex) - Number(b.dataset.origIndex))
        .forEach(r => parent.appendChild(r));
    });
    return;
  }

  const wanted = new Set(labels.map(x => (x||'').trim().toLowerCase()));

  byParent.forEach((list, parent) => {
    const suggested = [];
    const others = [];

    list.forEach(r => {
      const lab = (r.getAttribute('data-label') || '').trim().toLowerCase();
      (wanted.has(lab) ? suggested : others).push(r);
    });

    // sugerowane na g√≥rƒô w tej samej podkategorii
    suggested.concat(others).forEach(r => parent.appendChild(r));

  });
}
function applySuggestedSymptoms(labels, subKey){
  // tylko: pod≈õwietl + przenie≈õ na poczƒÖtek listy objaw√≥w
  highlightSuggestedRows(labels);
  sortSuggestedRows(labels);

  clearSuggestedMarks();
  renderQuickSuggested(labels);

  // opcjonalnie: pod≈õwietlenie wierszy zgodnie z indeksami (bez dublowania)
  (labels || []).forEach(l=>{
    const hit = SYM_INDEX.get(canonOrSyn(l));
    if(hit) hit.row.classList.add('suggested');
  });

  // NIE ROZWIJAJ automatycznie sekcji Objawy ani podkategorii
  // if(labels && labels.length){
  //   expandSymptomsAccordion();
  //   if(subKey) expandSubAccordion(subKey);
  // }
}

function suggestSymptomsFromChief(){
  const chief = normalizeTxt($('chief')?.value || '');
  if(!chief){
    applySuggestedSymptoms([], null);
    return;
  }

  for(const rule of CHIEF_TO_SYMPTOMS){
    if(rule.keys.some(k => chief.includes(k))){
      applySuggestedSymptoms(rule.labels, rule.sub);
      return;
    }
  }

  applySuggestedSymptoms([], null);
}

function applyChiefInterviewAutofill(){
  const chief = normalizeTxt($('chief')?.value || '');
  if(!chief) return;

  const box = $('interview_general');
  if(!box) return;

  // ===== TU WKLEJAJ -> AUTO-WYWIAD (templates) =====

  // OKO
  const isEyeForeignBody =
    chief.includes('cia≈Ça obcego w oku');

  if(isEyeForeignBody){
    const templateEye =
`dolegliwo≈õci od ‚Ä¶‚Ä¶..
Do zdarzenia dosz≈Ço podczas [np. szlifowania, wiercenia, pracy w zapyleniu, wiatru, pracy bez okular√≥w ochronnych].
Rodzaj cia≈Ça obcego: [metal / py≈Ç / piasek / drewno / nieznany].
Widoczne cechy podra≈ºnienia oka: tak / nie
Pr√≥by samodzielnego usuniƒôcia: tak / nie`;

    const current = (box.value || '').trim();
    // anty-duplikacja (oko)
    if(!current.includes('Widoczne cechy podra≈ºnienia oka:')){
      box.value = current ? (current + '\n\n' + templateEye) : templateEye;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

  // NOS
  const isNoseForeignBody =
  
    chief.includes('cia≈Ça obcego w nosie');

  if(isNoseForeignBody){
    const templateNose =
`do zdarzenia dosz≈Ço ‚Ä¶..
Mechanizm: [samodzielne w≈Ço≈ºenie / przypadkowe / podczas zabawy / uraz].
Rodzaj cia≈Ça obcego: [koralik, element zabawki, gƒÖbka, papier, jedzenie, bateria guzikowa, nieznany].
Dro≈ºno≈õƒá dr√≥g oddechowych: zachowana / niezachowana
Pr√≥by samodzielnego usuniƒôcia: tak / nie`;

    const current = (box.value || '').trim();
    // anty-duplikacja (nos)
    if(!current.includes('Mechanizm:') && !current.includes('Dro≈ºno≈õƒá dr√≥g oddechowych:')){
      box.value = current ? (current + '\n\n' + templateNose) : templateNose;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

  // PRZE≈ÅYK
  const isEsophagusForeignBody =
    chief.includes('cia≈Ça obcego w prze≈Çyku');

  if(isEsophagusForeignBody){
    const templateEso =
`do zdarzenia dosz≈Ço ‚Ä¶‚Ä¶., kiedy to podczas spo≈ºywania posi≈Çku (miƒôsa) nagle poczu≈Ç/a, ≈ºe jego fragment utknƒÖ≈Ç w gardle.
Od tego momentu zg≈Çasza uporczywe uczucie przeszkody w gardle, trudno≈õci w prze≈Çykaniu ≈õliny, pokarm√≥w i p≈Çyn√≥w.
Nie przyjmuje doustnie ≈ºadnych pokarm√≥w ani p≈Çyn√≥w z obawy przed nasileniem dolegliwo≈õci oraz z powodu uczucia zatrzymania tre≈õci.
Objawy utrzymujƒÖ siƒô nieprzerwanie, nie nasilajƒÖ siƒô przy oddychaniu.
Pierwszorazowy epizod. Wcze≈õniej podobne dolegliwo≈õci nie wystƒôpowa≈Çy.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (prze≈Çyk)
    if(!current.includes('uczucie przeszkody w gardle') && !current.includes('trudno≈õci w prze≈Çykaniu')){
      box.value = current ? (current + '\n\n' + templateEso) : templateEso;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

  // ODBYT / ODBYTNICA
  const isRectalForeignBody =
    chief.includes('cia≈Ça obcego w odbycie');

  if(isRectalForeignBody){
    const templateRectal =
`cia≈Ço obce zosta≈Ço wprowadzone ‚Ä¶., w okoliczno≈õciach [przypadkowe / seksualne / inne ‚Äì pacjent nie precyzuje].
Pacjent/ka podejmowa≈Ç/a / nie podejmowa≈Ç/a pr√≥by samodzielnego usuniƒôcia cia≈Ça obcego.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (odbyt)
    if(!current.includes('Okoliczno≈õci zdarzenia:') && !current.includes('pr√≥by samodzielnego usuniƒôcia')){
      box.value = current ? (current + '\n\n' + templateRectal) : templateRectal;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // DROGI RODNE / POCHWA
  const isGenitalTractForeignBody =
    chief.includes('cia≈Ça obcego w drogach rodnych') ||
    chief.includes('cia≈Ça obcego w pochwie');

  if(isGenitalTractForeignBody){
    const templateGenital =
`cia≈Ço obce zosta≈Ço wprowadzone ‚Ä¶., w okoliczno≈õciach [przypadkowych / higienicznych ‚Äì np. tampon, kubeczek menstruacyjny / seksualnych / niejasnych].
Od tego czasu pacjentka zg≈Çasza uczucie cia≈Ça obcego, dyskomfort lub b√≥l w podbrzuszu/okolicy krocza, nieprawid≈ÇowƒÖ wydzielinƒô z pochwy, krwawienie lub plamienie oraz ≈õwiƒÖd, pieczenie.
Pacjentka podejmowa≈Ça / nie podejmowa≈Ça pr√≥b samodzielnego usuniƒôcia cia≈Ça obcego.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (drogi rodne)
    if(!current.includes('nieprawid≈ÇowƒÖ wydzielinƒô z pochwy') && !current.includes('pr√≥b samodzielnego usuniƒôcia')){
      box.value = current ? (current + '\n\n' + templateGenital) : templateGenital;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

  // B√ìL NADBRZUSZA
  const isEpigastricPain =
    chief.includes('b√≥lu nadbrzusza') ||
    chief.includes('b√≥lu w nadbrzuszu') ||
    chief.includes('b√≥lu ≈ºo≈ÇƒÖdka');

  if(isEpigastricPain){
    const templateEpi =
`dolegliwo≈õci od oko≈Ço ‚Ä¶.., poczƒÖtek stopniowy po spo≈ºyciu obfitego, t≈Çustego posi≈Çku.
B√≥l promieniuje do okolicy lƒôd≈∫wiowej oraz nieco do plec√≥w.
Nasilenie po jedzeniu, szczeg√≥lnie po produktach t≈Çustych; czƒô≈õciowa poprawa w pozycji siedzƒÖcej i przy pochyleniu do przodu.
B≈ÇƒÖd dietetyczny neguje / W wywiadzie spo≈ºycie t≈Çustego, ciƒô≈ºkostrawnego obiadu.
Poprzedniego dnia spo≈ºycie alkoholu (piwo).`;

    const current = (box.value || '').trim();
    // anty-duplikacja (nadbrzusze)
    if(!current.includes('B√≥l promieniuje do okolicy lƒôd≈∫wiowej') && !current.includes('t≈Çustego posi≈Çku')){
      box.value = current ? (current + '\n\n' + templateEpi) : templateEpi;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
// B√ìL ≈öR√ìDBRZUSZA
  const isMesogastricPain =
    chief.includes('b√≥lu ≈õr√≥dbrzusza') ||
    chief.includes('b√≥lu w ≈õr√≥dbrzuszu');

  if(isMesogastricPain){
    const templateMeso =
`b√≥l utrzymuje siƒô od dw√≥ch dni.
B√≥l o charakterze ucisku, sta≈Çy, zlokalizowany w ≈õrodkowo-lewej czƒô≈õci jamy brzusznej, bez promieniowania.
Dolegliwo≈õci nasila palpacja tej okolicy.
B≈ÇƒÖd dietetyczny neguje, nie spo≈ºywa≈Ç/a podejrzanych posi≈Çk√≥w, brak zmian w nawykach ≈ºywieniowych.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (≈õr√≥dbrzusze)
    if(!current.includes('≈õrodkowo-lewej czƒô≈õci jamy brzusznej') && !current.includes('Dolegliwo≈õci nasila palpacja')){
      box.value = current ? (current + '\n\n' + templateMeso) : templateMeso;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL PODBRZUSZA
  const isLowerAbdPain =
    chief.includes('b√≥lu podbrzusza') ||
    chief.includes('b√≥lu w podbrzuszu') ||
    chief.includes('b√≥lu w prawym podbrzuszu') ||
    chief.includes('b√≥lu w lewym podbrzuszu');

  if(isLowerAbdPain){
    const templateLower =
`b√≥l utrzymuje siƒô od ______ dni / godzin.
B√≥l o charakterze ___ (ucisku / k≈Çucia / skurczowy / sta≈Çy / napadowy),
zlokalizowany w _____ (prawym podbrzuszu / lewym podbrzuszu / ≈õrodkowej czƒô≈õci podbrzusza).
B√≥l nie promieniuje / promieniuje do ______
Dolegliwo≈õci nasilajƒÖ siƒô przy ____ (palpacji, chodzeniu, kaszlu, oddawaniu moczu, zmianie pozycji).
B≈ÇƒÖd dietetyczny neguje ‚Äî nie spo≈ºywa≈Ç/a podejrzanych posi≈Çk√≥w, brak zmian ≈ºywieniowych.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (podbrzusze)
    if(!current.includes('zlokalizowany w _____') && !current.includes('Dolegliwo≈õci nasilajƒÖ siƒô przy ____')){
      box.value = current ? (current + '\n\n' + templateLower) : templateLower;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

 // B√ìL BRZUCHA (OG√ìLNY)
  const isAbdominalPain =
    chief.includes('b√≥lu brzucha') ||
    chief.includes('b√≥lu jamy brzusznej');

  if(isAbdominalPain){
    const templateAbd =
`b√≥l po stronie ‚Ä¶‚Ä¶., utrzymujƒÖcy siƒô od ‚Ä¶...
Dolegliwo≈õci majƒÖ charakter ciƒÖg≈Çy/napadowy o umiarkowanym nasileniu, bez promieniowania.
B√≥l niezwiƒÖzany z przyjmowaniem posi≈Çk√≥w.
Apetyt i samopoczucie og√≥lne ‚Äì [obni≈ºone / bez zmian].`;

    const current = (box.value || '').trim();
    // anty-duplikacja (b√≥l brzucha og√≥lny)
    if(!current.includes('B√≥l po stronie') && !current.includes('B√≥l niezwiƒÖzany z przyjmowaniem posi≈Çk√≥w')){
      box.value = current ? (current + '\n\n' + templateAbd) : templateAbd;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

  // PRZEPUKLINA
  const isHernia =
    chief.includes('przepukliny') ||
    chief.includes('przepukliny pachwinowej') ||
    chief.includes('przepukliny udowej') ||
    chief.includes('przepukliny pƒôpkowej') ||
    chief.includes('przepukliny pooperacyjnej');

  if(isHernia){
    const templateHernia =
`przepuklina zauwa≈ºona ‚Ä¶‚Ä¶, z obecnym uwypukleniem / powiƒôkszeniem siƒô zmiany, w okolicy pachwinowej / udowej / pƒôpkowej / pooperacyjnej.
Zg≈Çaszany b√≥l w okolicy przepukliny o nasileniu narastajƒÖcym / sta≈Çym / okresowym, nasilajƒÖcy siƒô przy kaszlu, parciu, wysi≈Çku.
Przepuklina rozpoznana ‚Ä¶‚Ä¶, przebyte zabiegi operacyjne ‚Ä¶‚Ä¶`;

    const current = (box.value || '').trim();
    // anty-duplikacja (przepuklina)
    if(!current.includes('Zg≈Çaszany b√≥l w okolicy przepukliny') && !current.includes('Przepuklina zauwa≈ºona')){
      box.value = current ? (current + '\n\n' + templateHernia) : templateHernia;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NIEDRO≈ªNO≈öƒÜ PRZEWODU POKARMOWEGO
  const isBowelObstruction =
    chief.includes('podejrzenia niedro≈ºno≈õci przewodu pokarmowego') ||
    chief.includes('niedro≈ºno≈õci przewodu pokarmowego') ||
    chief.includes('niedro≈ºno≈õci jelit') ||
    chief.includes('zatrzymania stolca i gaz√≥w');

  if(isBowelObstruction){
    const templateIleus =
`od‚Ä¶.. wystƒôpujƒÖ narastajƒÖce b√≥le brzucha o charakterze napadowym / sta≈Çym,
zlokalizowane: b√≥l rozlany / w okolicy ‚Ä¶‚Ä¶
Obecne nudno≈õci i wymioty tre≈õciƒÖ ≈ºo≈ÇƒÖdkowƒÖ / ≈º√≥≈ÇciowƒÖ / ka≈ÇowƒÖ.
Zg≈Çaszane zatrzymanie stolca i gaz√≥w od ‚Ä¶...
Brzuch wzdƒôty / bolesny przy palpacji.
W wywiadzie: przebyte zabiegi operacyjne jamy brzusznej, wcze≈õniejsze epizody niedro≈ºno≈õci, rozpoznane przepukliny / choroby zapalne jelit / nowotwory.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (niedro≈ºno≈õƒá)
    if(!current.includes('Zg≈Çaszane zatrzymanie stolca i gaz√≥w') && !current.includes('wymioty tre≈õciƒÖ ≈ºo≈ÇƒÖdkowƒÖ')){
      box.value = current ? (current + '\n\n' + templateIleus) : templateIleus;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // KRWAWIENIE Z PRZEWODU POKARMOWEGO
  const isGIBleeding =
    chief.includes('krwawienia z przewodu pokarmowego') ||
    chief.includes('krwawienie z pp') ||
    chief.includes('smolistych stolc√≥w') ||
    chief.includes('krwi w stolcu') ||
    chief.includes('≈õwie≈ºej krwi w stolcu') ||
    chief.includes('fusowatych wymiot√≥w') ||
    chief.includes('wymiot√≥w fusowatych') ||
    chief.includes('wymiot√≥w krwiƒÖ') ||
    chief.includes('krwistych wymiot√≥w');

  if(isGIBleeding){
    const templateGI =
`smoliste stolce / obecno≈õƒá ≈õwie≈ºej krwi w stolcu / krwiste lub fusowate wymioty, kt√≥re wystƒÖpi≈Ço ‚Ä¶...
Odnotowano jednorazowy / kilkukrotny epizod krwawienia.
W wywiadzie: choroba wrzodowa, marsko≈õƒá wƒÖtroby, ≈ºylaki prze≈Çyku lub wcze≈õniejsze epizody krwawienia z przewodu pokarmowego.
Zg≈Çaszane spo≈ºycie alkoholu w ostatnim czasie.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (krwawienie z PP)
    if(!current.includes('epizod krwawienia') && !current.includes('choroba wrzodowa')){
      box.value = current ? (current + '\n\n' + templateGI) : templateGI;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // KOLKA NERKOWA
  const isRenalColic =
    chief.includes('kolki nerkowej') ||
    chief.includes('b√≥lu kolkowego') ||
    chief.includes('b√≥lu w okolicy lƒôd≈∫wiowej');

  if(isRenalColic){
    const templateRenal =
`b√≥l o charakterze kolkowym pojawiajƒÖcego siƒô od ‚Ä¶...
Dolegliwo≈õci zlokalizowane w okolicy lƒôd≈∫wiowej ‚Ä¶‚Ä¶, z promieniowaniem do pachwiny po stronie ‚Ä¶..
B√≥l ma charakter napadowy, o zmiennym nasileniu, bez wyra≈∫nych czynnik√≥w prowokujƒÖcych.
Brak dolegliwo≈õci ze strony przewodu pokarmowego.
W przesz≈Ço≈õci podobne objawy [wystƒôpowa≈Çy / brak].`;

    const current = (box.value || '').trim();
    // anty-duplikacja (kolka nerkowa)
    if(!current.includes('promieniowaniem do pachwiny') && !current.includes('B√≥l ma charakter napadowy')){
      box.value = current ? (current + '\n\n' + templateRenal) : templateRenal;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL W PRAWYM PODBRZUSZU
  const isRLQPain =
    chief.includes('b√≥lu w prawym podbrzuszu');

  if(isRLQPain){
    const templateRLQ =
`dolegliwo≈õci utrzymujƒÖ siƒô od oko≈Ço ____.
B√≥l o charakterze sta≈Çym, nasilajƒÖcy siƒô przy ucisku i ruchu, nie promieniuje.
Neguje uraz brzucha oraz b≈ÇƒÖd dietetyczny.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (prawy podbrzusz)
    if(!current.includes('B√≥l o charakterze sta≈Çym') && !current.includes('nasilajƒÖcy siƒô przy ucisku i ruchu')){
      box.value = current ? (current + '\n\n' + templateRLQ) : templateRLQ;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL BRZUCHA W CIƒÑ≈ªY
  const isPregnancyAbdPain =
    chief.includes('b√≥lu brzucha w ciƒÖ≈ºy') ||
    chief.includes('ciƒÖ≈ºy') ||
    chief.includes('plamienia') ||
    chief.includes('krwawienia w ciƒÖ≈ºy');

  if(isPregnancyAbdPain){
    const templatePreg =
`‚Ä¶ tyg. ciƒÖ≈ºy, ciƒÖ≈ºa ‚Ä¶‚Ä¶
Dolegliwo≈õci b√≥lowe okolicy podbrzusza od ‚Ä¶‚Ä¶, z towarzyszƒÖcym plamieniem od ‚Ä¶‚Ä¶
Dolegliwo≈õci b√≥lowe krocza od ‚Ä¶‚Ä¶
Konsultowana ginekologicznie z lekarzem prowadzƒÖcym.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (ciƒÖ≈ºa)
    if(!current.includes('Konsultowana ginekologicznie') && !current.includes('plamieniem')){
      box.value = current ? (current + '\n\n' + templatePreg) : templatePreg;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NIEDRO≈ªNO≈öƒÜ CEWNIKA
  const isCatheterObstruction =
    chief.includes('niedro≈ºno≈õci cewnika') ||
    chief.includes('zatkania cewnika');

  if(isCatheterObstruction){
    const templateCath =
`cewnik za≈Ço≈ºony ‚Ä¶‚Ä¶, ostatnia wymiana cewnika ‚Ä¶‚Ä¶
Bez innych dolegliwo≈õci.
Wywiad urologiczny: brak rozpoznanych wcze≈õniej chor√≥b prostaty / ‚Ä¶‚Ä¶.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (cewnik)
    if(!current.includes('ostatnia wymiana cewnika') && !current.includes('Wywiad urologiczny')){
      box.value = current ? (current + '\n\n' + templateCath) : templateCath;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // ZATRZYMANIE MOCZU
  const isUrinaryRetention =
    chief.includes('zatrzymania moczu') ||
    chief.includes('braku oddawania moczu') ||
    chief.includes('bezmoczu');

  if(isUrinaryRetention){
    const templateRetention =
`jest to pierwszy/kolejny tego typu epizod w ≈ºyciu.
B√≥l podbrzusza nasila siƒô wraz z up≈Çywem czasu.
W przesz≈Ço≈õci nie wystƒôpowa≈Çy podobne objawy.
Oddawanie stolca ‚Äì prawid≈Çowe.
Wywiad urologiczny: brak rozpoznanych wcze≈õniej chor√≥b prostaty / ‚Ä¶‚Ä¶.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (retencja)
    if(!current.includes('B√≥l podbrzusza nasila siƒô wraz z up≈Çywem czasu') && !current.includes('Wywiad urologiczny')){
      box.value = current ? (current + '\n\n' + templateRetention) : templateRetention;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NEFROSTOMIA: krwawienie / zatkanie / przeciekanie
  const isNephrostomyIssue =
    chief.includes('krwawienia z nefrostomii') ||
    chief.includes('zatkania nefrostomii') ||
    chief.includes('przeciekania z nefrostomii');

  if(isNephrostomyIssue){
    const templateNeph =
`dolegliwo≈õci od ‚Ä¶‚Ä¶‚Ä¶
Nefrostomia za≈Ço≈ºona ‚Ä¶‚Ä¶‚Ä¶ / wymieniana ‚Ä¶‚Ä¶‚Ä¶
Okolica nefrostomii: widoczne sƒÖczenie krwiste, opatrunek czƒô≈õciowo przesiƒÖkniƒôty, dren dro≈ºny, ale z niewielkƒÖ domieszkƒÖ krwi.
Brak cech ropowicy, zaczerwienienia czy bolesno≈õci nasilonej uciskiem.
Brzuch miƒôkki, niebolesny, bez objaw√≥w otrzewnowych.
W wywiadzie: guz pƒôcherza moczowego.
Diureza zachowana.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (nefrostomia)
    if(!current.includes('Okolica nefrostomii:') && !current.includes('Diureza zachowana')){
      box.value = current ? (current + '\n\n' + templateNeph) : templateNeph;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // KRWIOMOCZ
  const isHematuria =
    chief.includes('krwiomoczu') ||
    chief.includes('krwi w moczu') ||
    chief.includes('krwistego mocz') ||
    chief.includes('skrzep√≥w w moczu');

  if(isHematuria){
    const templateHem =
`dolegliwo≈õci od ‚Ä¶‚Ä¶
Krew w moczu wystƒôpuje stale/okresowo, z obecno≈õciƒÖ skrzep√≥w / bez skrzep√≥w.
Dodatkowo zg≈Çasza b√≥l w okolicy lƒôd≈∫wiowej / podbrzusza / w trakcie mikcji.
Nie pamiƒôta urazu jamy brzusznej lub okolicy lƒôd≈∫wiowej w ostatnim czasie.
W wywiadzie: kamica uk≈Çadu moczowego / zaka≈ºenia dr√≥g moczowych / choroby nerek / nowotwory uk≈Çadu moczowego.
Przebyte zabiegi urologiczne: ‚Ä¶‚Ä¶
Stosowane leki przeciwzakrzepowe: ‚Ä¶‚Ä¶`;

    const current = (box.value || '').trim();
    // anty-duplikacja (krwiomocz)
    if(!current.includes('Krew w moczu wystƒôpuje') && !current.includes('Stosowane leki przeciwzakrzepowe')){
      box.value = current ? (current + '\n\n' + templateHem) : templateHem;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // PRZEWLEK≈ÅE ZAPARCIA
  const isChronicConstipation =
    chief.includes('przewlek≈Çych zaparƒá') ||
    chief.includes('zaparƒá') ||
    chief.includes('braku stolca') ||
    chief.includes('trudno≈õci w wypr√≥≈ºnieniu') ||
    chief.includes('uczucia niepe≈Çnego wypr√≥≈ºnienia');

  if(isChronicConstipation){
    const templateConst =
`dolegliwo≈õci utrzymujƒÖ siƒô od d≈Çu≈ºszego czasu.
W ostatnim okresie (np. ostatnich dni/tygodni) objawy nasili≈Çy siƒô ‚Äì oddawanie stolca wystƒôpuje rzadziej, z wiƒôkszym wysi≈Çkiem, pacjent/ka skar≈ºy siƒô na uczucie niepe≈Çnego wypr√≥≈ºnienia.
Dolegliwo≈õciom towarzyszy b√≥l brzucha o charakterze rozlanym, g≈Ç√≥wnie w dolnych partiach jamy brzusznej.
B√≥l ma charakter napadowy, zwiƒÖzany z potrzebƒÖ wypr√≥≈ºnienia, ustƒôpujƒÖcy czƒô≈õciowo po defekacji.
Apetyt ‚Äì [zachowany / zmniejszony].
W wywiadzie: [dieta ubogoresztkowa, siedzƒÖcy tryb ≈ºycia, brak regularnych wypr√≥≈ºnie≈Ñ od lat, leki sprzyjajƒÖce zaparciom ‚Äì np. ≈ºelazo, opioidy].`;

    const current = (box.value || '').trim();
    // anty-duplikacja (zaparcia)
    if(!current.includes('uczucie niepe≈Çnego wypr√≥≈ºnienia') && !current.includes('leki sprzyjajƒÖce zaparciom')){
      box.value = current ? (current + '\n\n' + templateConst) : templateConst;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL W OKOLICY ODBYTU
  const isAnalPain =
    chief.includes('b√≥lu w okolicy odbytu') ||
    chief.includes('b√≥lu odbytu') ||
    chief.includes('hemoroid√≥w') ||
    chief.includes('szczeliny odbytu') ||
    chief.includes('guzka w okolicy odbytu');

  if(isAnalPain){
    const templateAnal =
`b√≥l trwajƒÖcy od ‚Ä¶‚Ä¶
B√≥l ma charakter ostry / piekƒÖcy / k≈ÇujƒÖcy / pulsujƒÖcy, nasilajƒÖcy siƒô podczas defekacji / utrzymujƒÖcy siƒô stale.
W badaniu wyczuwalne uwypuklenie lub bolesny guzek w okolicy odbytu.
W przesz≈Ço≈õci: hemoroidy / szczelina odbytu / choroby proktologiczne / przebyte zabiegi w obrƒôbie odbytu lub odbytnicy.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (odbyt)
    if(!current.includes('guzek w okolicy odbytu') && !current.includes('choroby proktologiczne')){
      box.value = current ? (current + '\n\n' + templateAnal) : templateAnal;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL JƒÑDRA
  const isTesticularPain =
    chief.includes('b√≥lu jƒÖdra') ||
    chief.includes('b√≥lu moszny');

  if(isTesticularPain){
    const templateTestis =
`b√≥l wystƒÖpi≈Ç ‚Ä¶‚Ä¶‚Ä¶, nasili≈Ç siƒô ‚Ä¶‚Ä¶‚Ä¶
Pacjent zauwa≈ºa, ≈ºe jƒÖdro ___ jest nieznacznie powiƒôkszone w por√≥wnaniu z drugim.
Wed≈Çug relacji pacjenta, b√≥l w obrƒôbie tego jƒÖdra zdarza≈Ç siƒô sporadycznie ju≈º wcze≈õniej, szczeg√≥lnie po stosunku seksualnym, jednak nie by≈Ç dotƒÖd tak nasilony.
Pacjent neguje uraz w obrƒôbie moszny lub brzucha.
B√≥l zmniejsza siƒô po uniesieniu jƒÖdra.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (jƒÖdro)
    if(!current.includes('B√≥l zmniejsza siƒô po uniesieniu jƒÖdra') && !current.includes('jƒÖdro ___ jest nieznacznie powiƒôkszone')){
      box.value = current ? (current + '\n\n' + templateTestis) : templateTestis;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ JƒÑDRA / MOSZNY
  const isTesticularTrauma =
    chief.includes('urazu jƒÖdra') ||
    chief.includes('st≈Çuczenia jƒÖdra') ||
    chief.includes('urazu moszny') ||
    chief.includes('st≈Çuczenia moszny') ||
    chief.includes('kopniƒôcia w krocze') ||
    chief.includes('uderzenia w krocze');

  if(isTesticularTrauma){
    const templateTrauma =
`do urazu dosz≈Ço ‚Ä¶‚Ä¶
Uraz tƒôpy (np. uderzenie, kopniƒôcie, przygniecenie). B√≥l [nag≈Çy/narastajƒÖcy], [promieniuje / nie promieniuje] do pachwiny/podbrzusza.
Oddawanie moczu [prawid≈Çowe/utrudnione], [brak/obecno≈õƒá] krwiomoczu.
Urazy wsp√≥≈ÇistniejƒÖce [tak/nie].
Choroby jƒÖder w wywiadzie [tak/nie].
Badanie przedmiotowe: Moszna [asymetryczna/symetryczna], jƒÖdro [bolesne przy palpacji], [powiƒôkszone], [twarde/miƒôkkie]; odruch d≈∫wigacza [obecny/nieobecny]. Objawy otrzewnowe [brak].`;

    const current = (box.value || '').trim();
    // anty-duplikacja (uraz jƒÖdra)
    if(!current.includes('Uraz tƒôpy') && !current.includes('odruch d≈∫wigacza')){
      box.value = current ? (current + '\n\n' + templateTrauma) : templateTrauma;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ ≈ªEBER
  const isRibTrauma =
    chief.includes('urazu ≈ºeber') ||
    chief.includes('st≈Çuczenia ≈ºeber') ||
    chief.includes('b√≥lu ≈ºeber po urazie');

  if(isRibTrauma){
    const templateRibs =
`do urazu dosz≈Ço w wyniku upadku / uderzenia.
Zdarzenie mia≈Ço miejsce ‚Ä¶‚Ä¶
Po urazie odczuwa b√≥l w okolicy ≈ºeber po stronie ____.
Zg≈Çasza znaczne dolegliwo≈õci b√≥lowe nasilajƒÖce siƒô przy g≈Çƒôbokim wdechu i ruchach tu≈Çowia.
Uraz g≈Çowy neguje, bez utraty przytomno≈õci. Okoliczno≈õci zdarzenia pamiƒôta.
W badaniu: znaczna bolesno≈õƒá okolicy ≈ºeber po stronie ____.
Brak cech uszkodzenia nask√≥rka, krwiaka ani deformacji widocznej go≈Çym okiem.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (≈ºebra)
    if(!current.includes('b√≥l w okolicy ≈ºeber') && !current.includes('g≈Çƒôbokim wdechu i ruchach tu≈Çowia')){
      box.value = current ? (current + '\n\n' + templateRibs) : templateRibs;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL KO≈ÉCZYNY DOLNEJ (bez urazu)
  const isLowerLimbPain =
    chief.includes('b√≥lu ko≈Ñczyny dolnej') ||
    chief.includes('b√≥lu nogi') ||
    chief.includes('b√≥lu podudzia') ||
    chief.includes('b√≥lu ≈Çydki') ||
    chief.includes('b√≥lu stawu skokowego');

  if(isLowerLimbPain){
    const templateLimb =
`b√≥l skoncentrowany w okolicy stawu skokowego / podudzia ‚Ä¶‚Ä¶
Dolegliwo≈õci pojawi≈Çy siƒô samoistnie, bez urazu w wywiadzie.
B√≥l o charakterze ciƒÖg≈Çym, umiarkowany, nasila siƒô podczas chodzenia i obciƒÖ≈ºenia ko≈Ñczyny.
Pierwszy taki epizod w ≈ºyciu / Zakrzepica w wywiadzie.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (ko≈Ñczyna dolna)
    if(!current.includes('bez urazu w wywiadzie') && !current.includes('Zakrzepica w wywiadzie')){
      box.value = current ? (current + '\n\n' + templateLimb) : templateLimb;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
// OPARZENIE CHEMICZNE
const isChemicalBurn =
  chief.includes('oparzenia chemicznego') ||
  chief.includes('poparzenia chemicznego') ||
  chief.includes('oparzenia substancjƒÖ chemicznƒÖ') ||
  chief.includes('kontaktu z substancjƒÖ chemicznƒÖ');

if(isChemicalBurn){
  const templateChemicalBurn =
`do zdarzenia dosz≈Ço w dniu ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ w wyniku przypadkowego rozlania substancji / podczas czyszczenia.
Kontakt z substancjƒÖ chemicznƒÖ mia≈Ç miejsce w warunkach domowych / w pracy / w innym miejscu.
Rodzaj substancji: znany / nieznany (je≈õli znany: ‚Ä¶‚Ä¶‚Ä¶).
Charakter substancji: p≈Çynna / sta≈Ça / gazowa.
Czas kontaktu substancji ze sk√≥rƒÖ / b≈ÇonƒÖ ≈õluzowƒÖ: ‚Ä¶‚Ä¶‚Ä¶

Miejsce oparzenia: ‚Ä¶‚Ä¶‚Ä¶
Powierzchnia objƒôta oparzeniem: niewielka / rozleg≈Ça.

Po zdarzeniu podjƒôto / nie podjƒôto dzia≈Ça≈Ñ dora≈∫nych: p≈Çukanie wodƒÖ / brak p≈Çukania / inne (jakie: ‚Ä¶‚Ä¶‚Ä¶).
Od momentu zdarzenia wystƒôpuje / nie wystƒôpuje narastanie dolegliwo≈õci.`;

  const current = (box.value || '').trim();

  // anty-duplikacja
  if(!current.includes('oparzenie chemiczne') && !current.includes('substancjƒÖ chemicznƒÖ')){
    box.value = current
      ? (current + '\n\n' + templateChemicalBurn)
      : templateChemicalBurn;
    box.focus();
    box.setSelectionRange(box.value.length, box.value.length);
  }
}
  // OPARZENIE TERMICZNE
  const isThermalBurn =
    chief.includes('oparzenia termicznego') ||
    chief.includes('oparzenia ogniem') ||
    chief.includes('oparzenia p≈Çomieniem') ||
    chief.includes('oparzenia gorƒÖcƒÖ wodƒÖ') ||
    chief.includes('oparzenia wrzƒÖtkiem') ||
    chief.includes('oparzenia parƒÖ') ||
    chief.includes('poparzenia') ||
    chief.includes('oparzenia gorƒÖcym przedmiotem');

  if(isThermalBurn){
    const templateBurn =
`do zdarzenia dosz≈Ço w dniu ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ w wyniku kontaktu z wysokƒÖ temperaturƒÖ (ogie≈Ñ / p≈Çomie≈Ñ / gorƒÖca ciecz / para wodna / gorƒÖcy przedmiot).
Zdarzenie mia≈Ço miejsce w warunkach domowych / w pracy / w innym miejscu.

Mechanizm urazu: bezpo≈õredni kontakt z czynnikiem termicznym / rozlanie gorƒÖcej cieczy / zapalenie odzie≈ºy / inne (jakie: ‚Ä¶‚Ä¶‚Ä¶).
Czas dzia≈Çania czynnika termicznego: ‚Ä¶‚Ä¶‚Ä¶

Miejsce oparzenia: ‚Ä¶‚Ä¶‚Ä¶
Powierzchnia objƒôta oparzeniem: niewielka / rozleg≈Ça.
G≈Çƒôboko≈õƒá oparzenia: powierzchowne / g≈Çƒôbokie / trudna do oceny.

Po zdarzeniu podjƒôto / nie podjƒôto dzia≈Ça≈Ñ dora≈∫nych.
Zastosowano ch≈Çodzenie zimnƒÖ wodƒÖ / brak ch≈Çodzenia / inne (jakie: ‚Ä¶‚Ä¶‚Ä¶).
Na≈Ço≈ºono opatrunek / nie na≈Ço≈ºono opatrunku.

Od momentu zdarzenia dolegliwo≈õci narastajƒÖ / pozostajƒÖ bez zmian / ulegajƒÖ zmniejszeniu.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (oparzenie)
    if(!current.includes('kontakt z wysokƒÖ temperaturƒÖ') && !current.includes('Miejsce oparzenia')){
      box.value = current ? (current + '\n\n' + templateBurn) : templateBurn;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // PORA≈ªENIE PRƒÑDEM ELEKTRYCZNYM
  const isElectricShock =
    chief.includes('pora≈ºenia prƒÖdem elektrycznym') ||
    chief.includes('pora≈ºenia prƒÖdem');

  if(isElectricShock){
    const templateShock =
`do zdarzenia dosz≈Ço w dniu ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
Mechanizm urazu: kontakt z prƒÖdem elektrycznym (urzƒÖdzenie domowe / instalacja elektryczna / linia energetyczna / inne).
Szacowane napiƒôcie: niskie / wysokie / nieznane.
Czas kontaktu z prƒÖdem: ‚Ä¶‚Ä¶‚Ä¶
Miejsce wnikniƒôcia i wyj≈õcia prƒÖdu: ‚Ä¶‚Ä¶‚Ä¶
Czy dosz≈Ço do utraty przytomno≈õci: tak / nie / niepewne.
Po zdarzeniu: splƒÖtanie / dezorientacja / brak objaw√≥w neurologicznych.
Widoczne oparzenia sk√≥ry: tak / nie (lokalizacja: ‚Ä¶‚Ä¶‚Ä¶).
Od zdarzenia dolegliwo≈õci: narastajƒÖ / bez zmian / ustƒôpujƒÖ.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (prƒÖd)
    if(!current.includes('kontakt z prƒÖdem elektrycznym') && !current.includes('Miejsce wnikniƒôcia i wyj≈õcia prƒÖdu')){
      box.value = current ? (current + '\n\n' + templateShock) : templateShock;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // CIA≈ÅO OBCE W RANIE
  const isWoundForeignBody =
    chief.includes('cia≈Ça obcego w ranie') ||
    chief.includes('szk≈Ça w ranie') ||
    chief.includes('od≈Çamku w ranie') ||
    chief.includes('metalu w ranie') ||
    chief.includes('drzazgi') ||
    chief.includes('drzazgi w ranie');

  if(isWoundForeignBody){
    const templateWoundFB =
`do zdarzenia dosz≈Ço ‚Ä¶‚Ä¶‚Ä¶w mechanizmie skaleczenia / urazu ostrego / wypadku / kontaktu z rozbitym szk≈Çem / metalem. 
Rodzaj cia≈Ça obcego: [szk≈Ço / metal / drzazga / kamie≈Ñ / inne / nieznany].
Okolica rany: ‚Ä¶‚Ä¶‚Ä¶, uczucie obecno≈õci cia≈Ça obcego w ranie, b√≥l miejscowy, nasilajƒÖcy siƒô przy ucisku lub ruchu. 
Cia≈Ço obce widoczne.
Krwawienie brak / niewielkie / obfite.
Pr√≥by samodzielnego usuniƒôcia .....
Ostatnie szczepienie p/tƒô≈ºcowi: ‚Ä¶‚Ä¶‚Ä¶
Objawy infekcji miejscowej: zaczerwienienie / obrzƒôk / wysiƒôk ropny / ocieplenie`;

    const current = (box.value || '').trim();
    // anty-duplikacja (cia≈Ço obce w ranie)
    if(!current.includes('Rodzaj cia≈Ça obcego') && !current.includes('Ostatnie szczepienie p/tƒô≈ºcowi')){
      box.value = current ? (current + '\n\n' + templateWoundFB) : templateWoundFB;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // KRWAWIENIE Z RANY PO ZABIEGU
  const isPostOpWoundBleeding =
    chief.includes('krwawienia z rany po zabiegu') ||
    chief.includes('krwawienia z rany pooperacyjnej');

  if(isPostOpWoundBleeding){
    const templatePostOpBleed =
`do krwawienia dosz≈Ço ‚Ä¶‚Ä¶‚Ä¶ i ma charakter sƒÖczƒÖcy / nasilony / pulsujƒÖcy, utrzymuje siƒô / narasta / wystƒÖpi≈Ço jednorazowo.
Rana zlokalizowana w okolicy ‚Ä¶‚Ä¶, po zabiegu wykonanym [czas] temu.
Opatrunek przemaka / nie przemaka, by≈Ç / nie by≈Ç zmieniany przed zg≈Çoszeniem.
Do tej pory nie wystƒôpowa≈Çy zaburzenia krzepniƒôcia; wcze≈õniej te≈º nie wystƒôpowa≈Çy problemy z gojeniem ran.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (krwawienie po zabiegu)
    if(!current.includes('Opatrunek przemaka') && !current.includes('zaburzenia krzepniƒôcia')){
      box.value = current ? (current + '\n\n' + templatePostOpBleed) : templatePostOpBleed;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // POWIK≈ÅANIA PO ZABIEGU
  const isPostOpComplications =
    chief.includes('powik≈Çania po zabiegu') ||
    chief.includes('powik≈Ça≈Ñ po zabiegu') ||
    chief.includes('problem√≥w z ranƒÖ pooperacyjnƒÖ') ||
    chief.includes('powik≈Çania pooperacyjnego');

  if(isPostOpComplications){
    const templatePostOpComp =
`dolegliwo≈õci od ‚Ä¶‚Ä¶, obserwowane sƒÖ: nasilajƒÖcy siƒô b√≥l w okolicy operowanej / obrzƒôk / zaczerwienienie / wyciek z rany: surowiczy / ropny / krwawienie.
Rana pooperacyjna sucha / sƒÖczƒÖca / z cechami ropnej wydzieliny.
Miejscowo wystƒôpujƒÖ objawy w postaci tkliwo≈õci, wzrostu ucieplenia sk√≥ry, krwiaka, rozej≈õcia siƒô rany.
Dosz≈Ço do nag≈Çego nasilenia dolegliwo≈õci.
Po zabiegu stosowano antybiotykoterapiƒô.
Nie wystƒôpowa≈Çy wcze≈õniejsze powik≈Çania pooperacyjne.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (powik≈Çania po zabiegu)
    if(!current.includes('Rana pooperacyjna sucha') && !current.includes('stosowano antybiotykoterapiƒô')){
      box.value = current ? (current + '\n\n' + templatePostOpComp) : templatePostOpComp;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // RANY PO SAMOOKALECZENIU
  const isSelfHarmWounds =
    chief.includes('rany po samookaleczeniu') ||
    chief.includes('ran po samookaleczeniu') ||
    chief.includes('samookaleczenia');

  if(isSelfHarmWounds){
    const templateSelfHarm =
`do zdarzenia dosz≈Ço ‚Ä¶‚Ä¶‚Ä¶
Rany zlokalizowane sƒÖ w okolicy przedramion / nadgarstk√≥w / ud / ....., powsta≈Çe przy u≈ºyciu ostrego narzƒôdzia ‚Äì ≈ºyletka, n√≥≈º / szk≈Ça / nieznanego przedmiotu.
Dzia≈Çanie mia≈Ço charakter samouszkodzenia.
Podaje, ≈ºe zdarzenie by≈Ço zwiƒÖzane z silnym stresem / napiƒôciem emocjonalnym / konfliktem / pogorszeniem stanu psychicznego.
W przesz≈Ço≈õci wystƒôpowa≈Çy / nie wystƒôpowa≈Çy podobne epizody samookalecze≈Ñ.
Jest / nie jest w trakcie leczenia psychiatrycznego lub psychologicznego.
Dodatkowo zg≈Çasza spo≈ºycie alkoholu lub innych substancji psychoaktywnych w dniu zdarzenia.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (samookaleczenie)
    if(!current.includes('dzia≈Çanie mia≈Ço charakter samouszkodzenia') && !current.includes('w trakcie leczenia psychiatrycznego')){
      box.value = current ? (current + '\n\n' + templateSelfHarm) : templateSelfHarm;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NADEPNIƒòCIE NA GW√ì≈πD≈π / RANA K≈ÅUTA STOPY
  const isNailPuncture =
    chief.includes('nadepniƒôcia na gw√≥≈∫d≈∫') ||
    chief.includes('rany k≈Çutej stopy');

  if(isNailPuncture){
    const templateNail =
`do zdarzenia dosz≈Ço ‚Ä¶‚Ä¶‚Ä¶
Rana k≈Çuta w obrƒôbie podeszwy stopy.
Rodzaj przedmiotu: gw√≥≈∫d≈∫ / inny (jaki: ‚Ä¶‚Ä¶‚Ä¶).
Rana zanieczyszczona; rana powierzchowna / g≈Çƒôboka / trudna do oceny.
Ostatnie szczepienie przeciw tƒô≈ºcowi: ‚Ä¶‚Ä¶‚Ä¶
Podjƒôte dzia≈Çania dora≈∫ne: brak / przemycie / opatrunek.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (gw√≥≈∫d≈∫)
    if(!current.includes('Rana k≈Çuta w obrƒôbie podeszwy stopy') && !current.includes('tƒô≈ºcowi')){
      box.value = current ? (current + '\n\n' + templateNail) : templateNail;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
// RANA KƒÑSANA
  const isBiteWound =
    chief.includes('rany kƒÖsanej') ||
    chief.includes('ugryzienia przez psa') ||
    chief.includes('pogryzienia') ||
    chief.includes('rany po ugryzieniu');

  if(isBiteWound){
    const templateBite =
`pogryziony/a przez psa, do kt√≥rego dosz≈Ço ‚Ä¶‚Ä¶‚Ä¶
Zwierzƒô znane, domowe, aktualnie zaszczepione przeciwko w≈õciekli≈∫nie (szczepienie potwierdzone przez w≈Ça≈õciciela).
Do zdarzenia dosz≈Ço podczas zabawy / niesprowokowanego ataku.
Ostatnie szczepienie przeciw tƒô≈ºcowi: ‚Ä¶‚Ä¶‚Ä¶
Podjƒôte dzia≈Çania dora≈∫ne: brak / przemycie / opatrunek / inne (jakie: ‚Ä¶‚Ä¶‚Ä¶).`;

    const current = (box.value || '').trim();
    // anty-duplikacja (rana kƒÖsana)
    if(!current.includes('zaszczepione przeciwko w≈õciekli≈∫nie') && !current.includes('Ostatnie szczepienie przeciw tƒô≈ºcowi')){
      box.value = current ? (current + '\n\n' + templateBite) : templateBite;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
// ROPIE≈É / CZYRAK (zmiana sk√≥rna ropna)
  const isAbscessBoil =
    chief.includes('ropnia') ||
    chief.includes('czyraka') ||
    chief.includes('zmiany ropnej') ||
    chief.includes('zmiany sk√≥rnej o charakterze ropnia');

  if(isAbscessBoil){
  const templateAbscess =
`zmiana zlokalizowana w okolicy ‚Ä¶‚Ä¶, obecna od ‚Ä¶‚Ä¶ (dni / tygodni), z tendencjƒÖ do powiƒôkszania siƒô / bez istotnej progresji.
Zg≈Çasza b√≥l w miejscu zmiany, o charakterze ‚Ä¶‚Ä¶ (tƒôpy / pulsujƒÖcy / narastajƒÖcy), nasilajƒÖcy siƒô przy dotyku oraz ucisku.
Zaobserwowano powiƒôkszenie siƒô zmiany.
Dosz≈Ço / nie dosz≈Ço do samoistnego pƒôkniƒôcia zmiany.`;

  const current = (box.value || '').trim();
  // anty-duplikacja (ropie≈Ñ/czyrak)
  if(!current.toLowerCase().includes('zmiana zlokalizowana w okolicy') && !current.toLowerCase().includes('samoistnego pƒôkniƒôcia')){
    box.value = current ? (current + '\n\n' + templateAbscess) : templateAbscess;
    box.focus();
    box.setSelectionRange(box.value.length, box.value.length);
  }
}
  // KO≈ÅATANIE SERCA / NIER√ìWNE BICIE SERCA
  const isPalpitations =
    chief.includes('uczucia ko≈Çatania serca') ||
    chief.includes('nier√≥wnego bicia serca') ||
    chief.includes('migotania przedsionk√≥w');

  if(isPalpitations){
    const templatePalp =
`poczƒÖtek dolegliwo≈õci by≈Ç nag≈Çy / stopniowy, objawy utrzymujƒÖ siƒô od _____ i majƒÖ charakter sta≈Çy / napadowy.
Podobne epizody wystƒôpowa≈Çy / nie wystƒôpowa≈Çy wcze≈õniej, a rytm serca samoistnie wraca≈Ç / nie wraca≈Ç do normy.
Do wystƒÖpienia objaw√≥w dosz≈Ço w spoczynku / podczas wysi≈Çku / w sytuacji stresowej / po spo≈ºyciu alkoholu / w przebiegu infekcji.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (ko≈Çatanie)
    if(!current.includes('PoczƒÖtek dolegliwo≈õci by≈Ç') && !current.includes('rytm serca samoistnie wraca≈Ç')){
      box.value = current ? (current + '\n\n' + templatePalp) : templatePalp;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // TACHYKARDIA / BRADYKARDIA
  const isTachyBrady =
    chief.includes('tachykardii') ||
    chief.includes('bradykardii') ||
    chief.includes('szybkiego bicia serca') ||
    chief.includes('wolngo bicia serca');

  if(isTachyBrady){
    const templateTachyBrady =
`poczƒÖtek dolegliwo≈õci by≈Ç nag≈Çy / stopniowy, objawy utrzymujƒÖ siƒô od _____ i majƒÖ charakter sta≈Çy / napadowy.
Podobne epizody wystƒôpowa≈Çy / nie wystƒôpowa≈Çy wcze≈õniej oraz czy ustƒôpowa≈Çy samoistnie / po odpoczynku / po przyjƒôciu lek√≥w.
Do wystƒÖpienia objaw√≥w dosz≈Ço w spoczynku / podczas wysi≈Çku / w sytuacji stresowej / po spo≈ºyciu alkoholu, kofeiny lub w przebiegu infekcji.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (tachy/brady)
    if(!current.includes('Podobne epizody wystƒôpowa≈Çy') && !current.includes('po spo≈ºyciu alkoholu, kofeiny')){
      box.value = current ? (current + '\n\n' + templateTachyBrady) : templateTachyBrady;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // SKOKI CI≈öNIENIA TƒòTNICZEGO
  const isBloodPressureSwings =
    chief.includes('skok√≥w ci≈õnienia tƒôtniczego') ||
    chief.includes('wysokiego ci≈õnienia tƒôtniczego') ||
    chief.includes('wahania ci≈õnienia');

  if(isBloodPressureSwings){
    const templateBP =
`dolegliwo≈õci utrzymujƒÖce siƒô od oko≈Ço ‚Ä¶‚Ä¶ dni.
Towarzyszy im b√≥l g≈Çowy, zlokalizowany po stronie ‚Ä¶‚Ä¶‚Ä¶ (np. potylicznej / czo≈Çowej / lewej / prawej).
B√≥l g≈Çowy o umiarkowanym nasileniu, napadowy, niezwiƒÖzany z porƒÖ dnia.
W wywiadzie nadci≈õnienie tƒôtnicze ‚Äì rozpoznane ‚Ä¶‚Ä¶‚Ä¶, leczone farmakologicznie / dotychczas nieleczone.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (ci≈õnienie)
    if(!current.includes('skoki ci≈õnienia') && !current.includes('nadci≈õnienie tƒôtnicze')){
      box.value = current ? (current + '\n\n' + templateBP) : templateBP;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }

  // B√ìL G≈ÅOWY
  const isHeadache =
    chief.includes('b√≥lu g≈Çowy') ||
    chief.includes('migreny');

  if(isHeadache){
    const templateHeadache =
`dolegliwo≈õci od ‚Ä¶‚Ä¶, b√≥l zlokalizowany po stronie ‚Ä¶‚Ä¶, o charakterze ciƒÖg≈Çym, niezwiƒÖzany z porƒÖ dnia, bez towarzyszƒÖcej fotofobii.
Od dnia wczorajszego odczuwa r√≥wnie≈º drƒôtwienie ‚Ä¶‚Ä¶‚Ä¶ ko≈Ñczyny g√≥rnej.
W wywiadzie migrena, zwyrodnienie krƒôgos≈Çupa szyjnego.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (b√≥l g≈Çowy)
    if(!current.includes('bez towarzyszƒÖcej fotofobii') && !current.includes('drƒôtwienie')){
      box.value = current ? (current + '\n\n' + templateHeadache) : templateHeadache;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // ZAWROTY G≈ÅOWY
  const isDizziness =
    chief.includes('zawrot√≥w g≈Çowy');

  if(isDizziness){
    const templateDizzy =
`dolegliwo≈õci utrzymujƒÖ siƒô od ______ godzin / dni.
MajƒÖ charakter ____ (wg pacjenta ‚Äû≈õwiat wiruje‚Äù, uczucie niestabilno≈õci, ‚Äûzamglenia‚Äù).
Zawroty g≈Çowy pojawiajƒÖ siƒô w spoczynku / przy zmianie pozycji / przy ruchach g≈Çowy.
Nasilenie dolegliwo≈õci przy ______ (np. wstawaniu, chodzeniu, skrƒôtach g≈Çowy, wysi≈Çku).
Neguje uraz g≈Çowy.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (zawroty)
    if(!current.includes('wg pacjenta ‚Äû≈õwiat wiruje‚Äù') && !current.includes('Neguje uraz g≈Çowy')){
      box.value = current ? (current + '\n\n' + templateDizzy) : templateDizzy;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL W KLATCE PIERSIOWEJ
  const isChestPain =
    chief.includes('b√≥lu w klatce piersiowej') ||
    chief.includes('ucisku w klatce piersiowej');

  if(isChestPain){
    const templateChest =
`dolegliwo≈õci od ‚Ä¶‚Ä¶, zlokalizowane po stronie ‚Ä¶‚Ä¶
B√≥l promieniuje do ‚Ä¶‚Ä¶ ko≈Ñczyny g√≥rnej oraz plec√≥w.
Dolegliwo≈õci pojawi≈Çy siƒô (np. nagle / przewlekle, od ilu godzin/dni), utrzymujƒÖ siƒô w spoczynku i nie ulegajƒÖ zmianie przy wykonywaniu ruch√≥w skrƒôtnych tu≈Çowia ani przy oddychaniu.
B√≥l o charakterze (np. uciskajƒÖcy / piekƒÖcy / k≈ÇujƒÖcy), oceniany przez pacjenta jako (np. umiarkowany / silny), bez wyra≈∫nych czynnik√≥w prowokujƒÖcych.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (klatka piersiowa)
    if(!current.includes('B√≥l promieniuje do') && !current.includes('ruch√≥w skrƒôtnych tu≈Çowia')){
      box.value = current ? (current + '\n\n' + templateChest) : templateChest;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // B√ìL W KLATCE PIERSIOWEJ PRZY RUCHACH
  const isChestPainWithMovement =
    chief.includes('b√≥lu w klp przy ruchach') ||
    chief.includes('b√≥lu w klp przy g≈Çƒôbokim wdechu');

  if(isChestPainWithMovement){
    const templateChestMove =
`dolegliwo≈õci utrzymujƒÖ siƒô od oko≈Ço ‚Ä¶‚Ä¶ dni, majƒÖ charakter umiarkowany, zlokalizowane po stronie (np. prawej/lewej/≈õr√≥dmostkowej), nasilajƒÖ siƒô przy ruchach tu≈Çowia, schylaniu siƒô, palpacji, oraz g≈Çƒôbokim wdechu.
Nie promieniujƒÖ do ≈ºuchwy ani okolicy przedsercowej.
Dodatkowo zg≈Çasza b√≥l ‚Ä¶‚Ä¶ ko≈Ñczyny g√≥rnej, kt√≥remu towarzyszy uczucie drƒôtwienia i mrowienia w obrƒôbie ramienia i przedramienia.
Objawy majƒÖ charakter napadowy i nasilajƒÖ siƒô przy aktywno≈õci fizycznej.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (klatka przy ruchach)
    if(!current.includes('nasilajƒÖ siƒô przy ruchach tu≈Çowia') && !current.includes('Nie promieniujƒÖ do ≈ºuchwy')){
      box.value = current ? (current + '\n\n' + templateChestMove) : templateChestMove;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // DUSZNO≈öƒÜ NARASTAJƒÑCA / WYSI≈ÅKOWA (NIE USTƒòPUJE W SPOCZYNKU)
  const isDyspneaExertionalProgressive =

    chief.includes('duszno≈õci') ||
    chief.includes('duszno≈õci wysi≈Çkowej') ||
    chief.includes('duszno≈õci spoczynkowej') ||
    chief.includes('narastajƒÖcej duszno≈õci');

  if(isDyspneaExertionalProgressive){
    const templateDyspneaProg =
`dolegliwo≈õci utrzymujƒÖ siƒô od oko≈Ço ‚Ä¶‚Ä¶ dni.
Duszno≈õƒá ma charakter wysi≈Çkowy, stopniowo narastajƒÖcy, nie ustƒôpuje ca≈Çkowicie w spoczynku.
Dolegliwo≈õciom towarzyszy nieznaczny, tƒôpy ucisk w okolicy mostka, bez promieniowania, niezale≈ºny od pozycji cia≈Ça ani fazy oddychania.
Nie zg≈Çasza urazu klatki piersiowej.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (duszno≈õƒá narastajƒÖca)
    if(!current.includes('Duszno≈õƒá ma charakter wysi≈Çkowy, stopniowo narastajƒÖcy') && !current.includes('ucisk w okolicy mostka')){
      box.value = current ? (current + '\n\n' + templateDyspneaProg) : templateDyspneaProg;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NUDNO≈öCI / WYMIOTY
  const isNauseaVomiting =
    chief.includes('wymiot√≥w') ||
    chief.includes('nudno≈õci');

  if(isNauseaVomiting){
    const templateNauseaVomiting =
`nudno≈õci od ‚Ä¶‚Ä¶; wymioty utrzymujƒÖ siƒô od oko≈Ço ‚Ä¶‚Ä¶ dni.
Wymioty poczƒÖtkowo tre≈õciƒÖ pokarmowƒÖ, niezale≈ºne od posi≈Çk√≥w; w godzinach nocnych pojawi≈Çy siƒô r√≥wnie≈º wymioty z domieszkƒÖ ≈º√≥≈Çci.
Dodatkowo od rana zg≈Çasza lekkie zawroty g≈Çowy.
Neguje b≈Çƒôdy dietetyczne oraz spo≈ºycie potencjalnie ska≈ºonej ≈ºywno≈õci.
Nawyki ≈ºywieniowe bez zmian, stosowana dieta bez ogranicze≈Ñ.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (nudno≈õci / wymioty)
    if(
      !current.includes('Wymioty poczƒÖtkowo tre≈õciƒÖ pokarmowƒÖ') &&
      !current.includes('Nudno≈õci od')
    ){
      box.value = current ? (current + '\n\n' + templateNauseaVomiting) : templateNauseaVomiting;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // BIEGUNKA
  const isDiarrhea =
    chief.includes('biegunki') ||
    chief.includes('lu≈∫nych stolc√≥w') ||
    chief.includes('wodnistych stolc√≥w');

  if(isDiarrhea){
    const templateDiarrhea =
`dolegliwo≈õci utrzymujƒÖ siƒô od oko≈Ço ‚Ä¶‚Ä¶ dni.
Wypr√≥≈ºnienia lu≈∫ne, wodniste, bez domieszki krwi ani ≈õluzu, o czƒôstotliwo≈õci ‚Ä¶‚Ä¶ .
Objawom towarzyszƒÖ kurczowe b√≥le brzucha, zlokalizowane w dolnych partiach jamy brzusznej, poprzedzajƒÖce wypr√≥≈ºnienie, ustƒôpujƒÖce czƒô≈õciowo po defekacji.
Na poczƒÖtku objaw√≥w wystƒÖpi≈Çy jednorazowe wymioty tre≈õciƒÖ pokarmowƒÖ.
Od tego czasu bez dalszych epizod√≥w wymiotnych.
Spo≈ºycie potencjalnie ska≈ºonego pokarmu lub p≈Çyn√≥w ‚Äì [np. zaprzecza / spo≈ºywa≈Ç(a) wcze≈õniej posi≈Çek na mie≈õcie].`;

    const current = (box.value || '').trim();
    // anty-duplikacja (biegunka)
    if(
      !current.includes('Wypr√≥≈ºnienia lu≈∫ne, wodniste') &&
      !current.includes('kurczowe b√≥le brzucha')
    ){
      box.value = current ? (current + '\n\n' + templateDiarrhea) : templateDiarrhea;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // KRWIOPLUCIE
  const isHemoptysis =
    chief.includes('krwioplucia') ||
    chief.includes('odkrztuszania krwi');

  if(isHemoptysis){
    const templateHemoptysis =
`dolegliwo≈õci utrzymujƒÖ siƒô od oko≈Ço ‚Ä¶‚Ä¶ dni.
Dolegliwo≈õciom towarzyszƒÖ trudno≈õci w oddychaniu oraz pogorszenie tolerancji wysi≈Çku.
Odkrztuszana krew ma ciemne zabarwienie, czƒôsto ze skrzepami; objawy nasili≈Çy siƒô w ostatnich dniach.
Nie przeby≈Ç(a) ostatnio infekcji dr√≥g oddechowych ani uraz√≥w klatki piersiowej.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (krwioplucie)
    if(
      !current.includes('Odkrztuszana krew ma ciemne zabarwienie') &&
      !current.includes('skrzeplami')
    ){
      box.value = current ? (current + '\n\n' + templateHemoptysis) : templateHemoptysis;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // KRWAWIENIE Z NOSA
  const isEpistaxis =
    chief.includes('krwawienia z nosa') ||
    chief.includes('epistaxis');

  if(isEpistaxis){
    const templateEpistaxis =
`krwawienie wystƒÖpi≈Ço spontanicznie ‚Ä¶‚Ä¶ (np. dzi≈õ rano / przed kilkoma godzinami), jednostronne / obustronne, o umiarkowanym nasileniu.
Pierwszorazowy epizod./
W przesz≈Ço≈õci wystƒÖpi≈Ç podobny epizod krwawienia z nosa, wymagajƒÖcy interwencji laryngologicznej i koagulacji.
Neguje uraz g≈Çowy.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (krwawienie z nosa)
    if(
      !current.includes('krwawienie wystƒÖpi≈Ço spontanicznie') &&
      !current.includes('interwencji laryngologicznej')
    ){
      box.value = current ? (current + '\n\n' + templateEpistaxis) : templateEpistaxis;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // OMDLENIE / UTRATA PRZYTOMNO≈öCI
  const isSyncopeLOC =
    chief.includes('omdlenia') ||
    chief.includes('zas≈Çabniƒôcia') ||
    chief.includes('utraty przytomno≈õci');

  if(isSyncopeLOC){
    const templateSyncopeLOC =
`do zdarzenia dosz≈Ço: ‚Ä¶‚Ä¶ (miejsce, okoliczno≈õci, aktywno≈õƒá w momencie omdlenia).
Omdlenie by≈Ço: nag≈Çe / poprzedzone objawami (np. zawroty g≈Çowy, mroczki przed oczami, uczucie gorƒÖca, os≈Çabienie, nudno≈õci, ko≈Çatanie serca, b√≥l w klatce piersiowej, duszno≈õƒá, b√≥l g≈Çowy).
Czas trwania: kr√≥tkotrwa≈Çe / d≈Çugotrwa≈Çe.
Utrata przytomno≈õci: pe≈Çna / niepe≈Çna.
Powr√≥t ≈õwiadomo≈õci: samoistny, szybki / powolny.
Orientacja po epizodzie: prawid≈Çowa / zaburzona.
Uraz w wyniku omdlenia:.
Z relacji: w trakcie epizodu wystƒÖpi≈Çy drgawki / ruchy toniczno-kloniczne / przygryzienie jƒôzyka / nietrzymanie moczu.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (omdlenie / LOC)
    if(
      !current.includes('Omdlenie by≈Ço:') &&
      !current.includes('Powr√≥t ≈õwiadomo≈õci')
    ){
      box.value = current ? (current + '\n\n' + templateSyncopeLOC) : templateSyncopeLOC;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // INFEKCJA
  const isInfection =
    chief.includes('infekcji') ||
    chief.includes('objaw√≥w infekcji') ||
    chief.includes('gorƒÖczki') ||
    chief.includes('dreszczy') ||
    chief.includes('kaszlu') ||
    chief.includes('b√≥lu gard≈Ça');

  if(isInfection){
    const templateInfection =
`dolegliwo≈õci od ‚Ä¶‚Ä¶ (czas trwania objaw√≥w).
W domu temp.:
Infekcja ma charakter nag≈Çy / nasilajƒÖcy siƒô / przewlek≈Çy.
Objawy nasilajƒÖ siƒô od .....
Z relacji kontakt z osobƒÖ chorƒÖ: .`;

    const current = (box.value || '').trim();
    // anty-duplikacja (infekcja)
    if(
      !current.includes('Objawy ze strony uk≈Çadu oddechowego') &&
      !current.includes('Objawy neurologiczne')
    ){
      box.value = current ? (current + '\n\n' + templateInfection) : templateInfection;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // OG√ìLNE OS≈ÅABIENIE
  const isGeneralWeakness =
    chief.includes('og√≥lnego os≈Çabienia') ||
    chief.includes('os≈Çabienia');

  if(isGeneralWeakness){
    const templateGeneralWeakness =
`dolegliwo≈õci utrzymujƒÖ siƒô od ‚Ä¶‚Ä¶ (godzin / dni / tygodni), o charakterze nag≈Çym / narastajƒÖcym / przewlek≈Çym.
Zg≈Çasza uczucie zmniejszonej tolerancji wysi≈Çku, szybsze mƒôczenie siƒô oraz subiektywne poczucie braku si≈Ç.
Os≈Çabienie dotyczy: ca≈Çego cia≈Ça / ko≈Ñczyn dolnych / ko≈Ñczyn g√≥rnych / asymetryczne.
Os≈Çabienie nasila siƒô przy ‚Ä¶‚Ä¶ (np. chodzeniu, wstawaniu, wysi≈Çku) i ustƒôpuje / nie ustƒôpuje po odpoczynku.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (og√≥lne os≈Çabienie)
    if(
      !current.includes('Zg≈Çasza uczucie zmniejszonej tolerancji wysi≈Çku') &&
      !current.includes('szybsze mƒôczenie siƒô')
    ){
      box.value = current ? (current + '\n\n' + templateGeneralWeakness) : templateGeneralWeakness;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // DRƒòTWIENIE / MROWIENIE
  const isParesthesia =
    chief.includes('drƒôtwienia') ||
    chief.includes('mrowienia') ||
    chief.includes('parestezji') ||
    chief.includes('drƒôtwienia ko≈Ñczyn') ||
    chief.includes('mrowienia ko≈Ñczyn');

  if(isParesthesia){
    const templateParesthesia =
`dolegliwo≈õci utrzymujƒÖ siƒô od ‚Ä¶‚Ä¶ (minut / godzin / dni), o charakterze nag≈Çym / narastajƒÖcym / okresowym.
Drƒôtwienie / mrowienie dotyczy: ‚Ä¶‚Ä¶ (ko≈Ñczyny ‚Ä¶‚Ä¶ / obu ko≈Ñczyn / okolicy ‚Ä¶‚Ä¶).
Wystƒôpowa≈Çy wcze≈õniej / Pierwszorazowy epizod.
Objawy majƒÖ charakter: sta≈Çy / napadowy / przemijajƒÖcy.
Dolegliwo≈õci pojawi≈Çy siƒô: w spoczynku / po wysi≈Çku / po d≈Çugotrwa≈Çym ucisku / po zmianie pozycji cia≈Ça / po urazie / bez uchwytnej przyczyny.
Czynniki nasilajƒÖce: ‚Ä¶‚Ä¶ / czynniki ≈ÇagodzƒÖce: ‚Ä¶‚Ä¶ .`;

    const current = (box.value || '').trim();
    // anty-duplikacja (drƒôtwienie / mrowienie)
    if(
      !current.includes('Drƒôtwienie / mrowienie dotyczy:') &&
      !current.includes('Czynniki nasilajƒÖce')
    ){
      box.value = current ? (current + '\n\n' + templateParesthesia) : templateParesthesia;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // ZABURZENIA ≈öWIADOMO≈öCI
  const isAlteredMentalStatus =
    chief.includes('zaburze≈Ñ ≈õwiadomo≈õci');

  if(isAlteredMentalStatus){
    const templateAlteredMentalStatus =
`do zdarzenia dosz≈Ço: ‚Ä¶‚Ä¶ (miejsce, okoliczno≈õci).
Pierwszorazowy epizod / kolejny epizod.
Zaburzenia ≈õwiadomo≈õci majƒÖ charakter: nag≈Çy / narastajƒÖcy / przemijajƒÖcy / utrzymujƒÖcy siƒô.
Obecny stan ≈õwiadomo≈õci: przytomny, kontakt logiczny / splƒÖtany / senny / reaguje na bod≈∫ce s≈Çowne / b√≥lowe / nie reaguje.
Przebieg zdarzenia: z relacji dosz≈Ço do nag≈Çej utraty kontaktu / wystƒÖpi≈Ça utrata przytomno≈õci.
Czas trwania epizodu: ‚Ä¶‚Ä¶ .
Powr√≥t ≈õwiadomo≈õci: szybki / op√≥≈∫niony / niepe≈Çny.
Epizod by≈Ç poprzedzony objawami: zawroty g≈Çowy / os≈Çabienie / b√≥l g≈Çowy / nudno≈õci / wymioty / zaburzenia widzenia / ko≈Çatanie serca / b√≥l w klatce piersiowej.
Dodatkowo wystƒÖpi≈Çy: drgawki / uraz g≈Çowy / objawy ogniskowe (niedow≈Çad, asymetria twarzy, zaburzenia mowy).`;

    const current = (box.value || '').trim();
    // anty-duplikacja (zaburzenia ≈õwiadomo≈õci)
    if(
      !current.includes('Zaburzenia ≈õwiadomo≈õci majƒÖ charakter') &&
      !current.includes('Obecny stan ≈õwiadomo≈õci')
    ){
      box.value = current ? (current + '\n\n' + templateAlteredMentalStatus) : templateAlteredMentalStatus;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
    // DRGAWKI / NAPAD PADACZKOWY
  const isSeizure =
    chief.includes('drgawek') ||
    chief.includes('napadu padaczkowego') ||
    chief.includes('padaczki') ||
    chief.includes('utraty przytomno≈õci z drgawkami');

  if(isSeizure){
    const templateSeizure =
`do zdarzenia dosz≈Ço: ‚Ä¶‚Ä¶ (miejsce, okoliczno≈õci). Pierwszorazowy epizod / kolejny epizod.
Napad by≈Ç obserwowany przez: ‚Ä¶‚Ä¶ / brak ≈õwiadk√≥w.
Czas trwania napadu: ‚Ä¶‚Ä¶ (pojedynczy epizod / kilka napad√≥w / przed≈Çu≈ºajƒÖcy siƒô napad).
Charakter napadu: uog√≥lniony toniczno-kloniczny / czƒô≈õciowy (ogniskowy) / nieustalony.
Utrata przytomno≈õci: ca≈Çkowita / niepe≈Çna.
Powr√≥t ≈õwiadomo≈õci po napadzie: szybki / op√≥≈∫niony / niepe≈Çny.
Stan ponapadowy: senno≈õƒá / splƒÖtanie / b√≥l g≈Çowy / bez dolegliwo≈õci.
Objawy towarzyszƒÖce napadowi: przygryzienie jƒôzyka / nietrzymanie moczu / stolca / uraz g≈Çowy lub cia≈Ça / wymioty po napadzie / b√≥le miƒô≈õni.
Objawy poprzedzajƒÖce (aura): mroczki przed oczami / zaburzenia widzenia / dziwne zapachy / smaki / uczucie lƒôku / zaburzenia czucia.
Wywiad padaczkowy: padaczka rozpoznana: tak / nie.
Ostatni napad przed obecnym: ‚Ä¶‚Ä¶ ; czƒôsto≈õƒá napad√≥w: ‚Ä¶‚Ä¶ .
Leki przeciwpadaczkowe: przyjmowane regularnie / pominiƒôcie dawki w ostatnich dniach.
Czynniki prowokujƒÖce: brak snu / stres / alkohol (ostatnie 24‚Äì48 h) / infekcja / gorƒÖczka / odwodnienie / nag≈Çe odstawienie lek√≥w / uraz g≈Çowy w ostatnim czasie.`;


     const current = (box.value || '').trim();
    // anty-duplikacja (drgawki / napad)
    if(
      !current.includes('Charakter napadu:') &&
      !current.includes('Stan ponapadowy')
    ){
      box.value = current ? (current + '\n\n' + templateSeizure) : templateSeizure;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // ZATRUCIE ALKOHOLEM SPO≈ªYWCZYM
  const isEthanolIntox =
    chief.includes('zatrucia alkoholem') ||
    chief.includes('upojenia alkoholowego');

  if(isEthanolIntox){
    const templateEthanol =
`w dniu dzisiejszym spo≈ºywa≈Ç/a alkohol spo≈ºywczy / alkohol niespo≈ºywczy (piwo / wino / w√≥dka / inny)/[metanolu / glikolu etylenowego / izopropanolu / p≈Çynu niewiadomego pochodzenia w ilo≈õci (nieznanej / podanej przez pacjenta/≈õwiadka).
Ostatnie spo≈ºycie oko≈Ço ‚Ä¶‚Ä¶
Pacjent pamiƒôta / nie pamiƒôta okoliczno≈õci spo≈ºycia alkoholu.
Neguje / potwierdza przyjmowanie innych substancji psychoaktywnych lub lek√≥w.
Brak informacji o urazie g≈Çowy / podejrzenie urazu ‚Äì okoliczno≈õci niejasne.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (alkohol)
    if(!current.includes('spo≈ºywa≈Ç/a alkohol') && !current.includes('podejrzenie urazu ‚Äì okoliczno≈õci niejasne')){
      box.value = current ? (current + '\n\n' + templateEthanol) : templateEthanol;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // ZATRUCIE LEKAMI / PSYCHOTROPOWE / NARKOTYKI
  const isDrugIntox =
    chief.includes('zatrucia lekami') ||
    chief.includes('zatrucia narkotykami') ||
    chief.includes('zatrucia substancjami psychoaktywnymi');

  if(isDrugIntox){
    const templateDrugIntox =
`mog≈Ço doj≈õƒá do przyjƒôcia: [lek√≥w psychotropowych ‚Äì np. benzodiazepiny, neuroleptyki, leki nasenne, przeciwdepresyjne] oraz/lub [substancji psychoaktywnych ‚Äì np. opioidy, amfetamina, kokaina, THC, dopalacze].
Do spo≈ºycia dosz≈Ço oko≈Ço ‚Ä¶‚Ä¶, w ilo≈õci nieznanej / deklarowanej.
Okoliczno≈õci zdarzenia: przypadkowe / rekreacyjne / celowe / niejasne.
Neguje / nie mo≈ºna wykluczyƒá intencji samob√≥jczych.
WystƒôpujƒÖ zwƒô≈ºone / poszerzone ≈∫renice, sk√≥ra blada / zaczerwieniona / spocona.
Pacjent/≈õwiadek potwierdza jednoczesne spo≈ºycie alkoholu lub innych lek√≥w.
Brak / obecne podejrzenie urazu g≈Çowy.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (narkotyki/leki)
    if(!current.includes('Mog≈Ço doj≈õƒá do przyjƒôcia') && !current.includes('intencji samob√≥jczych')){
      box.value = current ? (current + '\n\n' + templateDrugIntox) : templateDrugIntox;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NARASTAJƒÑCE OS≈ÅABIENIE / PODEJRZENIE ANEMII
  const isAnemiaWeakness =
    chief.includes('narastajƒÖcego os≈Çabienia') ||
    chief.includes('podejrzenia anemii') ||
    chief.includes('niedokrwisto≈õci') ||
    chief.includes('anemii');

  if(isAnemiaWeakness){
    const templateAnemia =
`dolegliwo≈õci wystƒôpujƒÖ od ‚Ä¶‚Ä¶‚Ä¶ i stopniowo siƒô nasilajƒÖ.
Obserwuje siƒô blado≈õƒá pow≈Çok sk√≥rnych i b≈Çon ≈õluzowych.
Niedokrwisto≈õƒá w przesz≈Ço≈õci / brak wcze≈õniej rozpoznanej anemii.
Nie zg≈Çasza urazu ani ostrej utraty krwi.
Przed wystƒÖpieniem dolegliwo≈õci pacjent by≈Ç samodzielny.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (anemia)
    if(!current.includes('blado≈õƒá pow≈Çok sk√≥rnych') && !current.includes('niedokrwisto≈õƒá w przesz≈Ço≈õci')){
      box.value = current ? (current + '\n\n' + templateAnemia) : templateAnemia;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // EPIZOD ZAD≈ÅAWIENIA / ZAKRZTUSZENIA
  const isChokingEpisode =
    chief.includes('zad≈Çawienia') ||
    chief.includes('zakrztuszenia') ||
    chief.includes('epizodu zad≈Çawienia') ||
    chief.includes('zach≈Çy≈õniƒôcia');

  if(isChokingEpisode){
    const templateChoking =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ podczas spo≈ºywania pokarmu / przyjmowania p≈Çyn√≥w / cia≈Ça obcego.
W trakcie epizodu wystƒÖpi≈Ç nag≈Çy kaszel, duszno≈õƒá oraz uczucie braku mo≈ºliwo≈õci swobodnego oddychania.
Zg≈Çasza≈Ç trudno≈õci w m√≥wieniu oraz uczucie cia≈Ça obcego w gardle.
Objawy ustƒÖpi≈Çy samoistnie / po interwencji os√≥b trzecich / po odkrztuszeniu.
W wywiadzie brak chor√≥b neurologicznych / stwierdza siƒô choroby neurologiczne lub zaburzenia po≈Çykania.
Nie zg≈Çasza epizod√≥w zad≈Çawienia w przesz≈Ço≈õci / zg≈Çasza podobne epizody.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (zad≈Çawienie)
    if(!current.includes('W trakcie epizodu wystƒÖpi≈Ç nag≈Çy kaszel') && !current.includes('zaburzenia po≈Çykania')){
      box.value = current ? (current + '\n\n' + templateChoking) : templateChoking;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ OKA
  const isEyeInjury =
    chief.includes('urazu oka');

  if(isEyeInjury){
    const templateEyeInjury =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
W mechanizmie uderzenia / urazu chemicznego / urazu termicznego.
Po urazie wystƒÖpi≈Ç b√≥l oka oraz uczucie cia≈Ça obcego.
Zg≈Çasza pogorszenie ostro≈õci widzenia po stronie ‚Ä¶‚Ä¶‚Ä¶, ≈õwiat≈Çowstrƒôt oraz ≈Çzawienie.
WystƒÖpi≈Ço / nie wystƒÖpi≈Ço zaczerwienienie oka oraz obrzƒôk powiek.
Nie zg≈Çasza podw√≥jnego widzenia.
Nie zg≈Çasza wycieku tre≈õci z oka.
Nie zg≈Çasza urazu drugiego oka.
W wywiadzie brak chor√≥b okulistycznych / stwierdza siƒô choroby okulistyczne w przesz≈Ço≈õci.
Pacjent nie nosi / nosi soczewki kontaktowe.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (uraz oka)
    if(!current.includes('Po urazie wystƒÖpi≈Ç b√≥l oka') && !current.includes('Pacjent nie nosi / nosi soczewki')){
      box.value = current ? (current + '\n\n' + templateEyeInjury) : templateEyeInjury;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ BRZUCHA
  const isAbdominalInjury =
     chief.includes('urazu brzucha');

  if(isAbdominalInjury){
    const templateAbdominalInjury =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
W mechanizmie uderzenia / upadku / urazu komunikacyjnego / przygniecenia.
Po urazie wystƒÖpi≈Ç b√≥l brzucha o r√≥≈ºnym nasileniu, zlokalizowany w okolicy ‚Ä¶‚Ä¶‚Ä¶, narastajƒÖcy przy ruchu i palpacji.
Zg≈Çasza tkliwo≈õƒá oraz uczucie rozpierania w jamie brzusznej.
Nie zg≈Çasza urazu innych okolic cia≈Ça.
W wywiadzie brak chor√≥b jamy brzusznej / stwierdza siƒô choroby przewlek≈Çe.
Przed zdarzeniem pacjent by≈Ç w pe≈Çni samodzielny.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (uraz brzucha)
    if(!current.includes('Po urazie wystƒÖpi≈Ç b√≥l brzucha') && !current.includes('tkliwo≈õƒá oraz uczucie rozpierania')){
      box.value = current ? (current + '\n\n' + templateAbdominalInjury) : templateAbdominalInjury;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ (OG√ìLNY) ‚Äì MECHANICZNY
  const isGeneralInjury =
    chief === 'urazu-og√≥lny' ||
    chief.includes('urazu-og√≥lny');

  if(isGeneralInjury){
    const templateGeneralInjury =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
W mechanizmie upadku / uderzenia / urazu komunikacyjnego / przygniecenia / innego urazu mechanicznego.
Po zdarzeniu wystƒÖpi≈Ç b√≥l w okolicy ‚Ä¶‚Ä¶‚Ä¶ o r√≥≈ºnym nasileniu, nasilajƒÖcy siƒô przy ruchu.
Obrzƒôk oraz tkliwo≈õƒá tkanek miƒôkkich.
WystƒÖpi≈Ço / nie wystƒÖpi≈Ço krwawienie zewnƒôtrzne.
Bez utraty przytomno≈õci / zg≈Çasza kr√≥tkotrwa≈ÇƒÖ utratƒô przytomno≈õci.
Szczepienie przeciwko tƒô≈ºcowi aktualne / nieaktualne / brak danych.
Przed zdarzeniem pacjent by≈Ç w pe≈Çni samodzielny.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (uraz og√≥lny)
    if(!current.includes('W mechanizmie upadku / uderzenia') && !current.includes('Szczepienie przeciwko tƒô≈ºcowi')){
      box.value = current ? (current + '\n\n' + templateGeneralInjury) : templateGeneralInjury;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // RANA / RANY (URAZ SK√ìRY)
  const isWound =
    chief === 'rany-og√≥lny' ||
    chief.includes('rany-og√≥lny');

  if(isWound){
    const templateWound =
`do urazu dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
W mechanizmie skaleczenia / przeciƒôcia / rany k≈Çutej / rany t≈Çuczonej / urazu mechanicznego.
Od momentu zdarzenia wystƒôpuje b√≥l w okolicy rany oraz krwawienie o r√≥≈ºnym nasileniu, obecnie ustƒôpujƒÖce / utrzymujƒÖce siƒô.
Rana zlokalizowana jest w okolicy ‚Ä¶‚Ä¶‚Ä¶ .
Obrzƒôk oraz tkliwo≈õƒá tkanek otaczajƒÖcych.
Nie zg≈Çasza drƒôtwienia ani zaburze≈Ñ czucia w obrƒôbie ko≈Ñczyny.
Ruchomo≈õƒá w sƒÖsiednich stawach zachowana / ograniczona.
Bez utraty przytomno≈õci ani urazu innych okolic cia≈Ça.
Rana nie by≈Ça / by≈Ça wcze≈õniej zaopatrywana.
Nie podejmowano / podejmowano pr√≥by samodzielnego oczyszczania rany.
Szczepienie przeciwko tƒô≈ºcowi aktualne / nieaktualne / brak danych.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (rana)
    if(!current.includes('Od momentu zdarzenia wystƒôpuje b√≥l w okolicy rany') && !current.includes('Szczepienie przeciwko tƒô≈ºcowi')){
      box.value = current ? (current + '\n\n' + templateWound) : templateWound;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ PRƒÑCIA
  const isPenileInjury =
    chief.includes('urazu prƒÖcia') ||
    chief.includes('urazu penisa');

  if(isPenileInjury){
    const templatePenileInjury =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ w mechanizmie urazu bezpo≈õredniego / podczas aktywno≈õci seksualnej / w wyniku uderzenia lub przygniecenia.
Po urazie wystƒÖpi≈Ç nag≈Çy b√≥l prƒÖcia, obrzƒôk oraz zasinienie.
Pacjent zg≈Çasza narastajƒÖcy dyskomfort oraz tkliwo≈õƒá w obrƒôbie prƒÖcia.
Oddawanie moczu jest mo≈ºliwe / utrudnione / niemo≈ºliwe.
Pacjent nie zg≈Çasza utraty przytomno≈õci ani urazu innych okolic cia≈Ça.
W wywiadzie brak chor√≥b urologicznych / stwierdza siƒô choroby urologiczne w przesz≈Ço≈õci.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (uraz prƒÖcia)
    if(!current.includes('nag≈Çy b√≥l prƒÖcia, obrzƒôk oraz zasinienie') && !current.includes('Oddawanie moczu jest mo≈ºliwe')){
      box.value = current ? (current + '\n\n' + templatePenileInjury) : templatePenileInjury;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // CIA≈ÅO OBCE W UCHU
  const isForeignBodyEar =
    chief.includes('cia≈Ça obcego w uchu');

  if(isForeignBodyEar){
    const templateForeignBodyEar =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶, podczas zabawy / w niewiadomych okoliczno≈õciach / przypadkowo.
Pacjent zg≈Çasza uczucie zatkania ucha, b√≥l oraz dyskomfort w obrƒôbie przewodu s≈Çuchowego.
Wystƒôpuje pogorszenie s≈Çuchu po stronie ‚Ä¶‚Ä¶‚Ä¶
Brak krwawienia ani wycieku tre≈õci z ucha.
Nie podejmowa≈Ç samodzielnych pr√≥b usuniƒôcia cia≈Ça obcego / podejmowa≈Ç pr√≥by usuniƒôcia bez powodzenia.
W wywiadzie brak urazu g≈Çowy.
Nie stwierdza siƒô gorƒÖczki ani objaw√≥w infekcji.
Pacjent nie zg≈Çasza chor√≥b uszu w przesz≈Ço≈õci.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (ucho)
    if(!current.includes('uczucie zatkania ucha') && !current.includes('Brak krwawienia ani wycieku tre≈õci z ucha')){
      box.value = current ? (current + '\n\n' + templateForeignBodyEar) : templateForeignBodyEar;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // URAZ NOSA
  const isNoseInjury =
    chief.includes('urazu nosa');

  if(isNoseInjury){
    const templateNoseInjury =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ w mechanizmie uderzenia / upadku / urazu bezpo≈õredniego.
Po urazie wystƒÖpi≈Ç b√≥l nosa oraz krwawienie z nosa o r√≥≈ºnym nasileniu, obecnie ustƒôpujƒÖce / utrzymujƒÖce siƒô.
Pacjent zg≈Çasza obrzƒôk oraz tkliwo≈õƒá okolicy nosa.
Nie zg≈Çasza trudno≈õci w oddychaniu przez nos.
Pacjent neguje uraz g≈Çowy oraz uraz innych okolic twarzoczaszki.
Nie zg≈Çasza wycieku p≈Çynu surowiczego z nosa.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (nos)
    if(!current.includes('krwawienie z nosa o r√≥≈ºnym nasileniu') && !current.includes('Nie zg≈Çasza wycieku p≈Çynu surowiczego')){
      box.value = current ? (current + '\n\n' + templateNoseInjury) : templateNoseInjury;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // REAKCJA ALERGICZNA
  const isAllergicReaction =
    chief.includes('reakcji alergicznej') ||
    chief.includes('objaw√≥w reakcji alergicznej');

  if(isAllergicReaction){
    const templateAllergy =
`dolegliwo≈õci rozpoczƒô≈Çy siƒô dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ po kontakcie z potencjalnym alergenem w postaci leku / pokarmu / u≈ºƒÖdlenia owada / innego czynnika.
Od poczƒÖtku objaw√≥w obserwuje siƒô uog√≥lnionƒÖ wysypkƒô, ≈õwiƒÖd sk√≥ry oraz obrzƒôk w obrƒôbie twarzy, warg i jƒôzyka.
W wywiadzie alergia na ‚Ä¶‚Ä¶‚Ä¶ / brak znanych alergii.
W przesz≈Ço≈õci wystƒôpowa≈Çy / nie wystƒôpowa≈Çy podobne reakcje alergiczne.
Przed wystƒÖpieniem objaw√≥w pe≈Çni wydolny krƒÖ≈ºeniowo i oddechowo.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (alergia)
    if(!current.includes('potencjalnym alergenem') && !current.includes('uog√≥lnionƒÖ wysypkƒô')){
      box.value = current ? (current + '\n\n' + templateAllergy) : templateAllergy;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // ZABURZENIA NEUROLOGICZNE (podejrzenie udaru/TIA)
  const isNeuroDeficit =
    chief.includes('zaburze≈Ñ neurologicznych') ||
    chief.includes('podejrzenia udaru');

  if(isNeuroDeficit){
    const templateNeuro =
`objawy pojawi≈Çy siƒô nagle dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
Ostatni raz widziany/a zdrowy/a dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶
WystƒÖpi≈Ça asymetria twarzy, niedow≈Çad ko≈Ñczyny g√≥rnej i/lub dolnej po stronie prawej lub lewej oraz zaburzenia mowy w postaci afazji lub dyzartrii.
Nie zg≈Çasza urazu g≈Çowy.
Przed wystƒÖpieniem objaw√≥w pacjent by≈Ç w pe≈Çni samodzielny.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (neuro)
    if(!current.includes('Ostatni raz widziany') && !current.includes('asymetria twarzy')){
      box.value = current ? (current + '\n\n' + templateNeuro) : templateNeuro;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
 // ZATRUCIE DYMEM / INHALACJA DYMU
  const isSmokeInhalation =
    chief.includes('zatrucia dymem') ||
    chief.includes('inhalacji dymu');

  if(isSmokeInhalation){
    const templateSmoke =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ 
w wyniku nara≈ºenia na dym podczas po≈ºaru / zadymienia w pomieszczeniu / w poje≈∫dzie.
Czas ekspozycji na dym: ‚Ä¶‚Ä¶‚Ä¶
Miejsce zdarzenia: pomieszczenie zamkniƒôte / otwarta przestrze≈Ñ.
Pacjent przebywa≈Ç w strefie silnego zadymienia.
Utrata przytomno≈õci na miejscu zdarzenia.
Ewakuacja: samodzielna / z pomocƒÖ / nie pamiƒôta przebiegu zdarzenia.

Obecno≈õƒá sadzy w jamie ustnej lub nosie, nadpalone w≈Çosy brwi/nosa.
Oparzenia twarzy lub jamy ustnej.
Trudno≈õci w po≈Çykaniu / ≈õlinotok / stridor.

W wywiadzie choroby uk≈Çadu oddechowego (astma / POChP).`;

    const current = (box.value || '').trim();
    // anty-duplikacja (dym)
    if(!current.includes('nara≈ºenia na dym') && !current.includes('silnego zadymienia')){
      box.value = current ? (current + '\n\n' + templateSmoke) : templateSmoke;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NA≈öWIETLENIE OCZU / URAZ SPAWALNICZY (UV)
  const isEyeUVExposure =
    chief.includes('na≈õwietlenia oczu') ||
    chief.includes('oparzenia oczu promieniami uv');

  if(isEyeUVExposure){
    const templateEyeUV =
`do zdarzenia dosz≈Ço dnia ‚Ä¶‚Ä¶‚Ä¶ o godzinie ‚Ä¶‚Ä¶‚Ä¶ w wyniku ekspozycji oczu na intensywne ≈õwiat≈Ço (≈Çuk spawalniczy / promieniowanie UV).
Pacjent wykonywa≈Ç pracƒô spawalniczƒÖ / przebywa≈Ç w pobli≈ºu spawania.
Stosowanie ochrony oczu: brak / nieprawid≈Çowe / prawid≈Çowe.
Czas ekspozycji: 
Obecnie uczucie piasku pod powiekƒÖ.
Nie zg≈Çasza urazu mechanicznego oka ani kontaktu z substancjami chemicznymi.
Pacjent nie nosi / nosi soczewki kontaktowe.
W wywiadzie brak chor√≥b okulistycznych / stwierdza siƒô choroby okulistyczne.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (UV)
    if(!current.includes('≈Çuk spawalniczy') && !current.includes('≈õwiat≈Çowstrƒôt')){
      box.value = current ? (current + '\n\n' + templateEyeUV) : templateEyeUV;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }
  // NAPAD DNY MOCZANOWEJ
  const isGoutAttack =
    chief.includes('napadu dny moczanowej') ||
    chief.includes('b√≥lu palucha');

  if(isGoutAttack){
    const templateGout =
`dolegliwo≈õci od ‚Ä¶..
Silny b√≥l dotyczy jednego stawu, najczƒô≈õciej stawu ≈õr√≥dstopno-paliczkowego palucha / stawu skokowego / kolanowego / innego.
B√≥l o charakterze ostry, nasilajƒÖcy siƒô przy dotyku i ruchu.
Pacjent zg≈Çasza znaczne ograniczenie ruchomo≈õci ko≈Ñczyny w stawie.

W wywiadzie dna moczanowa rozpoznana / brak wcze≈õniejszego rozpoznania.
Podobny b√≥l wystƒôpowa≈Ç w przesz≈Ço≈õci./ Pierwszorazowy epizod.
Czynniki wyzwalajƒÖce: spo≈ºycie alkoholu / obfity posi≈Çek bogaty w puryny / odwodnienie / uraz / infekcja.`;

    const current = (box.value || '').trim();
    // anty-duplikacja (dna)
    if(!current.includes('dny moczanowej') && !current.includes('podagra')){
      box.value = current ? (current + '\n\n' + templateGout) : templateGout;
      box.focus();
      box.setSelectionRange(box.value.length, box.value.length);
    }
  }









  // ===== KONIEC BLOKU: KOLEJNE POWODY  (TU PRZYJDƒÑ NASTƒòPNE) =====

if(isEyeForeignBody || isNoseForeignBody || isEsophagusForeignBody || isRectalForeignBody || isGenitalTractForeignBody || isEpigastricPain || isMesogastricPain || isLowerAbdPain || isAbdominalPain || isHernia || isBowelObstruction || isGIBleeding || isRenalColic || isRLQPain || isPregnancyAbdPain || isCatheterObstruction || isUrinaryRetention || isNephrostomyIssue || isHematuria || isChronicConstipation || isAnalPain || isTesticularPain || isTesticularTrauma || isRibTrauma || isLowerLimbPain || isThermalBurn || isChemicalBurn || isElectricShock || isWoundForeignBody || isPostOpWoundBleeding || isPostOpComplications || isSelfHarmWounds || isNailPuncture || isAbscessBoil || isBiteWound || isTachyBrady || isPalpitations || isBloodPressureSwings || isHeadache || isDizziness || isChestPain || isChestPainWithMovement || isDyspneaExertionalProgressive || isNauseaVomiting || isDiarrhea || isHemoptysis || isEpistaxis || isSyncopeLOC || isInfection || isGeneralWeakness || isParesthesia || isAlteredMentalStatus || isSeizure || isEthanolIntox || isDrugIntox || isAnemiaWeakness || isChokingEpisode || isEyeInjury
 || isAbdominalInjury || isGeneralInjury || isWound || isPenileInjury || isForeignBodyEar
 || isNoseInjury || isAllergicReaction || isNeuroDeficit  || isSmokeInhalation || isEyeUVExposure || isGoutAttack
){
  updateSummary?.();
}
}

// ===== KROK 4: szybkie podpowiedzi objaw√≥w (nad accordionem) =====

function clearSuggestedMarks(){
  document.querySelectorAll('.symp-row.suggested')
    .forEach(r => r.classList.remove('suggested'));
}

function renderQuickSuggested(labels){
  const wrap = document.getElementById('sympQuickWrap');
  const box  = document.getElementById('sympQuick');
  if(!wrap || !box) return;

  box.innerHTML = '';

  const seen = new Set();
  const items = [];

  labels.forEach(label=>{
    const key = canonOrSyn(label);
    if(seen.has(key)) return;                 // brak duplikat√≥w
    const hit = SYM_INDEX.get(key);
    if(!hit) return;                          // nie dodajemy nowych objaw√≥w
    seen.add(key);
    items.push({ label, key, hit });
  });

  if(!items.length){
    wrap.hidden = true;
    return;
  }

  items.forEach(({label, hit}, idx)=>{
    const row = hit.row;

    // PRAWDZIWE kontrolki z docelowego objawu
    const realYes  = row.querySelector('input[type="radio"][value="yes"]');
    const realNo   = row.querySelector('input[type="radio"][value="no"]');
    const realNote = row.querySelector('[data-note]') || row.querySelector('.symp-note');

    // unikalna nazwa radio w quick
    const quickName = `q_${idx}_${Math.random().toString(16).slice(2)}`;

    const q = document.createElement('div');
    q.className = 'symp-qrow';
    q.innerHTML = `
      <div class="symp-qname">
        ${label}
        ${hit.subName ? `<small>${hit.subName}</small>` : ``}
      </div>

      <label class="symp-qopt">
        <input type="radio" name="${quickName}" value="yes">
        Wystƒôpuje
      </label>

      <label class="symp-qopt">
        <input type="radio" name="${quickName}" value="no">
        Neguje
      </label>

      <input class="symp-qnote" type="text" placeholder="Notatka (opcjonalnie)">
    `;

    const qYes  = q.querySelector(`input[value="yes"]`);
    const qNo   = q.querySelector(`input[value="no"]`);
    const qNote = q.querySelector('.symp-qnote');

    // --- synchronizacja quick ‚Üê real ---
    const syncFromReal = ()=>{
      if(realYes?.checked) qYes.checked = true;
      else if(realNo?.checked) qNo.checked = true;
      else { qYes.checked = false; qNo.checked = false; }

      qNote.value = realNote ? (realNote.value || '') : '';
      qNote.disabled = !!realNo?.checked;
    };

    syncFromReal();

    // --- quick ‚Üí real ---
    const commit = (mode)=>{
      if(mode === 'yes' && realYes){
        realYes.checked = true;
        realYes.dispatchEvent(new Event('change', { bubbles:true }));
      }
      if(mode === 'no' && realNo){
        realNo.checked = true;
        realNo.dispatchEvent(new Event('change', { bubbles:true }));
      }

      if(mode === 'no' && realNote){
        realNote.value = '';
        realNote.dispatchEvent(new Event('input', { bubbles:true }));
      }

      row.classList.add('suggested');
      syncFromReal();
      updateSummary?.();
    };

    qYes.addEventListener('change', ()=> qYes.checked && commit('yes'));
    qNo.addEventListener('change',  ()=> qNo.checked  && commit('no'));

    qNote.addEventListener('input', ()=>{
      if(!realNote) return;
      realNote.value = qNote.value;
      realNote.dispatchEvent(new Event('input', { bubbles:true }));
      updateSummary?.();
    });

    // je≈ºeli realny objaw zmieni siƒô gdzie indziej ‚Üí quick siƒô aktualizuje
    realYes?.addEventListener('change', syncFromReal);
    realNo?.addEventListener('change',  syncFromReal);
    realNote?.addEventListener('input', syncFromReal);

    box.appendChild(q);
  });

  wrap.hidden = false;
}

function openSymptomsAccordion(){
  const btn = $('sympToggle');
  const panel = $('sympPanel');
  if(!btn || !panel) return;

  if(btn.getAttribute('aria-expanded') !== 'true'){
    btn.setAttribute('aria-expanded', 'true');
    panel.hidden = false;
  }
}


// --- OBJAWY: kanonizacja + synonimy (≈ºeby nie dublowaƒá znacze≈Ñ) ---
function canonSymLabel(s){
  return normalizeTxt(String(s || ''))
    .replace(/[‚Äû‚Äù"']/g,'')
    .replace(/\s+/g,' ')
    .trim();
}

// tu wpisujesz znaczeniowe duplikaty -> jeden kanon
const SYM_SYNONYMS = {
  'uczucie piasku pod powieka': 'uczucie ‚Äûpiasku‚Äù pod powiekƒÖ',
  'uczucie piasku pod powiekƒÖ': 'uczucie ‚Äûpiasku‚Äù pod powiekƒÖ',
  'zaczerwienienie oka': 'zaczerwienienie oka',
  'bol oka': 'b√≥l oka',
  'bol glowy': 'b√≥l g≈Çowy',
  'pogorszenie widzenia': 'pogorszenie ostro≈õci widzenia',
  'pogorszenie ostrosci widzenia': 'pogorszenie ostro≈õci widzenia',
};

function canonOrSyn(label){
  const c = canonSymLabel(label);
  return SYM_SYNONYMS[c] ? canonSymLabel(SYM_SYNONYMS[c]) : c;
}
function filterSymptoms(query){
  const q = canonSymLabel(query || '');
  const rows = Array.from(document.querySelectorAll('.symp-row[data-label]'));

  if(!q){
    rows.forEach(r => r.style.display = '');
    return;
  }

  rows.forEach(r => {
    const lab = r.getAttribute('data-label') || '';
    const key = canonOrSyn(lab);
    r.style.display = key.includes(q) ? '' : 'none';
  });

  // przy wyszukiwaniu ma sens otworzyƒá sekcjƒô objaw√≥w
  openSymptomsAccordion();
}

// --- OBJAWY: indeks (label -> gdzie jest w DOM) ---
let SYM_INDEX = new Map();

function buildSymptomsIndex(){
  SYM_INDEX = new Map();
  const rows = Array.from(document.querySelectorAll('.symp-row[data-label]'));

  rows.forEach(row=>{
    const raw = row.getAttribute('data-label') || '';
    const key = canonOrSyn(raw);

    // ustal ≈õcie≈ºkƒô: podsekcja (data-subpanel) i jej nazwa z nag≈Ç√≥wka
    const subPanel = row.closest('.sub-acc-panel') || null;
    const subKey = subPanel ? subPanel.getAttribute('data-subpanel') : '';
    const subBtn = subKey ? document.querySelector(`.sub-acc-btn[data-subacc="${subKey}"]`) : null;
    const subName = subBtn ? (subBtn.textContent || '').trim() : '';

    if(!SYM_INDEX.has(key)){
      SYM_INDEX.set(key, { row, subKey, subName, subBtn });
    } else {
      // je≈õli masz duplikat w HTML, nie wysypujemy appki ‚Äî tylko ostrzegamy
      console.warn('Duplikat objawu (data-label) dla:', raw, '->', key, row);
    }
  });
}


// odpalaj sugestie przy wpisywaniu powodu zg≈Çoszenia
on('chief','input', suggestSymptomsFromChief);

on('chief','change', suggestSymptomsFromChief);

// REQUIRED: sprawdzaj na bie≈ºƒÖco
['age','sex','chief'].forEach(id => {
  on(id,'input',  validateRequiredFields);
  on(id,'change', validateRequiredFields);
});
document.addEventListener('DOMContentLoaded', validateRequiredFields);

// na starcie
document.addEventListener('DOMContentLoaded', suggestSymptomsFromChief);

on('chief','input', applyChiefInterviewAutofill);
on('chief','change', applyChiefInterviewAutofill);
document.addEventListener('DOMContentLoaded', applyChiefInterviewAutofill);
document.addEventListener('DOMContentLoaded', buildSymptomsIndex);
on('sympSearch','input', (e) => filterSymptoms(e.target.value));
document.addEventListener('DOMContentLoaded', () => filterSymptoms(''));


// (opcjonalnie) te≈º przy wpisywaniu / klikaniu (czasem select odpala input)
on('avpu', 'change', () => { syncAvpuEffects(); updateSummary(); });


// ===== PESEL -> data ur. / wiek / p≈Çeƒá =====
function parsePesel(peselRaw){
  const pesel = (peselRaw || '').replace(/\D/g, '');
  if(pesel.length !== 11) return null;

  // prosta walidacja sumy kontrolnej (≈ºeby nie liczyƒá ≈õmieci)
  const w = [1,3,7,9,1,3,7,9,1,3];
  let sum = 0;
  for(let i=0;i<10;i++) sum += w[i] * parseInt(pesel[i],10);
  const ctrl = (10 - (sum % 10)) % 10;
  if(ctrl !== parseInt(pesel[10],10)) return null;

  let yy = parseInt(pesel.slice(0,2),10);
  let mm = parseInt(pesel.slice(2,4),10);
  let dd = parseInt(pesel.slice(4,6),10);

  // miesiƒÖc koduje stulecie:
  // 1900-1999: 01-12
  // 2000-2099: 21-32
  // 2100-2199: 41-52
  // 2200-2299: 61-72
  // 1800-1899: 81-92
  let century = 1900;
  if(mm >= 81 && mm <= 92){ century = 1800; mm -= 80; }
  else if(mm >= 61 && mm <= 72){ century = 2200; mm -= 60; }
  else if(mm >= 41 && mm <= 52){ century = 2100; mm -= 40; }
  else if(mm >= 21 && mm <= 32){ century = 2000; mm -= 20; }

  const year = century + yy;

  // p≈Çeƒá: 10. cyfra PESEL (index 9) -> parzysta K, nieparzysta M
  const sexDigit = parseInt(pesel[9],10);
  const sex = (sexDigit % 2 === 0) ? 'K' : 'M';

  // sprawd≈∫ czy data jest sensowna
  const dob = new Date(year, mm-1, dd);
  if(dob.getFullYear() !== year || (dob.getMonth()+1) !== mm || dob.getDate() !== dd) return null;

  return { year, month:mm, day:dd, sex, dob };
}

function calcAgeFromDob(dob){
  const today = new Date();
  let age = today.getFullYear() - dob.getFullYear();
  const m = today.getMonth() - dob.getMonth();
  if(m < 0 || (m === 0 && today.getDate() < dob.getDate())) age--;
  return age;
}

function pad2(n){ return String(n).padStart(2,'0'); }

function applyPeselAutofill(){
  const peselVal = $('pesel')?.value || '';
  const parsed = parsePesel(peselVal);

  // je≈õli PESEL niepoprawny albo niepe≈Çny -> nic nie nadpisujemy
  if(!parsed) return;

  // ustaw p≈Çeƒá tylko je≈õli pusta albo user nie wybra≈Ç
  if($('sex') && !$('sex').value) $('sex').value = parsed.sex;

  // ustaw datƒô urodzenia (format dd-mm-rrrr) tylko je≈õli pusta
  if($('dob') && !$('dob').value){
    $('dob').value = `${pad2(parsed.day)}-${pad2(parsed.month)}-${parsed.year}`;
  }

  // ustaw wiek tylko je≈õli pusty
  if($('age') && !$('age').value){
    $('age').value = String(calcAgeFromDob(parsed.dob));
  }
}

// uruchamiaj autofill podczas wpisywania PESEL
on('pesel','input', () => {
  applyPeselAutofill();
  validateRequiredFields();
  updateSummary();
});
on('pesel','change', () => {
  applyPeselAutofill();
  validateRequiredFields();
  updateSummary();
});


// ===== UNIWERSALNY ACCORDION =====
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.acc-btn[data-acc]');
  if(!btn) return;

  const key = btn.getAttribute('data-acc');
  const panel = document.querySelector(`.acc-panel[data-panel="${key}"]`);
  if(!panel) return;

  const isOpen = btn.getAttribute('aria-expanded') === 'true';
  btn.setAttribute('aria-expanded', String(!isOpen));
  panel.hidden = isOpen;
});

// ===== SEKCJA SUICYDALNA ‚Äì accordion =====
on('suicideToggle','click', () => {
  const btn = $('suicideToggle');
  const panel = $('suicidePanel');
  if(!btn || !panel) return;
  const open = btn.getAttribute('aria-expanded') === 'true';
  btn.setAttribute('aria-expanded', String(!open));
  panel.hidden = open;
});

function syncSuicTendenciesNote(){
  const no = $('suic_tendencies_no')?.checked;
  const worse = $('suic_tendencies_worse')?.checked;
  const note = $('suic_tendencies_note');
  if(!note) return;

  if(no || worse){
    note.disabled = false;
  } else {
    note.value = '';
    note.disabled = true;
  }
}

function syncSuicBehaviorNote(){
  const any =
    $('suic_behavior_no')?.checked ||
    $('suic_attempts')?.checked ||
    $('suic_selfharm')?.checked ||
    $('suic_impulsive')?.checked ||
    $('suic_preparation')?.checked ||
    $('suic_current')?.checked;

  const note = $('suic_behavior_note');
  if(!note) return;

  if(any){
    note.disabled = false;
  } else {
    note.value = '';
    note.disabled = true;
  }
}

function syncPsychCareNote(){
  const any =
    $('psych_treated_psychiatry')?.checked ||
    $('psych_med_adherent')?.checked ||
    $('psych_not_treated')?.checked ||
    $('psych_psychologist')?.checked;

  const note = $('psych_care_note');
  if(!note) return;

  if(any){
    note.disabled = false;
  } else {
    note.value = '';
    note.disabled = true;
  }
}

// ===== LOGIKA: notatka tylko gdy sƒÖ my≈õli S =====
function syncSuicThoughtsNote(){
  const yes = $('suic_thoughts_yes')?.checked;
  const resign = $('suic_thoughts_resign')?.checked;
  const note = $('suic_thoughts_note');

  if(!note) return;

  if(yes || resign){
    note.disabled = false;
  } else {
    note.value = '';
    note.disabled = true;
  }
}

// ===== WYKLUCZENIA LOGICZNE =====
function bindExclusiveGroup(a, b){
  on(a,'change', () => { if($(a)?.checked) $(b).checked = false; });
  on(b,'change', () => { if($(b)?.checked) $(a).checked = false; });
}

// my≈õli
bindExclusiveGroup('suic_thoughts_no','suic_thoughts_yes');
bindExclusiveGroup('suic_thoughts_no','suic_thoughts_resign');

// tendencje
bindExclusiveGroup('suic_tendencies_no','suic_tendencies_worse');

on('psych_not_treated', 'change', () => {
  if($('psych_not_treated')?.checked){
    $('psych_med_adherent').checked = false;
  }
});

// zachowania
bindExclusiveGroup('suic_behavior_no','suic_attempts');
bindExclusiveGroup('suic_behavior_no','suic_selfharm');
bindExclusiveGroup('suic_behavior_no','suic_preparation');
bindExclusiveGroup('suic_behavior_no','suic_current');
bindExclusiveGroup('suic_behavior_no','suic_impulsive');
bindExclusiveGroup('psych_treated_psychiatry','psych_not_treated');

// notatka
['suic_thoughts_yes','suic_thoughts_resign','suic_thoughts_no']
  .forEach(id => on(id,'change', syncSuicThoughtsNote));

['suic_tendencies_no','suic_tendencies_worse']
  .forEach(id => on(id,'change', () => { syncSuicTendenciesNote(); updateSummary(); }));

['suic_behavior_no','suic_attempts','suic_selfharm','suic_impulsive','suic_preparation','suic_current']
  .forEach(id => on(id,'change', () => { syncSuicBehaviorNote(); updateSummary(); }));

['psych_treated_psychiatry','psych_med_adherent','psych_not_treated','psych_psychologist']
  .forEach(id => on(id,'change', () => { syncPsychCareNote(); updateSummary(); }));

['suic_tendencies_note','suic_behavior_note','psych_care_note']
  .forEach(id => on(id,'input', updateSummary));


// ===== CZAS TRIAGE (nag≈Ç√≥wek) =====
// Data: ustawiana przy starcie strony
// Start: przy pierwszym wpisie w dowolne pole
// Koniec: po klikniƒôciu "Aktualizuj podsumowanie" (btn_summary)

let TRIAGE_START_TS = null;
let TRIAGE_END_TS = null;

function fmtTime(d){
  return d.toLocaleTimeString('pl-PL', { hour12:false });
}

function setTriageDate(){
  const el = $('triageDate');
  if(el) el.textContent = new Date().toLocaleDateString('pl-PL');
}

function setStartIfNeeded(){
  if(TRIAGE_START_TS) return;
  TRIAGE_START_TS = new Date();
  const el = $('triageStart');
  if(el) el.textContent = fmtTime(TRIAGE_START_TS);
}

function setEndNow(){
  if(!TRIAGE_START_TS) setStartIfNeeded();
  TRIAGE_END_TS = new Date();
  const el = $('triageEnd');
  if(el) el.textContent = fmtTime(TRIAGE_END_TS);
}

// ustaw datƒô od razu po za≈Çadowaniu
setTriageDate();

// start liczymy od pierwszego "input" w dowolne pole formularza
document.addEventListener('input', (e) => {
  const t = e.target;
  if(!t) return;
  if(t.matches('input, select, textarea')) setStartIfNeeded();
});

// koniec liczymy po klikniƒôciu podsumowania
on('btn_summary','click', () => {
  setEndNow();
});

  // Normy (uproszczone)
function parseBP(bpStr){
  const m = (bpStr||'').match(/(\d{2,3})\s*\/\s*(\d{2,3})/);
  if(!m) return null;
  return {sys: +m[1], dia:+m[2]};
}

function isOutOfRangeVitals(){
  let out = 0;

  const bp = parseBP($('bp')?.value || '');
  if(bp){
    // uproszczone wide≈Çki
    if(bp.sys < 90 || bp.sys > 165) out++;
    if(bp.dia < 50 || bp.dia > 110) out++;
  }

  const hrRaw = $('hr')?.value;
  const hr = Number(hrRaw);
  if(hrRaw && !Number.isNaN(hr)){
    if(hr < 50 || hr > 120) out++;
  }

  const spo2Raw = $('spo2')?.value;
  const spo2 = Number(spo2Raw);
  if(spo2Raw && !Number.isNaN(spo2)){
    if(spo2 < 92) out++;
  }

  const tempRaw = ($('temp')?.value || '').trim();
  const temp = parseFloat(tempRaw.replace(',','.'));
  if(tempRaw && !Number.isNaN(temp)){
    if(temp < 35.0 || temp >= 38.5) out++;
  }

  const gluRaw = $('glucose')?.value;
  const glu = Number(gluRaw);
  if(gluRaw && !Number.isNaN(glu)){
    if(glu < 70 || glu > 180) out++;
  }

  return out; // liczba parametr√≥w poza normƒÖ
}

// ===== Pod≈õwietlanie parametr√≥w poza normƒÖ (klasa .warn) =====
function setWarn(id, on){
  const el = $(id);
  if(!el) return;
  el.classList.toggle('warn', !!on);
}

function highlightVitals(){
  // RR
  const bpStr = $('bp')?.value || '';
  const bp = parseBP(bpStr);
  if(bp){
    const bad = (bp.sys < 90 || bp.sys > 165 || bp.dia < 50 || bp.dia > 110);
    setWarn('bp', bad);
  } else {
    setWarn('bp', false);
  }

  // HR
  const hrRaw = $('hr')?.value;
  const hr = Number(hrRaw);
  if(hrRaw && !Number.isNaN(hr)){
    setWarn('hr', (hr < 50 || hr > 120));
  } else {
    setWarn('hr', false);
  }

  // SpO2
  const spo2Raw = $('spo2')?.value;
  const spo2 = Number(spo2Raw);
  if(spo2Raw && !Number.isNaN(spo2)){
    setWarn('spo2', (spo2 < 92));
  } else {
    setWarn('spo2', false);
  }

  // Temp
  const tempRaw = ($('temp')?.value || '').trim();
  const temp = parseFloat(tempRaw.replace(',','.'));
  if(tempRaw && !Number.isNaN(temp)){
    setWarn('temp', (temp < 35.0 || temp >= 38.5));
  } else {
    setWarn('temp', false);
  }

  // Glukoza
  const gluRaw = $('glucose')?.value;
  const glu = Number(gluRaw);
  if(gluRaw && !Number.isNaN(glu)){
    setWarn('glucose', (glu < 70 || glu > 180));
  } else {
    setWarn('glucose', false);
  }
}





  // -------- Objawy: accordion --------
  on('sympToggle','click', () => {
    const btn = $('sympToggle');
    const panel = $('sympPanel');
    if(!btn || !panel) return;
    const isOpen = btn.getAttribute('aria-expanded') === 'true';
    btn.setAttribute('aria-expanded', String(!isOpen));
    panel.hidden = isOpen;
  });

// -------- Badanie: accordion --------
on('examToggle','click', () => {
  const btn = $('examToggle');
  const panel = $('examPanel');
  if(!btn || !panel) return;
  const isOpen = btn.getAttribute('aria-expanded') === 'true';
  btn.setAttribute('aria-expanded', String(!isOpen));
  panel.hidden = isOpen;
});


// ===== Objawy: PODKATEGORIE (sub-accordion) =====
document.addEventListener('click', (e) => {
  const btn = e.target?.closest?.('.sub-acc-btn');
  if(!btn) return;

  const key = btn.getAttribute('data-subacc');
  if(!key) return;

  const panel = document.querySelector(`.sub-acc-panel[data-subpanel="${key}"]`);
  if(!panel) return;

  const isOpen = btn.getAttribute('aria-expanded') === 'true';
  btn.setAttribute('aria-expanded', String(!isOpen));
  panel.hidden = isOpen;
});

// ===== Objawy: po "Neguje" czy≈õƒá + wy≈ÇƒÖcz notatkƒô/select =====
document.addEventListener('change', (e) => {
  const radio = e.target;
  if (!(radio instanceof HTMLInputElement)) return;
  if (radio.type !== 'radio') return;
  if (radio.value !== 'yes' && radio.value !== 'no') return;

  const row = radio.closest('.symp-row');
  if (!row) return;

  const noteEl = row.querySelector('[data-note]');
  const selEl  = row.querySelector('[data-select]');

  const isNegated = (radio.value === 'no');

  const setDisabled = (el, disabled) => {
    if (!el) return;
    el.disabled = disabled;
    if (disabled) {
      if (el.tagName === 'SELECT') el.value = '';
      if (el.tagName === 'INPUT' || el.tagName === 'TEXTAREA') el.value = '';
    }
  };

  setDisabled(selEl, isNegated);
  setDisabled(noteEl, isNegated);
});

// ===== BADANIE NEURO: sztywno≈õƒá karku ‚Äì aktywacja notatki =====
function syncNeckStiffNote(){
  const cb = $('exam_neck_stiff');
  const note = $('exam_neck_stiff_note');
  if(!cb || !note) return;

  note.disabled = !cb.checked;
  if(!cb.checked) note.value = '';
}

on('exam_neck_stiff','change', () => {
  syncNeckStiffNote();
  updateSummary();
});

document.addEventListener('DOMContentLoaded', syncNeckStiffNote);


// ===== BADANIE KRƒÑ≈ªENIE: logika wzajemnego wykluczania =====
function bindExclusive(a, b){
  on(a,'change', () => { if($(a)?.checked) $(b).checked = false; });
  on(b,'change', () => { if($(b)?.checked) $(a).checked = false; });
}

bindExclusive('exam_hr_regular','exam_hr_irregular');
bindExclusive('exam_crt_lt2','exam_crt_gt2');
bindExclusive('exam_resp_cough_dry','exam_resp_cough_wet');
bindExclusive('exam_abd_soft','exam_abd_hard');
bindExclusive('exam_abd_tender','exam_abd_nontender');
bindExclusive('exam_abd_no_tenderness','exam_abd_tender'); // jak ‚Äûbez bolesno≈õci‚Äù, to nie mo≈ºe byƒá ‚Äûbolesny‚Äù
bindExclusive('exam_cardio_eff_ok','exam_cardio_eff_fail');
bindExclusive('exam_resp_eff_ok','exam_resp_eff_fail');
bindExclusive('antykoncepcja_tak','antykoncepcja_nie');


// UK≈ÅAD MOCZOWY
bindExclusive('exam_uro_none','exam_uro_dysuria_pain');
bindExclusive('exam_uro_none','exam_uro_dysuria_burn');
bindExclusive('exam_uro_none','exam_uro_frequency');
bindExclusive('exam_uro_none','exam_uro_urgency');
bindExclusive('exam_uro_none','exam_uro_incontinence');
bindExclusive('exam_uro_none','exam_uro_oliguria');
bindExclusive('exam_uro_none','exam_uro_hematuria');

bindExclusive('exam_uro_genital_ok','exam_uro_genital_swelling');
bindExclusive('exam_uro_genital_ok','exam_uro_genital_tender');
bindExclusive('exam_uro_genital_ok','exam_uro_genital_redness');
bindExclusive('exam_uro_genital_ok','exam_uro_genital_discharge');
bindExclusive('exam_uro_genital_ok','exam_uro_genital_bleeding');


// UK≈ÅAD RUCHU / URAZ KO≈ÉCZYN
bindExclusive('exam_msk_ok','exam_msk_deformity');
bindExclusive('exam_msk_ok','exam_msk_swelling');
bindExclusive('exam_msk_ok','exam_msk_hematoma');
bindExclusive('exam_msk_ok','exam_msk_wounds');
bindExclusive('exam_msk_ok','exam_msk_shortening');

// MOTORYCZNO≈öƒÜ
bindExclusive('exam_mobility_independent','exam_mobility_aid');
bindExclusive('exam_mobility_independent','exam_mobility_wheelchair');
bindExclusive('exam_mobility_independent','exam_mobility_bedbound');
bindExclusive('exam_mobility_wheelchair','exam_mobility_bedbound');

// SK√ìRA ‚Äì kolor i wilgotno≈õƒá
bindExclusive('exam_skin_pink','exam_skin_pale');
bindExclusive('exam_skin_pink','exam_skin_cyanotic');
bindExclusive('exam_skin_pale','exam_skin_cyanotic');

bindExclusive('exam_skin_sweaty','exam_skin_dry');

// APETYT
bindExclusive('exam_appetite_normal','exam_appetite_decreased');
bindExclusive('exam_appetite_normal','exam_appetite_none');
bindExclusive('exam_appetite_normal','exam_appetite_disturbed');

bindExclusive('exam_appetite_none','exam_appetite_decreased');

// DIETY
bindExclusive('exam_diet_none','exam_diet_diabetic');
bindExclusive('exam_diet_none','exam_diet_lowsodium');
bindExclusive('exam_diet_none','exam_diet_glutenfree');
bindExclusive('exam_diet_none','exam_diet_vegetarian');
bindExclusive('exam_diet_none','exam_diet_vegan');
bindExclusive('exam_diet_none','exam_diet_highprotein');
bindExclusive('exam_diet_none','exam_diet_reduction');

// MASA CIA≈ÅA
bindExclusive('exam_weight_stable','exam_weight_loss');
bindExclusive('exam_weight_stable','exam_weight_gain');
bindExclusive('exam_weight_loss','exam_weight_gain');

// ODDAWANIE STOLCA
bindExclusive('exam_stool_regular','exam_stool_irregular');
bindExclusive('exam_stool_regular','exam_stool_constipation');
bindExclusive('exam_stool_regular','exam_stool_diarrhea');
bindExclusive('exam_stool_regular','exam_stool_alternating');
bindExclusive('exam_stool_regular','exam_stool_none');

bindExclusive('exam_stool_constipation','exam_stool_diarrhea');
bindExclusive('exam_stool_constipation','exam_stool_alternating');
bindExclusive('exam_stool_diarrhea','exam_stool_alternating');

bindExclusive('exam_stool_none','exam_stool_diarrhea');
bindExclusive('exam_stool_none','exam_stool_constipation');

// SEN
bindExclusive('exam_sleep_normal','exam_sleep_onset');
bindExclusive('exam_sleep_normal','exam_sleep_awakenings');
bindExclusive('exam_sleep_normal','exam_sleep_fragmented');
bindExclusive('exam_sleep_normal','exam_sleep_insomnia');
bindExclusive('exam_sleep_normal','exam_sleep_daytime_sleepiness');

bindExclusive('lmp_regular','lmp_irregular');

  // -------- Objawy -> tekst do wywiadu --------
  function getSymptomsText(sexVal){
    const rows = Array.from(document.querySelectorAll('.symp-row'));
    if(!rows.length) return { present: [], denied: [], text: '' };

    const present = [];
    const denied = [];

    rows.forEach(row => {
      const label = row.getAttribute('data-label')?.trim();
      if(!label) return;

      const yes = row.querySelector('input[type="radio"][value="yes"]');
      const no  = row.querySelector('input[type="radio"][value="no"]');
      const note = (row.querySelector('[data-note]')?.value || '').trim();

      if(yes && yes.checked){
        present.push(note ? `${label} (${note})` : label);
      } else if(no && no.checked){
        denied.push(label);
      }
    });

    let subject = 'Pacjent/ka';
    if(sexVal === 'M') subject = 'Pacjent';
    if(sexVal === 'K') subject = 'Pacjentka';

    const out = [];
    if(present.length){
      out.push(`${subject} zg≈Çasza: ${present.join('; ')}.`);
    }
    if(denied.length){
      out.push(`${subject} neguje wystƒÖpienie objaw√≥w: ${denied.join(', ')}.`);
    }

    return { present, denied, text: out.join('\n') };
  }
function getAdultGrammar(sexVal){
  return {
    subjectAdult:
      (sexVal === 'K') ? 'Pacjentka' :
      (sexVal === 'M') ? 'Pacjent' :
      'Pacjent/ka',

    relacjaAdult:
      (sexVal === 'K') ? 'pacjentki' :
      (sexVal === 'M') ? 'pacjenta' :
      'pacjenta/tki',

    broughtAdult:
      (sexVal === 'K') ? 'przywieziona' :
      (sexVal === 'M') ? 'przywieziony' :
      'przywieziony/a',

    byCaretakersAdult:
      (sexVal === 'K') ? 'przywieziona przez opiekuna/≈õwiadk√≥w' :
      (sexVal === 'M') ? 'przywieziony przez opiekuna/≈õwiadk√≥w' :
      'przywieziony/a przez opiekuna/≈õwiadk√≥w'
  };
}

  // -------- Podsumowanie (bezosobowe tam gdzie trzeba) --------
  function buildSummaryText(){
  const sexVal = $('sex')?.value || '';
  const grammar = getAdultGrammar(sexVal);
  const { subjectAdult, relacjaAdult, broughtAdult, byCaretakersAdult } = grammar;
  const chief = ($('chief')?.value || '').trim();

// ===== TRYB ZG≈ÅOSZENIA =====
const arrivalMode = getArrivalMode();
const arrivalNote = ($('arrival_note')?.value || '').trim();
const interviewGeneral = ($('interview_general')?.value || '').trim();

// ===== WYWIAD CHOROBOWY: zdrowy/nieleczony =====
const healthyNone = !!$('healthy_none')?.checked;
const interview_disease = healthyNone ? 'dotychczas zdrowy/nieleczony' : (($('interview_disease')?.value || '').trim());
const meds = ($('meds')?.value || '').trim();
const meds_prn = ($('meds_prn')?.value || '').trim();

// ===== ALERGIE: nie stwierdzono =====
const allergiesNone = !!$('allergies_none')?.checked;
const allergies = allergiesNone ? 'nie stwierdzono' : (($('allergies')?.value || '').trim());

  const substances = ($('substances')?.value || '').trim();
const familyHistory = ($('family_history')?.value || '').trim();
const familyFlag = document.querySelector('input[name="family_flag"]:checked')?.value || '';

function buildPsychSummary(){
  const who = (sexVal === 'K')
    ? 'Pacjentka'
    : (sexVal === 'M')
      ? 'Pacjent'
      : 'Pacjent/ka';

  const out = [];

  // MY≈öLI
  if($('suic_thoughts_no')?.checked){
    out.push(`${who} neguje my≈õli suicydalne.`);
  } else {
    const thoughts = [];
    if($('suic_thoughts_yes')?.checked) thoughts.push('przyznaje my≈õli "S"');
    if($('suic_thoughts_resign')?.checked) thoughts.push('zg≈Çasza my≈õli rezygnacyjne');

    if(thoughts.length){
      let txt = `${who} ` + thoughts.join(', ') + '.';
      const note = $('suic_thoughts_note')?.value?.trim();
      if(note) txt += ` (${note})`;
      out.push(txt);
    }
  }

  // TENDENCJE
if($('suic_tendencies_no')?.checked){
  let txt = 'Brak tendencji suicydalnych.';
  const note = $('suic_tendencies_note')?.value?.trim();
  if(note) txt += ` (${note})`;
  out.push(txt);
} else if($('suic_tendencies_worse')?.checked){
  let txt = 'NasilajƒÖce siƒô my≈õli w ostatnim czasie.';
  const note = $('suic_tendencies_note')?.value?.trim();
  if(note) txt += ` (${note})`;
  out.push(txt);
}

// ZACHOWANIA
if($('suic_behavior_no')?.checked){
  let txt = 'Brak zachowa≈Ñ suicydalnych.';
  const note = $('suic_behavior_note')?.value?.trim();
  if(note) txt += ` (${note})`;
  out.push(txt);
} else {
  const behaviors = [];
  if($('suic_attempts')?.checked) behaviors.push('przebyte pr√≥by samob√≥jcze');
  if($('suic_selfharm')?.checked) behaviors.push('samouszkodzenia');
  if($('suic_impulsive')?.checked) behaviors.push('dzia≈Çanie pod wp≈Çywem impulsu');
  if($('suic_preparation')?.checked) behaviors.push('przygotowania do pr√≥by');
  if($('suic_current')?.checked) behaviors.push('aktualne zamiary samob√≥jcze');

  if(behaviors.length){
    let txt = 'W wywiadzie: ' + behaviors.join(', ') + '.';
    const note = $('suic_behavior_note')?.value?.trim();
    if(note) txt += ` (${note})`;
    out.push(txt);
  }
}
// OPIEKA SPECJALISTYCZNA
const care = [];
if($('psych_treated_psychiatry')?.checked) care.push('leczony/a psychiatrycznie');
if($('psych_med_adherent')?.checked) care.push('stosuje zalecone leki');
if($('psych_not_treated')?.checked) care.push('nie leczony/a psychiatrycznie');
if($('psych_psychologist')?.checked) care.push('pod opiekƒÖ psychologa/psychoterapeuty');

if(care.length){
  let txt = 'Opieka: ' + care.join(', ') + '.';
  const note = $('psych_care_note')?.value?.trim();
  if(note) txt += ` (${note})`;
  out.push(txt);
}


  return out.join(' ');
}



  // Ocena
  const avpu = $('avpu')?.value || '';
  const verbal = $('verbal_contact')?.value || '';
  const general_state = $('general_state')?.value || '';
  const stability = $('stability')?.value || '';

  let subject = 'Pacjent/ka';
  if(sexVal === 'M') subject = 'Pacjent';
  if(sexVal === 'K') subject = 'Pacjentka';

  // ===== Objawy: listy present/denied =====
  const symp = getSymptomsText(sexVal); // zwraca {present, denied, text}

  // ===== Pominiƒôcie zaleconych lek√≥w =====
  const miss = [];
  if ($('miss_none')?.checked) {
    miss.push('neguje pominiƒôcie dawek lek√≥w');
  }
  if ($('miss_accidental')?.checked) {
    const note = ($('miss_accidental_note')?.value || '').trim();
    miss.push(note ? `przypadkowe pominiƒôcie dawkowania (${note})` : 'przypadkowe pominiƒôcie dawkowania');
  }
  if ($('miss_noncompliance')?.checked) {
    const note = ($('miss_noncompliance_note')?.value || '').trim();
    miss.push(note ? `niestosowanie siƒô do zalece≈Ñ lekarza (${note})` : 'niestosowanie siƒô do zalece≈Ñ lekarza');
  }

  
  // ===== Budowa tekstu EXACT jak chcesz =====
  const lines = [];
// Tryb zg≈Çoszenia (linia przed powodem)
let arrivalTxt = '‚Äî';
if(arrivalMode === 'zrm') arrivalTxt = 'przywieziony przez ZRM';
if(arrivalMode === 'self') arrivalTxt = 'zg≈Çasza siƒô samodzielnie';
if(arrivalMode === 'referral') arrivalTxt = 'zg≈Çasza siƒô ze skierowaniem';

// notatkƒô w nawiasie dok≈Çadamy tylko wtedy, gdy to MA SENS (np. skierowanie / inne ≈∫r√≥d≈Ço)
// przy "zg≈Çasza siƒô samodzielnie" NIE DOKLEJAMY nawiasu
if (arrivalTxt !== '‚Äî' && arrivalNote) {
  if (arrivalMode !== 'self') {
    arrivalTxt += ` (${arrivalNote})`;
  }
} else if (arrivalTxt === '‚Äî' && arrivalNote) {
  arrivalTxt = arrivalNote; // jak kto≈õ wpisa≈Ç rƒôcznie bez zaznaczania
}



  // Dane podstawowe do pierwszych linijek
  const age = (($('age')?.value || '').trim());
  const reason = chief; // pow√≥d zg≈Çoszenia jest w "chief" na poczƒÖtku funkcji

  const generalInterviewTxt = interviewGeneral; // masz to ju≈º wcze≈õniej w funkcji
  const symptomsPosText = symp.present?.length ? symp.present.join('; ') : '';
  const symptomsNegText = symp.denied?.length ? symp.denied.join(', ') : '';

  // 1) + 2) Pierwsze linie PODSUMOWANIA (doros≈Çy vs dziecko < 14 r.≈º.)
const ageNum = parseInt(age, 10);
const isChild = !Number.isNaN(ageNum) && ageNum < 14;

// AVPU lub kontakt nielogiczny
const isImpaired =
  avpu === 'V' ||
  avpu === 'P' ||
  avpu === 'U' ||
  verbal === 'nielogiczny';

// spos√≥b zg≈Çoszenia
const arrivalLower = (arrivalTxt || '').toLowerCase();
const isZRM = arrivalLower.includes('zrm');
const isReferral = arrivalLower.includes('skier');

// ≈∫r√≥d≈Ço skierowania (je≈õli pole istnieje)
const referralSource = (arrivalMode === 'referral' && arrivalNote) ? arrivalNote : '';

if (isChild) {
  const childSex =
    (sexVal === 'M') ? 'ch≈Çopiec' :
    (sexVal === 'K') ? 'dziewczynka' :
    'dziecko';

  const broughtWordChild =
    (sexVal === 'K') ? 'przywieziona' :
    (sexVal === 'M') ? 'przywieziony' :
    'przywieziony/a';

  let firstLine = '';

  // PRIORYTET: ZRM > AVPU > skierowanie > standard
  if (isZRM) {
    firstLine = `Dziecko (${childSex}) lat: ${ageNum} ${broughtWordChild} przez ZRM z powodu: ${reason || '‚Äî'}`;
  } else if (isImpaired) {
    firstLine = `Dziecko (${childSex}) lat: ${ageNum} ${broughtWordChild} przez opiekuna/≈õwiadk√≥w z powodu: ${reason || '‚Äî'}`;
  } else if (isReferral) {
    firstLine = `Dziecko (${childSex}) lat: ${ageNum} zg≈Çasza siƒô ze skierowaniem${referralSource ? ` (${referralSource})` : ''} z powodu: ${reason || '‚Äî'}`;
  } else {
    firstLine = `Dziecko (${childSex}) lat: ${ageNum} zg≈Çasza siƒô z rodzicem/opiekunem z powodu: ${reason || '‚Äî'}`;
  }

  lines.push(firstLine);
  lines.push('Badanie i wywiad w obecno≈õci rodzica/opiekuna.');

  if (generalInterviewTxt) {
    lines.push(`Z wywiadu: ${generalInterviewTxt}`);
const psych = buildPsychSummary();
if (psych) lines.push(`Stan psychiczny: ${psych}`);

  }

} else {
  // DOROS≈ÅY ‚Äì priorytet: ZRM > AVPU > skierowanie > standard
  let firstLine = '';

  if (isZRM) {
    firstLine = `${subjectAdult} lat: ${age || '‚Äî'} ${broughtAdult} przez ZRM z powodu: ${reason || '‚Äî'}`;
    lines.push(firstLine);
    if (generalInterviewTxt) lines.push(`Z wywiadu: ${generalInterviewTxt}`);
const psych = buildPsychSummary();
if (psych) lines.push(`Stan psychiczny: ${psych}`);


  } else if (isImpaired) {
    firstLine = `${subjectAdult} lat: ${age || '‚Äî'} ${byCaretakersAdult} z powodu: ${reason || '‚Äî'}`;
    lines.push(firstLine);
    if (generalInterviewTxt) lines.push(`Z wywiadu: ${generalInterviewTxt}`);
const psych = buildPsychSummary();
if (psych) lines.push(`Stan psychiczny: ${psych}`);


  } else if (isReferral) {
    firstLine = `${subject} lat: ${age || '‚Äî'} zg≈Çasza siƒô ze skierowaniem${referralSource ? ` (${referralSource})` : ''} z powodu: ${reason || '‚Äî'}`;
    lines.push(firstLine);
    if (generalInterviewTxt) lines.push(`Z relacji ${sexVal === 'K' ? 'pacjentki' : sexVal === 'M' ? 'pacjenta' : 'pacjenta/tki'}: ${generalInterviewTxt}`);const psych = buildPsychSummary();
if (psych) lines.push(`Stan psychiczny: ${psych}`);


  } else {
    firstLine = `${subject} lat: ${age || '‚Äî'} zg≈Çasza siƒô z powodu: ${reason || '‚Äî'}`;
    lines.push(firstLine);
    if (generalInterviewTxt) lines.push(`Z relacji ${sexVal === 'K' ? 'pacjentki' : sexVal === 'M' ? 'pacjenta' : 'pacjenta/tki'}: ${generalInterviewTxt}`);
const psych = buildPsychSummary();
if (psych) lines.push(`Stan psychiczny: ${psych}`);

  }

}


  // Objawy (dla dziecka i doros≈Çego tak samo)
  if (symptomsPosText) lines.push(`Dodatkowo zg≈Çasza dolegliwo≈õci: ${symptomsPosText}`);
  if (symptomsNegText) lines.push(`Neguje wystƒôpowanie objaw√≥w takich jak: ${symptomsNegText}`);
  // Przerwa miƒôdzy blokami tylko je≈õli co≈õ powy≈ºej istnieje
  if (isChild || generalInterviewTxt || symptomsPosText || symptomsNegText) lines.push('');

// 3) Wywiady i leki (tylko je≈õli sƒÖ)
if (interview_disease) lines.push(`Wywiad chorobowy: ${interview_disease}`);

if (familyFlag) {
  lines.push(`Wywiad rodzinny: ${familyFlag}`);
} else if (familyHistory) {
  lines.push(`Wywiad rodzinny: ${familyHistory}`);
}

if (meds) lines.push(`Stosowane leki: ${meds}`);


  // Pominiƒôcie dawkowania (z checkbox√≥w miss_*)
  if (miss.length) lines.push(`Pominiƒôcie dawkowania lek√≥w: ${miss.join('; ')}`);

  if (meds_prn) lines.push(`Leki dora≈∫ne: ${meds_prn}`);
  if (allergies) lines.push(`Alergie na leki: ${allergies}`);
  if (substances) lines.push(`U≈ºywki: ${substances}`);

// Antykoncepcja hormonalna ‚Äì tylko kobieta
if (sexVal === 'K') {
  const antyTak = !!$('antykoncepcja_tak')?.checked;
  const antyNie = !!$('antykoncepcja_nie')?.checked;

  // poka≈º tylko je≈õli co≈õ zaznaczono
  if (antyTak || antyNie) {
    lines.push(`Antykoncepcja hormonalna: ${antyTak ? 'tak' : 'nie'}`);
  }
}
// CIƒÑ≈ªA + OSTATNIA MIESIƒÑCZKA ‚Äì tylko kobieta
if (sexVal === 'K') {
  // CiƒÖ≈ºa (radio)
  const pregVal = document.querySelector('input[name="pregnancy_status"]:checked')?.value || '';
  const pregNote = ($('preg_note')?.value || '').trim();

  if (pregVal || pregNote) {
    let line = `CiƒÖ≈ºa: ${pregVal || '‚Äî'}`;
    if (pregNote) line += ` (${pregNote})`;
    lines.push(line);
  }

  // Ostatnia miesiƒÖczka
  const lmpNote = ($('lmp_note')?.value || '').trim();
  const lmpReg = !!$('lmp_regular')?.checked;
  const lmpIrr = !!$('lmp_irregular')?.checked;

  if (lmpNote || lmpReg || lmpIrr) {
    const flags = [];
    if (lmpReg) flags.push('regularna');
    if (lmpIrr) flags.push('nieregularna');

    let line = `Ostatnia miesiƒÖczka:`;
    if (lmpNote) line += ` ${lmpNote}`;
    if (flags.length) line += `${lmpNote ? '; ' : ' '}(${flags.join(', ')})`;

    lines.push(line);
  }
}



  // Ocena: (przytomny, stan dobry - stabilny, kontakt s≈Çowny - logiczny)
  // - przytomny: na podstawie AVPU
  const consciousTxt = avpu ? (avpu === 'A' ? 'przytomny' : 'zaburzenia ≈õwiadomo≈õci') : '‚Äî';
  const gsTxt = general_state ? `stan ${general_state}` : 'stan ‚Äî';
  const stTxt = stability ? `${stability}` : '‚Äî';
  const vbTxt = verbal ? `kontakt s≈Çowny: ${verbal}` : 'kontakt s≈Çowny: ‚Äî';

  lines.push(``);
 let orientTxt = 'orientacja: ‚Äî';

if ($('orient_disoriented')?.checked) {
  orientTxt = 'orientacja: zaburzona';
} else {
  const o = [];
  if ($('orient_time')?.checked) o.push('czas');
  if ($('orient_place')?.checked) o.push('miejsce');
  if ($('orient_person')?.checked) o.push('w≈Çasna osoba');
  if (o.length) orientTxt = `orientacja co do: ${o.join(', ')}`;
}

 // ===== OCENA OG√ìLNA ‚Äì tylko je≈õli COKOLWIEK zaznaczone =====
const hasAnyGeneralAssessment =
  avpu ||
  verbal ||
  general_state ||
  stability ||
  $('orient_disoriented')?.checked ||
  $('orient_time')?.checked ||
  $('orient_place')?.checked ||
  $('orient_person')?.checked;

if (hasAnyGeneralAssessment) {
  const subjLower =
    (sexVal === 'K') ? 'pacjentka' :
    (sexVal === 'M') ? 'pacjent' : 'pacjent/ka';

  // AVPU / ≈õwiadomo≈õƒá
  let consciousTxt = '';
  if (avpu === 'A') consciousTxt = 'przytomny/a';
  if (avpu === 'V') consciousTxt = 'przytomny/a ‚Äì reaguje na g≈Ços';
  if (avpu === 'P') consciousTxt = 'nieprzytomny/a ‚Äì reaguje na b√≥l';
  if (avpu === 'U') consciousTxt = 'nieprzytomny/a';

  // kontakt s≈Çowny
  let contactTxt = '';
  if (verbal === 'logiczny') contactTxt = 'kontakt s≈Çowny logiczny';
  if (verbal === 'nielogiczny') contactTxt = 'kontakt s≈Çowny nielogiczny';
  if (verbal === 'brak') contactTxt = 'brak kontaktu s≈Çownego';

  // orientacja
  let orientTxt = '';
  if ($('orient_disoriented')?.checked) {
    orientTxt = 'zdezorientowany/a';
  } else {
    const o = [];
    if ($('orient_time')?.checked) o.push('czasu');
    if ($('orient_place')?.checked) o.push('miejsca');
    if ($('orient_person')?.checked) o.push('w≈Çasnej osoby');
    if (o.length) orientTxt = `zorientowany/a co do: ${o.join(', ')}`;
  }

  // sk≈Çadanie linijki
  const parts = [];
  if (consciousTxt) parts.push(consciousTxt);
  if (general_state) parts.push(`stan og√≥lny ${general_state}`);
  if (stability) parts.push(stability);
  if (contactTxt) parts.push(contactTxt);
  if (orientTxt) parts.push(orientTxt);

  if (parts.length) {
    lines.push(`Ocena og√≥lna: ${subjLower} ${parts.join(', ')}.`);
  }
}


  // ===== BADANIE (sk≈Çadane tylko z wype≈Çnionych element√≥w) =====
const examLines = [];

const v = (id) => (($(id)?.value || '').trim());
const joinChecks = (pairs) =>
  pairs
    .filter(([id]) => $(id)?.checked)
    .map(([, label]) => label);

// --- neurologiczne
{
  const parts = [];

  if ($('exam_neuro_ok')?.checked) parts.push('bez odchyle≈Ñ');

  const pupils = v('exam_pupils');
  if (pupils) parts.push(`≈∫renice: ${pupils}`);

  if ($('exam_neck_stiff')?.checked) {
    const ns = v('exam_neck_stiff_note');
    parts.push(ns ? `sztywno≈õƒá karku (${ns})` : 'sztywno≈õƒá karku');
  }

  const note = v('exam_neuro_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- neurologicznym: ${parts.join(', ')}`);
}

// --- krƒÖ≈ºeniowo
{
  const parts = [];

  const eff =
    $('exam_cardio_eff_ok')?.checked ? 'wydolny' :
    $('exam_cardio_eff_fail')?.checked ? 'niewydolny' : '';
  if (eff) parts.push(eff);

  parts.push(...joinChecks([
    ['exam_hr_regular', 'tƒôtno miarowe'],
    ['exam_hr_irregular', 'tƒôtno niemiarowe'],
    ['exam_tachy', 'tachykardia'],
    ['exam_brady', 'bradykardia'],
    ['exam_arrhythmia', 'zaburzenia rytmu'],
    ['exam_edema', 'obrzƒôki obwodowe'],
    ['exam_crt_lt2', 'CRT <2s'],
    ['exam_crt_gt2', 'CRT >2s'],
  ]));

  const note = v('exam_cardio_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- krƒÖ≈ºeniowo: ${parts.join(', ')}`);
}

// --- oddechowo
{
  const parts = [];

  const eff =
    $('exam_resp_eff_ok')?.checked ? 'wydolny' :
    $('exam_resp_eff_fail')?.checked ? 'niewydolny' : '';
  if (eff) parts.push(eff);

  const pattern = v('exam_resp_pattern');
if (pattern) parts.push(`tor: ${pattern}`);

const dysp = v('exam_resp_dyspnea');
if (dysp) parts.push(`duszno≈õƒá: ${dysp}`);


  parts.push(...joinChecks([
    ['exam_resp_tachypnoe', 'tachypnoe'],
    ['exam_resp_bradypnoe', 'bradypnoe'],
    ['exam_resp_apnea', 'bezdech'],
    ['exam_resp_irregular', 'oddech niemiarowy'],
    ['exam_resp_accessory', 'u≈ºycie mm. dodatkowych'],
    ['exam_resp_cough_dry', 'kaszel suchy'],
    ['exam_resp_cough_wet', 'kaszel mokry'],
    ['exam_resp_sputum', 'odkrztuszanie'],
    ['exam_resp_hemoptysis', 'krwioplucie'],
    ['exam_resp_pleuritic_pain', 'b√≥l op≈Çucnowy'],
    ['exam_resp_chest_sym', 'klp symetryczna'],
    ['exam_resp_chest_asym', 'klp asymetryczna'],
    ['exam_resp_chest_limited', 'ograniczona ruchomo≈õƒá klp'],
    ['exam_resp_dyspnea', 'duszno≈õƒá'],
  ]));

  const chestNote = v('exam_resp_chest_note');
  if (chestNote) parts.push(chestNote);

  const note = v('exam_resp_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- oddechowo: ${parts.join(', ')}`);
}

// --- brzuch
{
  const parts = [];

  const per = v('exam_abd_peristalsis');
  if (per) parts.push(`perystaltyka: ${per}`);
const perit = v('exam_abd_peritoneal');
if (perit) parts.push(`objawy otrzewnowe: ${perit}`);

const goldRes = v('exam_abd_goldflam_res');
const goldSide = v('exam_abd_goldflam_side');
if (goldRes) parts.push(`Goldflam: ${goldRes}${goldSide ? ` (${goldSide})` : ''}`);

  parts.push(...joinChecks([
    ['exam_abd_no_tenderness', 'b√≥l przy palpacji'],
    ['exam_abd_nontender', 'niebolesny'],
    ['exam_abd_tender', 'bolesny palpacyjnie'],
    ['exam_abd_soft', 'miƒôkki'],
    ['exam_abd_hard', 'twardy'],
    ['exam_abd_distended', 'wzdƒôty'],
    ['exam_abd_peritoneal', 'objawy otrzewnowe'],
    ['exam_abd_scars', 'blizny pooperacyjne'],
    ['exam_abd_hernia_visible', 'widoczna przepuklina'],
    ['exam_abd_pain_epigastrium', 'b√≥l: nadbrzusze'],
    ['exam_abd_pain_mesogastrium', 'b√≥l: ≈õr√≥dbrzusze'],
    ['exam_abd_pain_hypogastrium', 'b√≥l: podbrzusze'],
    ['exam_abd_pain_rlq', 'b√≥l: prawy d√≥≈Ç biodrowy'],
    ['exam_abd_pain_llq', 'b√≥l: lewy d√≥≈Ç biodrowy'],
    ['exam_abd_goldflam_res', 'objaw Goldflama dodatni'],
  ]));

   const note = v('exam_abd_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- brzuch: ${parts.join(', ')}`);
}

// --- uk≈Çad moczowo-p≈Çciowy
{
  const parts = [];

  parts.push(...joinChecks([
    ['exam_uro_none', 'bez dolegliwo≈õci'],
    ['exam_uro_frequency', 'czƒôstomocz'],
    ['exam_uro_urgency', 'parcie naglƒÖce'],
    ['exam_uro_incontinence', 'nietrzymanie moczu'],
    ['exam_uro_hematuria', 'krwiomocz'],
    ['exam_uro_dysuria_pain', 'b√≥l przy mikcji'],
    ['exam_uro_dysuria_burn', 'pieczenie przy mikcji'],
    ['exam_uro_oliguria', 'oliguria'],
  ]));
const supr = v('exam_uro_suprapubic');
if (supr) parts.push(supr);   // np. "bez bolesno≈õci" / "bolesno≈õƒá podbrzusza"

  const diur = v('exam_uro_diuresis');
  if (diur) parts.push(`diureza: ${diur}`);

  const genital = [];
  if ($('exam_uro_genital_ok')?.checked) genital.push('bez odchyle≈Ñ');
  genital.push(...joinChecks([
    ['exam_uro_genital_swelling', 'obrzƒôk'],
    ['exam_uro_genital_redness', 'zaczerwienienie'],
    ['exam_uro_genital_tender', 'bolesno≈õƒá'],
    ['exam_uro_genital_discharge', 'wydzielina'],
    ['exam_uro_genital_bleeding', 'krwawienie'],
  ]));
  const gNote = v('exam_uro_genital_note');
  if (gNote) genital.push(gNote);

  if (genital.length) parts.push(`narzƒÖdy p≈Çciowe: ${genital.join(', ')}`);

  if (parts.length) examLines.push(`- uk≈Çad moczowo-p≈Çciowy: ${parts.join(', ')}`);
}

// --- uk≈Çad ruchu / urazy
{
  const parts = [];

  if ($('exam_msk_ok')?.checked) parts.push('bez odchyle≈Ñ');

  parts.push(...joinChecks([
    ['exam_msk_swelling', 'obrzƒôk'],
    ['exam_msk_hematoma', 'krwiak/siniak'],
    ['exam_msk_wounds', 'rany'],
    ['exam_msk_deformity', 'deformacja'],
    ['exam_msk_shortening', 'skr√≥cenie ko≈Ñczyny'],
  ]));

const rom = v('exam_msk_rom');
if (rom) parts.push(`ROM: ${rom}`);

const st = v('exam_msk_stability');
if (st) parts.push(`stabilno≈õƒá: ${st}`);

const wb = v('exam_msk_weightbearing');
if (wb) parts.push(wb);

const pp = v('exam_msk_peripheral_pulse');
if (pp) parts.push(pp);

  const note = v('exam_msk_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- uk≈Çad ruchu/urazy: ${parts.join(', ')}`);
}

// --- motoryczno≈õƒá pacjenta
{
  const parts = [];

  if ($('exam_mobility_independent')?.checked) {
    parts.push('samodzielny');
  }

  if ($('exam_mobility_aid')?.checked) {
    const note = v('exam_mobility_note');
    parts.push(note
      ? `porusza siƒô przy pomocy sprzƒôtu wspomagajƒÖcego (${note})`
      : 'porusza siƒô przy pomocy sprzƒôtu wspomagajƒÖcego'
    );
  }

  if ($('exam_mobility_wheelchair')?.checked) {
    parts.push('przemieszcza siƒô na w√≥zku');
  }

  if ($('exam_mobility_bedbound')?.checked) {
    parts.push('pacjent le≈ºƒÖcy');
  }

  if (parts.length) examLines.push(`- motoryczno≈õƒá pacjenta: ${parts.join(', ')}`);
}


// --- sk√≥ra
{
  const parts = [];

  parts.push(...joinChecks([
    ['exam_skin_pink', 'r√≥≈ºowa'],
    ['exam_skin_pale', 'blada'],
    ['exam_skin_cyanotic', 'sinica'],
    ['exam_skin_dry', 'sucha'],
    ['exam_skin_sweaty', 'spocona'],
    ['exam_skin_rash', 'wysypka'],
    ['exam_skin_edema', 'obrzƒôki'],
    ['exam_skin_trophic', 'zmiany troficzne'],
    ['exam_skin_ulcers', 'owrzodzenia'],
    ['exam_skin_wounds', 'rany'],
    ['exam_skin_pressure', 'odle≈ºyny'],
  ]));

  const note = v('exam_skin_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- sk√≥ra: ${parts.join(', ')}`);
}

// --- apetyt
{
  const parts = joinChecks([
    ['exam_appetite_normal', 'prawid≈Çowy'],
    ['exam_appetite_decreased', 'zmniejszony'],
    ['exam_appetite_none', 'brak apetytu'],
    ['exam_appetite_disturbed', 'zaburzony'],
  ]);

  const note = v('exam_appetite_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- apetyt: ${parts.join(', ')}`);
}

// --- diety
{
  const parts = joinChecks([
    ['exam_diet_none', 'bez ogranicze≈Ñ'],
    ['exam_diet_reduction', 'redukcyjna'],
    ['exam_diet_highprotein', 'wysokobia≈Çkowa'],
    ['exam_diet_diabetic', 'cukrzycowa'],
    ['exam_diet_lowsodium', 'niskosodowa'],
    ['exam_diet_glutenfree', 'bezglutenowa'],
    ['exam_diet_vegetarian', 'wegetaria≈Ñska'],
    ['exam_diet_vegan', 'wega≈Ñska'],
    ['exam_diet_other', 'inna'],
  ]);

  if (parts.length) examLines.push(`- stosowane diety: ${parts.join(', ')}`);
}

// --- masa cia≈Ça
{
  const parts = joinChecks([
    ['exam_weight_stable', 'stabilna'],
    ['exam_weight_loss', 'niezamierzona utrata masy cia≈Ça'],
    ['exam_weight_gain', 'niezamierzony wzrost masy cia≈Ça'],
  ]);

  const note = v('exam_weight_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- masa cia≈Ça: ${parts.join(', ')}`);
}

// --- stolec
{
  const parts = joinChecks([
    ['exam_stool_regular', 'regularny'],
    ['exam_stool_irregular', 'nieregularny'],
    ['exam_stool_constipation', 'zaparcia'],
    ['exam_stool_diarrhea', 'biegunka'],
    ['exam_stool_alternating', 'naprzemiennie zaparcia/biegunka'],
    ['exam_stool_melena', 'smolisty'],
    ['exam_stool_fresh_blood', '≈õwie≈ºa krew'],
    ['exam_stool_none', 'brak stolca'],
  ]);

  const note = v('exam_stool_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- oddawanie stolca: ${parts.join(', ')}`);
}

// --- sen
{
  const parts = joinChecks([
    ['exam_sleep_normal', 'prawid≈Çowy'],
    ['exam_sleep_onset', 'trudno≈õci z zasypianiem'],
    ['exam_sleep_awakenings', 'wybudzenia'],
    ['exam_sleep_fragmented', 'sen p≈Çytki/przerywany'],
    ['exam_sleep_insomnia', 'bezsenno≈õƒá'],
    ['exam_sleep_daytime_sleepiness', 'senno≈õƒá dzienna'],
  ]);

  const note = v('exam_sleep_note');
  if (note) parts.push(note);

  if (parts.length) examLines.push(`- sen: ${parts.join(', ')}`);
}

// Final: dodanie do PODSUMOWANIA
if (examLines.length) {
  lines.push(`W badaniu:`);
  lines.push(...examLines);
}

return lines.join('\n');
}

function updateSummary(){
  const txt = buildSummaryText();
  $('summaryBox').textContent = txt;
  $('summary').value = txt;
}



  // Podsumowanie = aktualizuj + zapisz do historii
	on('btn_summary','click', () => {
  	updateSummary();

 	 const items = loadHistory();
 	 items.unshift(snapshot());
	  saveHistory(items.slice(0, 40));
	  renderHistory();
	});


  // Copy
  on('btn_copy','click', async () => {
    const txt = $('summary')?.value || $('summaryBox')?.textContent || '';
    try{
      await navigator.clipboard.writeText(txt);
    }catch(e){
      // fallback
      $('summary').select();
      document.execCommand('copy');
    }
  });

  // Clear
 on('btn_clear','click', () => {
  clearForm();
});
// ===== BUILD PRINT AREA (PDF) =====
function buildPrintArea(){
  const box = document.getElementById('printArea');
  if(!box) return;

  const blocks = [];

  // --- DANE PACJENTA ---
  const name  = $('name')?.value?.trim();
  const pesel = $('pesel')?.value?.trim();
  const age   = $('age')?.value?.trim();
  const sex   = $('sex')?.value?.trim();

  if(name || pesel || age || sex){
    blocks.push(`
      <h2>DANE PACJENTA</h2>
      <div><b>Imiƒô i nazwisko:</b> ${name || '‚Äî'}</div>
      <div><b>PESEL:</b> ${pesel || '‚Äî'}</div>
      <div><b>Wiek:</b> ${age || '‚Äî'}</div>
      <div><b>P≈Çeƒá:</b> ${sex || '‚Äî'}</div>
      <hr>
    `);
  }

  // --- PARAMETRY ---
  const vitals = [];
  const addVital = (label, id) => {
    const v = $(id)?.value?.trim();
    if(v) vitals.push(`<div><b>${label}:</b> ${v}</div>`);
  };

  addVital('Ci≈õnienie', 'bp');
  addVital('Tƒôtno', 'hr');
  addVital('Saturacja', 'spo2');
  addVital('Temperatura', 'temp');
  addVital('Glukoza', 'glucose');

  if(vitals.length){
    blocks.push(`
      <h2>PARAMETRY</h2>
      ${vitals.join('')}
      <hr>
    `);
  }

  // --- PODSUMOWANIE ---
  const summary = $('summary')?.value?.trim();
  if(summary){
    blocks.push(`
      <h2>PODSUMOWANIE</h2>
      <pre style="white-space:pre-wrap;font-family:inherit;">${summary}</pre>
    `);
  }

  // je≈õli wszystko puste ‚Üí komunikat
  if(!blocks.length){
    blocks.push(`<i>Brak danych do wydruku.</i>`);
  }

  box.innerHTML = blocks.join('');
}


// PDF = drukuj / zapisz jako PDF (z okna drukowania)
on('btn_pdf','click', () => {
  updateSummary();     // ≈ºeby summary by≈Ço ≈õwie≈ºe
  setEndNow?.();
  buildPrintArea();    // <<< najwa≈ºniejsze
  window.print();
});



// autosummary ‚Äì jeden blok (bez dubli i bez b≈Çƒôd√≥w)
const AUTO_IDS = [
  'miss_none','miss_accidental','miss_accidental_note','miss_noncompliance','miss_noncompliance_note',
  'healthy_none','allergies_none',
  'arrival_zrm','arrival_self','arrival_referral','arrival_note',
  'orient_disoriented','orient_time','orient_place','orient_person',
  'suic_thoughts_no',
  'suic_thoughts_yes',
  'suic_thoughts_resign',
  'suic_tendencies_no',
  'suic_tendencies_worse',
  'suic_behavior_no',
  'suic_current',

  'suic_tendencies_note',
  'suic_behavior_note',
  'psych_treated_psychiatry',
  'psych_med_adherent',
  'psych_not_treated',
  'psych_psychologist',
  'psych_care_note',

  // BADANIE ‚Äì NEURO
  'exam_neuro_ok','exam_pupils','exam_speech_disorder','exam_face_drop','exam_face_asym',
  'exam_swallow','exam_vision','exam_strength_weak','exam_sensory','exam_seizures','exam_tremor',
  'exam_limb_strength','exam_paresis','exam_sensation','exam_coord_gait','exam_romberg',
  'exam_neck_stiff','exam_neck_stiff_note','exam_neuro_note',

  // BADANIE ‚Äì KRƒÑ≈ªENIE
  'exam_cardio_eff_ok','exam_cardio_eff_fail',
  'exam_hr_regular','exam_hr_irregular','exam_tachy','exam_brady',
  'exam_arrhythmia','exam_edema','exam_crt_lt2','exam_crt_gt2',
  'exam_hypotension','exam_hypertension',
  'exam_cardio_note',

  // BADANIE ‚Äì ODDECH
  'exam_resp_eff_ok','exam_resp_eff_fail',
  'exam_resp_pattern','exam_resp_dyspnea',
  'exam_resp_tachypnoe','exam_resp_bradypnoe','exam_resp_irregular','exam_resp_apnea',
  'exam_resp_accessory',
  'exam_resp_chest_sym','exam_resp_chest_asym','exam_resp_chest_limited','exam_resp_chest_note',
  'exam_resp_cough_dry','exam_resp_cough_wet','exam_resp_sputum','exam_resp_hemoptysis',
  'exam_resp_pleuritic_pain',
  'exam_resp_note',

  // BADANIE ‚Äì BRZUCH
  'exam_abd_soft','exam_abd_hard','exam_abd_tender','exam_abd_nontender','exam_abd_no_tenderness','exam_abd_distended',
  'exam_abd_peritoneal','exam_abd_goldflam_side','exam_abd_goldflam_res','exam_abd_peristalsis',
  'exam_abd_scars','exam_abd_hernia_visible',
  'exam_abd_pain_epigastrium','exam_abd_pain_mesogastrium','exam_abd_pain_hypogastrium','exam_abd_pain_rlq','exam_abd_pain_llq',
  'exam_abd_note',

  // BADANIE ‚Äì UK≈ÅAD MOCZOWY
  'exam_uro_none','exam_uro_dysuria_pain','exam_uro_dysuria_burn','exam_uro_frequency',
  'exam_uro_urgency','exam_uro_incontinence','exam_uro_oliguria','exam_uro_hematuria',
  'exam_uro_suprapubic','exam_uro_diuresis',
  'exam_uro_genital_ok','exam_uro_genital_swelling','exam_uro_genital_tender',
  'exam_uro_genital_redness','exam_uro_genital_discharge','exam_uro_genital_bleeding',
  'exam_uro_genital_note',

  // BADANIE ‚Äì UK≈ÅAD RUCHU / URAZ KO≈ÉCZYN
  'exam_msk_ok','exam_msk_deformity','exam_msk_swelling','exam_msk_hematoma','exam_msk_wounds','exam_msk_shortening',
  'exam_msk_note','exam_msk_rom','exam_msk_stability','exam_msk_weightbearing','exam_msk_peripheral_pulse',

  // BADANIE ‚Äì MOTORYCZNO≈öƒÜ
  'exam_mobility_independent','exam_mobility_aid','exam_mobility_wheelchair','exam_mobility_bedbound',
  'exam_mobility_note',

  // BADANIE ‚Äì SK√ìRA
  'exam_skin_pink','exam_skin_pale','exam_skin_cyanotic','exam_skin_sweaty','exam_skin_dry',
  'exam_skin_rash','exam_skin_trophic','exam_skin_edema','exam_skin_ulcers','exam_skin_pressure','exam_skin_wounds',
  'exam_skin_note',

  // BADANIE ‚Äì APETYT
  'exam_appetite_normal','exam_appetite_decreased','exam_appetite_none','exam_appetite_disturbed',
  'exam_appetite_note',

  // BADANIE ‚Äì DIETY
  'exam_diet_none','exam_diet_diabetic','exam_diet_lowsodium','exam_diet_glutenfree',
  'exam_diet_vegetarian','exam_diet_vegan','exam_diet_highprotein','exam_diet_reduction',
  'exam_diet_other',

  // BADANIE ‚Äì MASA CIA≈ÅA
  'exam_weight_stable','exam_weight_loss','exam_weight_gain',
  'exam_weight_note',

  // BADANIE ‚Äì ODDAWANIE STOLCA
  'exam_stool_regular','exam_stool_irregular','exam_stool_constipation','exam_stool_diarrhea',
  'exam_stool_alternating','exam_stool_none','exam_stool_melena','exam_stool_fresh_blood',
  'exam_stool_note',

  // BADANIE ‚Äì SEN
  'exam_sleep_normal','exam_sleep_onset','exam_sleep_awakenings','exam_sleep_fragmented',
  'exam_sleep_insomnia','exam_sleep_daytime_sleepiness',
  'exam_sleep_note',
  
// CIƒÑ≈ªA / MIESIƒÑCZKA
  'preg_yes','preg_not_excluded','preg_suspects','preg_denies','preg_note',
  'lmp_note','lmp_regular','lmp_irregular',


  // podstawowe pola (≈ºeby summary ≈ºy≈Ço)
  'sex','chief','interview_general','interview_disease','meds','meds_prn','allergies','substances','family_history',
  'avpu','verbal_contact','general_state','stability'
];

AUTO_IDS.forEach(id => {
  on(id,'change', updateSummary);
  on(id,'input', updateSummary);
});



// Objawy: zmiany te≈º aktualizujƒÖ podsumowanie
document.addEventListener('change', (e) => {
  if(e.target && e.target.closest && e.target.closest('.symp-row')) updateSummary();
});
document.addEventListener('input', (e) => {
  if(e.target && e.target.closest && e.target.closest('.symp-row')) updateSummary();
});

  // History (localStorage)
  const STORAGE_KEY = 'triage_history_v1';

  function loadHistory(){
    try{
      return JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');
    }catch(e){
      return [];
    }
  }
  function saveHistory(items){
    localStorage.setItem(STORAGE_KEY, JSON.stringify(items));
  }
function readField(id){
  const el = $(id);
  if(!el) return undefined;
  if(el.type === 'checkbox' || el.type === 'radio') return !!el.checked;
  return el.value ?? '';
}

function writeField(id, val){
  const el = $(id);
  if(!el) return;
  if(el.type === 'checkbox' || el.type === 'radio'){
    el.checked = !!val;
  }else{
    el.value = (val ?? '');
  }
}

  function snapshot(){
  updateSummary();
  const auto = {};
AUTO_IDS.forEach(id => { auto[id] = readField(id); });
  return {
    ts: new Date().toISOString(),
    name: ($('name')?.value || '').trim(),
    age: ($('age')?.value || '').toString().trim(),
    sex: ($('sex')?.value || ''),
    summary: ($('summary')?.value || ''),
    fields: {
      name: ($('name')?.value || ''),
      age: ($('age')?.value || ''),
      sex: ($('sex')?.value || ''),
      pesel: ($('pesel')?.value || ''),
      dob: ($('dob')?.value || ''),
      bp: ($('bp')?.value || ''),
      hr: ($('hr')?.value || ''),
      spo2: ($('spo2')?.value || ''),
      temp: ($('temp')?.value || ''),
      avpu: ($('avpu')?.value || ''),
      verbal_contact: ($('verbal_contact')?.value || ''),
      general_state: ($('general_state')?.value || ''),
      stability: ($('stability')?.value || ''),
      glucose: ($('glucose')?.value || ''),
      chief: ($('chief')?.value || ''),
      interview_general: ($('interview_general')?.value || ''),
      interview_disease: ($('interview_disease')?.value || ''),
      meds: ($('meds')?.value || ''),
      meds_prn: ($('meds_prn')?.value || ''),
      allergies: ($('allergies')?.value || ''),
      substances: ($('substances')?.value || ''),
    
    auto,

      family_history: ($('family_history')?.value || ''),
      healthy_none: !!$('healthy_none')?.checked,
      allergies_none: !!$('allergies_none')?.checked,
      arrival_mode: getArrivalMode(),
      arrival_note: ($('arrival_note')?.value || ''),
      miss_none: !!$('miss_none')?.checked,
      miss_accidental: !!$('miss_accidental')?.checked,
      miss_accidental_note: ($('miss_accidental_note')?.value || ''),
      miss_noncompliance: !!$('miss_noncompliance')?.checked,
      miss_noncompliance_note: ($('miss_noncompliance_note')?.value || ''),
      orient_disoriented: !!$('orient_disoriented')?.checked,
      orient_time: !!$('orient_time')?.checked,
      orient_place: !!$('orient_place')?.checked,
      orient_person: !!$('orient_person')?.checked,
      symptoms: Array.from(document.querySelectorAll('.symp-row')).map(row => {
        const label = row.getAttribute('data-label') || '';
        const yes = row.querySelector('input[value="yes"]')?.checked || false;
        const no  = row.querySelector('input[value="no"]')?.checked || false;
        const note = (row.querySelector('[data-note]')?.value || '');
        const sel  = (row.querySelector('[data-select]')?.value || '');
        return { label, yes, no, note, sel };
      }),
    }
  };
}


function applySnapshot(snap){
  if(!snap) return;
  const f = snap.fields || {};
if(f.auto){
  AUTO_IDS.forEach(id => writeField(id, f.auto[id]));
}

  [
    'name','age','sex','pesel','dob','bp','hr','spo2','temp','avpu','verbal_contact','general_state','stability','glucose',
    'chief','interview_general','interview_disease','meds','meds_prn','allergies','substances',
    'miss_accidental_note','miss_noncompliance_note','arrival_note'
  ].forEach(id => { if($(id)) $(id).value = f[id] ?? ''; });

  if($('miss_none')) $('miss_none').checked = !!f.miss_none;
  if($('miss_accidental')) $('miss_accidental').checked = !!f.miss_accidental;
  if($('miss_noncompliance')) $('miss_noncompliance').checked = !!f.miss_noncompliance;

  if($('orient_disoriented')) $('orient_disoriented').checked = !!f.orient_disoriented;
  if($('orient_time')) $('orient_time').checked = !!f.orient_time;
  if($('orient_place')) $('orient_place').checked = !!f.orient_place;
  if($('orient_person')) $('orient_person').checked = !!f.orient_person;

  if($('healthy_none')) $('healthy_none').checked = !!f.healthy_none;
  if($('allergies_none')) $('allergies_none').checked = !!f.allergies_none;
  if($('family_history')) $('family_history').value = f.family_history ?? '';
  if($('arrival_zrm')) $('arrival_zrm').checked = (f.arrival_mode === 'zrm');
  if($('arrival_self')) $('arrival_self').checked = (f.arrival_mode === 'self');
  if($('arrival_referral')) $('arrival_referral').checked = (f.arrival_mode === 'referral');

  syncHealthyLogic();
  syncAllergiesLogic();
  syncArrivalLogic();
  syncOrientationLogic();
  syncAvpuEffects();


  // Objawy
  const symps = (f.symptoms || []);
  const rows = Array.from(document.querySelectorAll('.symp-row'));
  rows.forEach(row => {
    const label = row.getAttribute('data-label') || '';
    const found = symps.find(s => s.label === label);
    const yesEl = row.querySelector('input[value="yes"]');
    const noEl  = row.querySelector('input[value="no"]');
    const noteEl = row.querySelector('[data-note]');
    const selEl  = row.querySelector('[data-select]');

    if(yesEl) yesEl.checked = !!found?.yes;
    if(noEl)  noEl.checked  = !!found?.no;
    if(noteEl) noteEl.value = found?.note ?? '';
    if(selEl)  selEl.value  = found?.sel ?? '';
  });

  updateSummary();
}



      function renderHistory(){
    const wrap = $('history');
    if(!wrap) return;
    const items = loadHistory();
    wrap.innerHTML = '';


    if(!items.length){
      wrap.innerHTML = `<div class="tiny">Brak wpis√≥w.</div>`;
      return;
    }
    items.forEach((it, idx) => {
      const d = new Date(it.ts);
      const stamp = isNaN(d.getTime()) ? it.ts : d.toLocaleString();
      const title = `${it.name || '‚Äî'} ‚Ä¢ ${it.age || '‚Äî'} ‚Ä¢ ${it.sex || '‚Äî'}`;

      const el = document.createElement('div');
      el.className = 'hist-item';
      el.innerHTML = `
        <div class="meta">
          <b>${title}</b><br/>
          <span>${stamp}</span>
        </div>
        <div class="mini-actions">
          <button class="btn small" data-act="load">Wczytaj</button>
          <button class="btn small ghost" data-act="copy">Kopiuj</button>
          <button class="btn small danger" data-act="del">Usu≈Ñ</button>
        </div>
      `;
      el.querySelector('[data-act="load"]').addEventListener('click', () => applySnapshot(it));
      el.querySelector('[data-act="copy"]').addEventListener('click', async () => {
        try{ await navigator.clipboard.writeText(it.summary || ''); }catch(e){}
      });
      el.querySelector('[data-act="del"]').addEventListener('click', () => {
        const arr = loadHistory();
        arr.splice(idx, 1);
        saveHistory(arr);
        renderHistory();
      });
      wrap.appendChild(el);
    });
  }


  function clearForm(){
  // 1) Czy≈õcimy WSZYSTKIE pola formularza
document.querySelectorAll('input, textarea, select').forEach(el => {
  if(el.type === 'checkbox' || el.type === 'radio'){
    el.checked = false;
  } else {
    el.value = '';
  }
  el.classList?.remove('warn');
  el.disabled = false;

  // DODAJ TO:
  if ('readOnly' in el) el.readOnly = false;
});


  // 2) Reset ‚Äúlogik‚Äù kt√≥re blokujƒÖ pola (≈ºeby po czyszczeniu wszystko by≈Ço aktywne)
  syncHealthyLogic?.();
  syncAllergiesLogic?.();
  syncArrivalLogic?.();
  syncAntykoncepcjaVisibility?.();

  // 3) Reset klas/stan√≥w w objawach (≈ºeby nie zostawa≈Çy ‚Äúsuggested/picked‚Äù)
  document.querySelectorAll('.symp-row').forEach(row => {
    row.classList.remove('suggested','picked');
    const note = row.querySelector('[data-note]');
    if(note){
      note.value = '';
      note.disabled = false;
    }
    const sel = row.querySelector('[data-select]');
    if(sel){
      sel.value = '';
      sel.disabled = false;
    }
  });

  // 4) Czy≈õcimy PODSUMOWANIE (a nie generujemy ‚Äúpuste ‚Äî‚Äù)
  if($('summaryBox')) $('summaryBox').textContent = '';
  if($('summary')) $('summary').value = '';

  // 6) Dodatkowe init-y je≈õli masz (np. kolorowanie parametr√≥w)
  highlightVitals?.();
}

['bp','hr','spo2','temp','glucose'].forEach(id => {
  on(id,'input', () => { highlightVitals(); updateSummary(); });
  on(id,'change', () => { highlightVitals(); updateSummary(); });
});

  // init
  highlightVitals();
  updateSummary();
  renderHistory();

on('arrival_note','input', () => {
  syncArrivalLogic();
  updateSummary();
});
// ===== ZMIANA P≈ÅCI ‚Üí antykoncepcja / ciƒÖ≈ºa / miesiƒÖczka =====
on('sex','change', () => {
  syncAntykoncepcjaVisibility();
  updateSummary();
});
bindAutoResize('interview_general');

  </script>


<script>
/* ===== USTAWIENIA ===== */
const APP_PASSWORD = "PerAsperaAdAstra"; // ZMIE≈É HAS≈ÅO
const AUTO_LOGOUT_TIME = 5 * 60 * 1000;  // 5 min
const DRAFT_KEY = "triage_draft_v1";

/* ===== DRAFT (AUTOZAPIS) ===== */
function getAllAppFields() {
  const app = document.getElementById("app");
  if (!app) return [];
  return Array.from(app.querySelectorAll("input, textarea, select"))
    .filter(el => el.id)
    .filter(el => el.id !== "passwordInput");
}

function readAny(el){
  const t = (el.type || "").toLowerCase();
  if (t === "checkbox") return !!el.checked;
  if (t === "radio") return !!el.checked;
  return el.value ?? "";
}

function writeAny(el, val){
  const t = (el.type || "").toLowerCase();
  if (t === "checkbox") { el.checked = !!val; return; }
  if (t === "radio")    { el.checked = !!val; return; }
  el.value = (val ?? "");
}

function saveDraft(reason = "auto") {
  try {
    if (typeof updateSummary === "function") updateSummary();

    const data = {};
    getAllAppFields().forEach(el => data[el.id] = readAny(el));

    localStorage.setItem(DRAFT_KEY, JSON.stringify({
      ts: Date.now(),
      reason,
      data
    }));
  } catch (e) {
    console.warn("saveDraft failed:", e);
  }
}

function loadDraft() {
  try {
    const raw = localStorage.getItem(DRAFT_KEY);
    if (!raw) return false;

    const payload = JSON.parse(raw);
    const data = payload?.data || {};

    Object.keys(data).forEach(id => {
      const el = document.getElementById(id);
      if (el) writeAny(el, data[id]);
    });

    // od≈õwie≈º logiki je≈õli istniejƒÖ
    if (typeof syncHealthyLogic === "function") syncHealthyLogic();
    if (typeof syncAllergiesLogic === "function") syncAllergiesLogic();
    if (typeof syncArrivalLogic === "function") syncArrivalLogic();
    if (typeof syncAntykoncepcjaVisibility === "function") syncAntykoncepcjaVisibility();
    if (typeof highlightVitals === "function") highlightVitals();
    if (typeof updateSummary === "function") updateSummary();

    return true;
  } catch (e) {
    console.warn("loadDraft failed:", e);
    return false;
  }
}

/* ===== SESJA / LOGOWANIE ===== */
function login() {
  const pass = document.getElementById("passwordInput")?.value || "";
  if (pass === APP_PASSWORD) {
    sessionStorage.setItem("loggedIn", "true");
    sessionStorage.setItem("lastActivity", String(Date.now()));
    showApp();
  } else {
    const err = document.getElementById("loginError");
    if (err) err.style.display = "block";
  }
}

function showApp() {
  // schowaj login + wygaszacz, poka≈º app
  const loginScreen = document.getElementById("loginScreen");
  const app = document.getElementById("app");
  const ss = document.getElementById("screensaver");

  if (loginScreen) loginScreen.style.display = "none";
  if (ss) ss.style.display = "none";
  if (app) app.style.display = "block";

  // odtw√≥rz draft
  loadDraft();

  // zaznacz aktywno≈õƒá od razu po wej≈õciu
  updateActivity();

  // blokada cofania (je≈õli masz funkcjƒô)
  if (typeof lockBackNavigation === "function") lockBackNavigation();
}

function logout(reason = "logout_button") {
  saveDraft(reason);
  sessionStorage.clear();

  // üîí WYCZY≈öƒÜ HAS≈ÅO
  const pass = document.getElementById("passwordInput");
  if (pass) pass.value = "";

  showScreensaver();
}


/* ===== INAKTYWNO≈öƒÜ ===== */
function updateActivity() {
  if (sessionStorage.getItem("loggedIn") === "true") {
    sessionStorage.setItem("lastActivity", String(Date.now()));
  }
}

// UWAGA: input/change dodane ‚Äì samo pisanie w polach te≈º resetuje licznik
["click","keydown","mousemove","touchstart","scroll","input","change"].forEach(ev =>
  document.addEventListener(ev, updateActivity, { capture: true, passive: true })
);

// sprawdzaj czƒô≈õciej i tylko gdy zalogowany
setInterval(() => {
  if (sessionStorage.getItem("loggedIn") !== "true") return;

  const last = Number(sessionStorage.getItem("lastActivity") || 0);
  if (!last) return;

  if (Date.now() - last > AUTO_LOGOUT_TIME) {
    saveDraft("auto_logout");
    alert("Sesja wygas≈Ça ‚Äì zaloguj siƒô ponownie");
    logout("auto_logout");
  }
}, 5000);

// zapis te≈º przy zamykaniu/od≈õwie≈ºaniu
window.addEventListener("beforeunload", () => {
  if (sessionStorage.getItem("loggedIn") === "true") {
    saveDraft("beforeunload");
  }
});

// auto-powr√≥t po od≈õwie≈ºeniu (z draftem)
window.addEventListener("load", () => {
  if (sessionStorage.getItem("loggedIn") === "true") {
    showApp();
  }
});

// Enter na ekranie logowania
document.addEventListener("keydown", (e) => {
  if (e.key !== "Enter") return;

  const loginScreen = document.getElementById("loginScreen");
  const pass = document.getElementById("passwordInput");

  // tylko gdy ekran logowania widoczny
  if (!loginScreen || loginScreen.style.display === "none") return;

  // tylko gdy has≈Ço faktycznie wpisane TERAZ
  if (!pass || !pass.value.trim()) return;

  login();
});
// ===== WYGASZACZ =====
let ssTimer = null;

function updateScreensaverClock(){
  const now = new Date();
  const hh = String(now.getHours()).padStart(2,'0');
  const mm = String(now.getMinutes()).padStart(2,'0');
  const timeEl = document.getElementById("ssTime");
  const dateEl = document.getElementById("ssDate");

  if (timeEl) timeEl.textContent = `${hh}:${mm}`;
  if (dateEl) dateEl.textContent = now.toLocaleDateString("pl-PL", {
    weekday: "long", year: "numeric", month: "long", day: "2-digit"
  });
}

function showScreensaver(){
  const app = document.getElementById("app");
  const loginScreen = document.getElementById("loginScreen");
  const ss = document.getElementById("screensaver");

  if (app) app.style.display = "none";
  if (loginScreen) loginScreen.style.display = "none";
  if (ss) ss.style.display = "flex";

  updateScreensaverClock();
  clearInterval(ssTimer);
  ssTimer = setInterval(updateScreensaverClock, 1000);
}

function hideScreensaverToLogin(){
  const ss = document.getElementById("screensaver");
  if (ss) ss.style.display = "none";
  clearInterval(ssTimer);

  // poka≈º logowanie wy≈õrodkowane (CSS .login-screen robi robotƒô)
  const loginScreen = document.getElementById("loginScreen");
  if (loginScreen) loginScreen.style.display = "flex";

  // WYMA≈ª HAS≈ÅO po autowylogowaniu/wylogowaniu:
  const pass = document.getElementById("passwordInput");
  if (pass) { pass.value = ""; pass.focus(); }

  // schowaj b≈ÇƒÖd
  const err = document.getElementById("loginError");
  if (err) err.style.display = "none";
}

// klik/klawisz na wygaszaczu => wr√≥ƒá do logowania
["click","touchstart"].forEach(ev => {
  document.getElementById("screensaver")?.addEventListener(ev, hideScreensaverToLogin);
});
document.addEventListener("keydown", () => {
  const ss = document.getElementById("screensaver");
  if (ss && ss.style.display !== "none") hideScreensaverToLogin();
});


</script>
<script>
  if ("serviceWorker" in navigator) {
    window.addEventListener("load", () => {
      navigator.serviceWorker.register("./sw.js");
    });
  }
</script>

</body>
</html>
